ifconfig -s -a

lsblk

nano script.sh

#!/bin/bash

wget https://download.mikrotik.com/routeros/7.5/chr-7.5.img.zip -O chr.img.zip && \
gunzip -c chr.img.zip > chr.img && \
mount -o loop,offset=33571840 chr.img /mnt && \  # آفست درست رو چک کنید یا از kpartx استفاده کنید

# پیدا کردن اینترفیس، IP و gateway در لینوکس
INTERFACE=$(ip route | grep default | awk '{print $5}')
ADDRESS=$(ip addr show $INTERFACE | grep global | cut -d' ' -f 6 | head -n 1)
GATEWAY=$(ip route list | grep default | cut -d' ' -f 3)

# نوشته تنظیمات به فایل autorun.scr
echo "/ip address add address=$ADDRESS interface=ether1
/ip route add gateway=$GATEWAY
/ip service disable telnet
/user set 0 name=root password=xxxxxx" > /mnt/rw/autorun.scr && \

umount /mnt && \
echo u > /proc/sysrq-trigger && \
dd if=chr.img bs=1024 of=/dev/sda && \
echo s > /proc/sysrq-trigger && \
sleep 20 && \
echo b > /proc/sysrq-trigger

chmod 755 script.sh

./script.sh
