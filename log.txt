Visual Studio Code (1.100.2, ssh-remote, desktop)
Jupyter Extension Version: 2025.4.1.
Python Extension Version: 2025.6.1.
Pylance Extension Version: 2025.5.1.
Platform: linux (x64).
Home = /home/mazaheri
Temp Storage folder ~/.vscode-server/data/User/globalStorage/ms-toolsai.jupyter/version-2025.4.1
Workspace folder /mnt/data/rasfai
06:32:35.555 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/enrich_prediction.ipynb' (disableUI=true)
06:32:38.587 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
06:32:38.661 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
06:32:38.691 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v39ec6a76e4effdca7c7047935280108cc52b4fa9f.json
    > cwd: /mnt/data/rasfai
06:32:40.618 [info] Kernel successfully started
06:32:50.881 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd0ada48b5260f3dc9770c3ef7c210a0bee22d9fe80da2d722c023c3342a84b0280.c:\Users\<username>\AppData\Local\Programs\Python\Python311\python.exe.c:\Users\<username>\AppData\Local\Programs\Python\Python311\python.exe.-m#ipykernel_launcher' for view = 'jupyter-notebook'
06:32:50.884 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd0ada48b5260f3dc9770c3ef7c210a0bee22d9fe80da2d722c023c3342a84b0280.c:\Users\<username>\AppData\Local\Programs\Python\Python311\python.exe.c:\Users\<username>\AppData\Local\Programs\Python\Python311\python.exe.-m#ipykernel_launcher (Interactive)' for view = 'interactive'
06:33:45.467 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
06:33:47.700 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
06:36:26.052 [warn] Cell completed with errors lu [Error]: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'X has 2003 features, but RandomForestClassifier is expecting 103 features as input.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[10], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m sample_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mBUSH, Code: V6070401072\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m----> 2\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m \x1B[43mpredict_and_enrich\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[43m    \x1B[49m\x1B[43msample_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43msample_name\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[43m    \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.3\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[43m    \x1B[49m\x1B[43menrich_threshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.5\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[43m    \x1B[49m\x1B[43mFeBase\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[43m    \x1B[49m\x1B[43mDestruct\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[43m    \x1B[49m\x1B[43mIsLarge\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0\x1B[39;49m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🤖 تست‌های اولیه مدل:\x1B[39m\x1B[38;5;124m"\x1B[39m, initial)\n' +
      '\x1B[1;32m     13\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🎯 تست‌های نهایی بعد از enrich:\x1B[39m\x1B[38;5;124m"\x1B[39m, final)\n',
    'Cell \x1B[0;32mIn[6], line 5\x1B[0m, in \x1B[0;36mpredict_and_enrich\x1B[0;34m(sample_name, threshold, enrich_threshold, FeBase, Destruct, IsLarge)\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mpredict_and_enrich\x1B[39m(sample_name, threshold\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.3\x1B[39m, enrich_threshold\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.6\x1B[39m,\n' +
      '\x1B[1;32m      2\x1B[0m                        FeBase\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.5\x1B[39m, Destruct\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mFalse\x1B[39;00m, IsLarge\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[1;32m      3\x1B[0m     X_input \x1B[38;5;241m=\x1B[39m make_model_input(sample_name, FeBase, Destruct, IsLarge)\n' +
      '\x1B[0;32m----> 5\x1B[0m     raw_preds \x1B[38;5;241m=\x1B[39m \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_input\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mthreshold\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m     predicted_tests \x1B[38;5;241m=\x1B[39m mlb\x1B[38;5;241m.\x1B[39minverse_transform(raw_preds)[\x1B[38;5;241m0\x1B[39m]\n' +
      '\x1B[1;32m      8\x1B[0m     \x1B[38;5;66;03m# استفاده از pair_df جهانی\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36mManualOVR.predict\x1B[0;34m(self, X, threshold)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([est\x1B[38;5;241m.\x1B[39mpredict_proba(X)[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36m<listcomp>\x1B[0;34m(.0)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([\x1B[43mest\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict_proba\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:946\x1B[0m, in \x1B[0;36mForestClassifier.predict_proba\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    944\x1B[0m check_is_fitted(\x1B[38;5;28mself\x1B[39m)\n' +
      '\x1B[1;32m    945\x1B[0m \x1B[38;5;66;03m# Check data\x1B[39;00m\n' +
      '\x1B[0;32m--> 946\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_validate_X_predict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    948\x1B[0m \x1B[38;5;66;03m# Assign chunk of trees to jobs\x1B[39;00m\n' +
      '\x1B[1;32m    949\x1B[0m n_jobs, _, _ \x1B[38;5;241m=\x1B[39m _partition_estimators(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_estimators, \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_jobs)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:638\x1B[0m, in \x1B[0;36mBaseForest._validate_X_predict\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    635\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    636\x1B[0m     ensure_all_finite \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mTrue\x1B[39;00m\n' +
      '\x1B[0;32m--> 638\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[43mvalidate_data\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    639\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    640\x1B[0m \x1B[43m    \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    641\x1B[0m \x1B[43m    \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mDTYPE\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    642\x1B[0m \x1B[43m    \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcsr\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    643\x1B[0m \x1B[43m    \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    644\x1B[0m \x1B[43m    \x1B[49m\x1B[43mensure_all_finite\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mensure_all_finite\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    645\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    646\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m issparse(X) \x1B[38;5;129;01mand\x1B[39;00m (X\x1B[38;5;241m.\x1B[39mindices\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc \x1B[38;5;129;01mor\x1B[39;00m X\x1B[38;5;241m.\x1B[39mindptr\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc):\n' +
      '\x1B[1;32m    647\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mNo support for np.int64 index based sparse matrices\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2965\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2962\x1B[0m     out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2964\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m check_params\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mensure_2d\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[0;32m-> 2965\x1B[0m     \x1B[43m_check_n_features\x1B[49m\x1B[43m(\x1B[49m\x1B[43m_estimator\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mreset\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2967\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m out\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2829\x1B[0m, in \x1B[0;36m_check_n_features\x1B[0;34m(estimator, X, reset)\x1B[0m\n' +
      '\x1B[1;32m   2826\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m\n' +
      '\x1B[1;32m   2828\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_features \x1B[38;5;241m!=\x1B[39m estimator\x1B[38;5;241m.\x1B[39mn_features_in_:\n' +
      '\x1B[0;32m-> 2829\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   2830\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mX has \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mn_features\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features, but \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__class__\x1B[39m\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2831\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mis expecting \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39mn_features_in_\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features as input.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2832\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.'
  ]
}
06:44:45.005 [warn] Cell completed with errors lu [Error]: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'X has 2003 features, but RandomForestClassifier is expecting 103 features as input.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[11], line 5\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m sample_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mBUSH, Code: V6070401072\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[38;5;66;03m# 🤖 پیش‌بینی و غنی‌سازی\x1B[39;00m\n' +
      '\x1B[0;32m----> 5\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m \x1B[43mpredict_and_enrich\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[43m    \x1B[49m\x1B[43msample_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43msample_name\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[43m    \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.3\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[43m    \x1B[49m\x1B[43menrich_threshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.5\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[43m    \x1B[49m\x1B[43mFeBase\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     10\x1B[0m \x1B[43m    \x1B[49m\x1B[43mDestruct\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[43m    \x1B[49m\x1B[43mIsLarge\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0\x1B[39;49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[38;5;66;03m# 📊 چاپ خروجی\x1B[39;00m\n' +
      '\x1B[1;32m     15\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🤖 تست‌های اولیه مدل:\x1B[39m\x1B[38;5;124m"\x1B[39m, initial)\n',
    'Cell \x1B[0;32mIn[6], line 5\x1B[0m, in \x1B[0;36mpredict_and_enrich\x1B[0;34m(sample_name, threshold, enrich_threshold, FeBase, Destruct, IsLarge)\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mpredict_and_enrich\x1B[39m(sample_name, threshold\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.3\x1B[39m, enrich_threshold\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.6\x1B[39m,\n' +
      '\x1B[1;32m      2\x1B[0m                        FeBase\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.5\x1B[39m, Destruct\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mFalse\x1B[39;00m, IsLarge\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[1;32m      3\x1B[0m     X_input \x1B[38;5;241m=\x1B[39m make_model_input(sample_name, FeBase, Destruct, IsLarge)\n' +
      '\x1B[0;32m----> 5\x1B[0m     raw_preds \x1B[38;5;241m=\x1B[39m \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_input\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mthreshold\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m     predicted_tests \x1B[38;5;241m=\x1B[39m mlb\x1B[38;5;241m.\x1B[39minverse_transform(raw_preds)[\x1B[38;5;241m0\x1B[39m]\n' +
      '\x1B[1;32m      8\x1B[0m     \x1B[38;5;66;03m# استفاده از pair_df جهانی\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36mManualOVR.predict\x1B[0;34m(self, X, threshold)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([est\x1B[38;5;241m.\x1B[39mpredict_proba(X)[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36m<listcomp>\x1B[0;34m(.0)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([\x1B[43mest\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict_proba\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:946\x1B[0m, in \x1B[0;36mForestClassifier.predict_proba\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    944\x1B[0m check_is_fitted(\x1B[38;5;28mself\x1B[39m)\n' +
      '\x1B[1;32m    945\x1B[0m \x1B[38;5;66;03m# Check data\x1B[39;00m\n' +
      '\x1B[0;32m--> 946\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_validate_X_predict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    948\x1B[0m \x1B[38;5;66;03m# Assign chunk of trees to jobs\x1B[39;00m\n' +
      '\x1B[1;32m    949\x1B[0m n_jobs, _, _ \x1B[38;5;241m=\x1B[39m _partition_estimators(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_estimators, \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_jobs)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:638\x1B[0m, in \x1B[0;36mBaseForest._validate_X_predict\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    635\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    636\x1B[0m     ensure_all_finite \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mTrue\x1B[39;00m\n' +
      '\x1B[0;32m--> 638\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[43mvalidate_data\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    639\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    640\x1B[0m \x1B[43m    \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    641\x1B[0m \x1B[43m    \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mDTYPE\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    642\x1B[0m \x1B[43m    \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcsr\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    643\x1B[0m \x1B[43m    \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    644\x1B[0m \x1B[43m    \x1B[49m\x1B[43mensure_all_finite\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mensure_all_finite\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    645\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    646\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m issparse(X) \x1B[38;5;129;01mand\x1B[39;00m (X\x1B[38;5;241m.\x1B[39mindices\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc \x1B[38;5;129;01mor\x1B[39;00m X\x1B[38;5;241m.\x1B[39mindptr\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc):\n' +
      '\x1B[1;32m    647\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mNo support for np.int64 index based sparse matrices\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2965\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2962\x1B[0m     out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2964\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m check_params\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mensure_2d\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[0;32m-> 2965\x1B[0m     \x1B[43m_check_n_features\x1B[49m\x1B[43m(\x1B[49m\x1B[43m_estimator\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mreset\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2967\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m out\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2829\x1B[0m, in \x1B[0;36m_check_n_features\x1B[0;34m(estimator, X, reset)\x1B[0m\n' +
      '\x1B[1;32m   2826\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m\n' +
      '\x1B[1;32m   2828\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_features \x1B[38;5;241m!=\x1B[39m estimator\x1B[38;5;241m.\x1B[39mn_features_in_:\n' +
      '\x1B[0;32m-> 2829\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   2830\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mX has \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mn_features\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features, but \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__class__\x1B[39m\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2831\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mis expecting \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39mn_features_in_\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features as input.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2832\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.'
  ]
}
06:46:25.398 [warn] Cell completed with errors lu [Error]: predict_and_enrich() missing 4 required positional arguments: 'vectorizer', 'model', 'mlb', and 'pair_df'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: "predict_and_enrich() missing 4 required positional arguments: 'vectorizer', 'model', 'mlb', and 'pair_df'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[15], line 5\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m sample_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mBUSH, Code: V6070401072\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[38;5;66;03m# 🤖 پیش‌بینی و غنی‌سازی\x1B[39;00m\n' +
      '\x1B[0;32m----> 5\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m \x1B[43mpredict_and_enrich\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[43m    \x1B[49m\x1B[43msample_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43msample_name\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[43m    \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.3\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[43m    \x1B[49m\x1B[43menrich_threshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.5\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[43m    \x1B[49m\x1B[43mFeBase\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     10\x1B[0m \x1B[43m    \x1B[49m\x1B[43mDestruct\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[43m    \x1B[49m\x1B[43mIsLarge\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0\x1B[39;49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[38;5;66;03m# 📊 چاپ خروجی\x1B[39;00m\n' +
      '\x1B[1;32m     15\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🤖 تست‌های اولیه مدل:\x1B[39m\x1B[38;5;124m"\x1B[39m, initial)\n',
    "\x1B[0;31mTypeError\x1B[0m: predict_and_enrich() missing 4 required positional arguments: 'vectorizer', 'model', 'mlb', and 'pair_df'"
  ]
}
06:47:01.921 [warn] Cell completed with errors lu [Error]: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'X has 2003 features, but RandomForestClassifier is expecting 103 features as input.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[16], line 5\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m sample_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mBUSH, Code: V6070401072\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[38;5;66;03m# 🤖 پیش‌بینی و غنی‌سازی\x1B[39;00m\n' +
      '\x1B[0;32m----> 5\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m \x1B[43mpredict_and_enrich\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[43m    \x1B[49m\x1B[43msample_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43msample_name\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[43m    \x1B[49m\x1B[43mvectorizer\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mvectorizer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m       \x1B[49m\x1B[38;5;66;43;03m# ✅ بردارساز TF-IDF\x1B[39;49;00m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmodel\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mmodel\x1B[49m\x1B[43m,\x1B[49m\x1B[43m                 \x1B[49m\x1B[38;5;66;43;03m# ✅ مدل One-vs-Rest\x1B[39;49;00m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmlb\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mmlb\x1B[49m\x1B[43m,\x1B[49m\x1B[43m                     \x1B[49m\x1B[38;5;66;43;03m# ✅ label binarizer\x1B[39;49;00m\n' +
      '\x1B[1;32m     10\x1B[0m \x1B[43m    \x1B[49m\x1B[43mpair_df\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mpair_df\x1B[49m\x1B[43m,\x1B[49m\x1B[43m             \x1B[49m\x1B[38;5;66;43;03m# ✅ دیتا وابستگی تست‌ها\x1B[39;49;00m\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[43m    \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.3\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[43m    \x1B[49m\x1B[43menrich_threshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.5\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     13\x1B[0m \x1B[43m    \x1B[49m\x1B[43mFeBase\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[43m    \x1B[49m\x1B[43mDestruct\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     15\x1B[0m \x1B[43m    \x1B[49m\x1B[43mIsLarge\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0\x1B[39;49m\n' +
      '\x1B[1;32m     16\x1B[0m \x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     19\x1B[0m \x1B[38;5;66;03m# 📊 چاپ خروجی\x1B[39;00m\n' +
      '\x1B[1;32m     20\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🤖 تست‌های اولیه مدل:\x1B[39m\x1B[38;5;124m"\x1B[39m, initial)\n',
    'Cell \x1B[0;32mIn[14], line 21\x1B[0m, in \x1B[0;36mpredict_and_enrich\x1B[0;34m(sample_name, vectorizer, model, mlb, pair_df, threshold, enrich_threshold, FeBase, Destruct, IsLarge)\x1B[0m\n' +
      '\x1B[1;32m     18\x1B[0m X_input \x1B[38;5;241m=\x1B[39m make_model_input(sample_name, FeBase, Destruct, IsLarge, vectorizer)\n' +
      '\x1B[1;32m     20\x1B[0m \x1B[38;5;66;03m# پیش‌بینی اولیه با مدل One-vs-Rest\x1B[39;00m\n' +
      '\x1B[0;32m---> 21\x1B[0m raw_preds \x1B[38;5;241m=\x1B[39m \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_input\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mthreshold\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mthreshold\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     22\x1B[0m predicted_tests \x1B[38;5;241m=\x1B[39m mlb\x1B[38;5;241m.\x1B[39minverse_transform(raw_preds)[\x1B[38;5;241m0\x1B[39m]\n' +
      '\x1B[1;32m     24\x1B[0m \x1B[38;5;66;03m# غنی‌سازی خروجی با وابستگی تست‌ها\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36mManualOVR.predict\x1B[0;34m(self, X, threshold)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([est\x1B[38;5;241m.\x1B[39mpredict_proba(X)[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'Cell \x1B[0;32mIn[2], line 10\x1B[0m, in \x1B[0;36m<listcomp>\x1B[0;34m(.0)\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m threshold \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m      8\x1B[0m     threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mthreshold\n' +
      '\x1B[0;32m---> 10\x1B[0m probs \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39marray([\x1B[43mest\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict_proba\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m[:, \x1B[38;5;241m1\x1B[39m] \x1B[38;5;28;01mfor\x1B[39;00m est \x1B[38;5;129;01min\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mestimators_])\x1B[38;5;241m.\x1B[39mT\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m (probs \x1B[38;5;241m>\x1B[39m\x1B[38;5;241m=\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:946\x1B[0m, in \x1B[0;36mForestClassifier.predict_proba\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    944\x1B[0m check_is_fitted(\x1B[38;5;28mself\x1B[39m)\n' +
      '\x1B[1;32m    945\x1B[0m \x1B[38;5;66;03m# Check data\x1B[39;00m\n' +
      '\x1B[0;32m--> 946\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_validate_X_predict\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    948\x1B[0m \x1B[38;5;66;03m# Assign chunk of trees to jobs\x1B[39;00m\n' +
      '\x1B[1;32m    949\x1B[0m n_jobs, _, _ \x1B[38;5;241m=\x1B[39m _partition_estimators(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_estimators, \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mn_jobs)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/ensemble/_forest.py:638\x1B[0m, in \x1B[0;36mBaseForest._validate_X_predict\x1B[0;34m(self, X)\x1B[0m\n' +
      '\x1B[1;32m    635\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    636\x1B[0m     ensure_all_finite \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mTrue\x1B[39;00m\n' +
      '\x1B[0;32m--> 638\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[43mvalidate_data\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    639\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    640\x1B[0m \x1B[43m    \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    641\x1B[0m \x1B[43m    \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mDTYPE\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    642\x1B[0m \x1B[43m    \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcsr\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    643\x1B[0m \x1B[43m    \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    644\x1B[0m \x1B[43m    \x1B[49m\x1B[43mensure_all_finite\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mensure_all_finite\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    645\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    646\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m issparse(X) \x1B[38;5;129;01mand\x1B[39;00m (X\x1B[38;5;241m.\x1B[39mindices\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc \x1B[38;5;129;01mor\x1B[39;00m X\x1B[38;5;241m.\x1B[39mindptr\x1B[38;5;241m.\x1B[39mdtype \x1B[38;5;241m!=\x1B[39m np\x1B[38;5;241m.\x1B[39mintc):\n' +
      '\x1B[1;32m    647\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mNo support for np.int64 index based sparse matrices\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2965\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2962\x1B[0m     out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2964\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m check_params\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mensure_2d\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[0;32m-> 2965\x1B[0m     \x1B[43m_check_n_features\x1B[49m\x1B[43m(\x1B[49m\x1B[43m_estimator\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mreset\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2967\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m out\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2829\x1B[0m, in \x1B[0;36m_check_n_features\x1B[0;34m(estimator, X, reset)\x1B[0m\n' +
      '\x1B[1;32m   2826\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m\n' +
      '\x1B[1;32m   2828\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_features \x1B[38;5;241m!=\x1B[39m estimator\x1B[38;5;241m.\x1B[39mn_features_in_:\n' +
      '\x1B[0;32m-> 2829\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   2830\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mX has \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mn_features\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features, but \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__class__\x1B[39m\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2831\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mis expecting \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39mn_features_in_\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features as input.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2832\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: X has 2003 features, but RandomForestClassifier is expecting 103 features as input.'
  ]
}
06:54:30.520 [warn] Cell completed with errors lu [Error]: name 'decoded_df' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'decoded_df' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[26], line 4\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m pair_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mtest_cooccurrence_pairs.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m----> 4\x1B[0m \x1B[43mdecoded_df\x1B[49m\x1B[38;5;241m.\x1B[39mto_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mfinal_tests_readable_sorted.csv\x1B[39m\x1B[38;5;124m"\x1B[39m, index\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mFalse\x1B[39;00m)\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m📁 تست‌های مرتب‌شده ذخیره شد: final_tests_readable_sorted.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'decoded_df' is not defined"
  ]
}
06:54:37.517 [warn] Cell completed with errors lu [Error]: name 'test_info_df' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'test_info_df' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[27], line 6\x1B[0m\n' +
      '\x1B[1;32m      3\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m df_decoded\x1B[38;5;241m.\x1B[39msort_values(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[38;5;66;03m# فرض بر اینکه final = لیست کدهای نهایی تست بعد از enrich\x1B[39;00m\n' +
      '\x1B[0;32m----> 6\x1B[0m decoded_df \x1B[38;5;241m=\x1B[39m decode_test_codes(final, \x1B[43mtest_info_df\x1B[49m)\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🧪 تست‌های نهایی به ترتیب نام:\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      "\x1B[1;32m      9\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m name \x1B[38;5;129;01min\x1B[39;00m decoded_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]\x1B[38;5;241m.\x1B[39mtolist():\n",
    "\x1B[0;31mNameError\x1B[0m: name 'test_info_df' is not defined"
  ]
}
06:58:49.733 [warn] Cell completed with errors lu [Error]: name 'code_to_name' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'code_to_name' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[32], line 18\x1B[0m\n' +
      '\x1B[1;32m      3\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m predict_and_enrich(\n' +
      '\x1B[1;32m      4\x1B[0m     sample_name\x1B[38;5;241m=\x1B[39msample_name,\n' +
      '\x1B[1;32m      5\x1B[0m     vectorizer\x1B[38;5;241m=\x1B[39mvectorizer,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m     14\x1B[0m     IsLarge\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m\n' +
      '\x1B[1;32m     15\x1B[0m )\n' +
      '\x1B[1;32m     17\x1B[0m \x1B[38;5;66;03m# مرتب‌سازی نهایی بر اساس نام\x1B[39;00m\n' +
      '\x1B[0;32m---> 18\x1B[0m initial_named \x1B[38;5;241m=\x1B[39m \x1B[38;5;28msorted\x1B[39m([(code, code_to_name\x1B[38;5;241m.\x1B[39mget(code, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m"\x1B[39m)) \x1B[38;5;28;01mfor\x1B[39;00m code \x1B[38;5;129;01min\x1B[39;00m initial], key\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m x: x[\x1B[38;5;241m1\x1B[39m])\n' +
      '\x1B[1;32m     19\x1B[0m final_named \x1B[38;5;241m=\x1B[39m \x1B[38;5;28msorted\x1B[39m([(code, code_to_name\x1B[38;5;241m.\x1B[39mget(code, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m"\x1B[39m)) \x1B[38;5;28;01mfor\x1B[39;00m code \x1B[38;5;129;01min\x1B[39;00m final], key\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m x: x[\x1B[38;5;241m1\x1B[39m])\n' +
      '\x1B[1;32m     21\x1B[0m \x1B[38;5;66;03m# ایجاد جدول\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[32], line 18\x1B[0m, in \x1B[0;36m<listcomp>\x1B[0;34m(.0)\x1B[0m\n' +
      '\x1B[1;32m      3\x1B[0m initial, final \x1B[38;5;241m=\x1B[39m predict_and_enrich(\n' +
      '\x1B[1;32m      4\x1B[0m     sample_name\x1B[38;5;241m=\x1B[39msample_name,\n' +
      '\x1B[1;32m      5\x1B[0m     vectorizer\x1B[38;5;241m=\x1B[39mvectorizer,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m     14\x1B[0m     IsLarge\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m\n' +
      '\x1B[1;32m     15\x1B[0m )\n' +
      '\x1B[1;32m     17\x1B[0m \x1B[38;5;66;03m# مرتب‌سازی نهایی بر اساس نام\x1B[39;00m\n' +
      '\x1B[0;32m---> 18\x1B[0m initial_named \x1B[38;5;241m=\x1B[39m \x1B[38;5;28msorted\x1B[39m([(code, \x1B[43mcode_to_name\x1B[49m\x1B[38;5;241m.\x1B[39mget(code, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m"\x1B[39m)) \x1B[38;5;28;01mfor\x1B[39;00m code \x1B[38;5;129;01min\x1B[39;00m initial], key\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m x: x[\x1B[38;5;241m1\x1B[39m])\n' +
      '\x1B[1;32m     19\x1B[0m final_named \x1B[38;5;241m=\x1B[39m \x1B[38;5;28msorted\x1B[39m([(code, code_to_name\x1B[38;5;241m.\x1B[39mget(code, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m"\x1B[39m)) \x1B[38;5;28;01mfor\x1B[39;00m code \x1B[38;5;129;01min\x1B[39;00m final], key\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m x: x[\x1B[38;5;241m1\x1B[39m])\n' +
      '\x1B[1;32m     21\x1B[0m \x1B[38;5;66;03m# ایجاد جدول\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'code_to_name' is not defined"
  ]
}
06:59:58.856 [warn] Cell completed with errors lu [Error]: 'MasterTestCode'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'MasterTestCode'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[33], line 5\x1B[0m\n' +
      '\x1B[1;32m      3\x1B[0m test_info_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCodeToName.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      4\x1B[0m test_info_df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m test_info_df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()  \x1B[38;5;66;03m# حذف فاصله اضافی\x1B[39;00m\n' +
      "\x1B[0;32m----> 5\x1B[0m code_to_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mdict\x1B[39m(\x1B[38;5;28mzip\x1B[39m(\x1B[43mtest_info_df\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[43m]\x1B[49m, test_info_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]))\n" +
      '\x1B[1;32m      6\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'"
  ]
}
07:07:28.510 [warn] Cell completed with errors lu [Error]: 'MasterTestCode'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'MasterTestCode'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[39], line 7\x1B[0m\n' +
      '\x1B[1;32m      4\x1B[0m test_info_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCodeToName.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      5\x1B[0m test_info_df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m test_info_df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()  \x1B[38;5;66;03m# اطمینان از تمیزی\x1B[39;00m\n' +
      '\x1B[1;32m      6\x1B[0m code_to_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mdict\x1B[39m(\x1B[38;5;28mzip\x1B[39m(\n' +
      "\x1B[0;32m----> 7\x1B[0m     \x1B[43mtest_info_df\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip(),\n" +
      "\x1B[1;32m      8\x1B[0m     test_info_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n" +
      '\x1B[1;32m      9\x1B[0m ))\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'"
  ]
}
07:08:01.317 [warn] Cell completed with errors lu [Error]: 'MasterTestCode'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'MasterTestCode'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[40], line 7\x1B[0m\n' +
      '\x1B[1;32m      4\x1B[0m test_info_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCodeToName.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      5\x1B[0m test_info_df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m test_info_df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()  \x1B[38;5;66;03m# اطمینان از تمیزی\x1B[39;00m\n' +
      '\x1B[1;32m      6\x1B[0m code_to_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mdict\x1B[39m(\x1B[38;5;28mzip\x1B[39m(\n' +
      "\x1B[0;32m----> 7\x1B[0m     \x1B[43mtest_info_df\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip(),\n" +
      "\x1B[1;32m      8\x1B[0m     test_info_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n" +
      '\x1B[1;32m      9\x1B[0m ))\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'"
  ]
}
07:16:46.501 [warn] Cell completed with errors lu [Error]: 'MasterTestCode'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'MasterTestCode'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[45], line 7\x1B[0m\n' +
      `\x1B[1;32m      4\x1B[0m test_info_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCodeToName.csv\x1B[39m\x1B[38;5;124m"\x1B[39m, sep\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;130;01m\\t\x1B[39;00m\x1B[38;5;124m'\x1B[39m)\n` +
      "\x1B[1;32m      5\x1B[0m test_info_df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m test_info_df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mreplace(\x1B[38;5;124m'\x1B[39m\x1B[38;5;130;01m\\ufeff\x1B[39;00m\x1B[38;5;124m'\x1B[39m, \x1B[38;5;124m'\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m      6\x1B[0m code_to_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mdict\x1B[39m(\x1B[38;5;28mzip\x1B[39m(\n' +
      "\x1B[0;32m----> 7\x1B[0m     \x1B[43mtest_info_df\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mstr\x1B[39m)\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip(),\n" +
      "\x1B[1;32m      8\x1B[0m     test_info_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mstr\x1B[39m)\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n" +
      '\x1B[1;32m      9\x1B[0m ))\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'"
  ]
}
07:17:08.026 [warn] Cell completed with errors lu [Error]: 'MasterTestCode'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'MasterTestCode'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[46], line 7\x1B[0m\n' +
      `\x1B[1;32m      4\x1B[0m test_info_df \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCodeToName.csv\x1B[39m\x1B[38;5;124m"\x1B[39m, sep\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;130;01m\\t\x1B[39;00m\x1B[38;5;124m'\x1B[39m)\n` +
      "\x1B[1;32m      5\x1B[0m test_info_df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m test_info_df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mreplace(\x1B[38;5;124m'\x1B[39m\x1B[38;5;130;01m\\ufeff\x1B[39;00m\x1B[38;5;124m'\x1B[39m, \x1B[38;5;124m'\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m      6\x1B[0m code_to_name \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mdict\x1B[39m(\x1B[38;5;28mzip\x1B[39m(\n' +
      "\x1B[0;32m----> 7\x1B[0m     \x1B[43mtest_info_df\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m'\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mstr\x1B[39m)\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip(),\n" +
      "\x1B[1;32m      8\x1B[0m     test_info_df[\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mMasterName\x1B[39m\x1B[38;5;124m'\x1B[39m]\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mstr\x1B[39m)\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n" +
      '\x1B[1;32m      9\x1B[0m ))\n' +
      '\x1B[1;32m     11\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ داده‌های co-occurrence لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'MasterTestCode'"
  ]
}
07:26:23.428 [info] Interrupt kernel execution
07:26:23.429 [info] Interrupt requested /mnt/data/rasfai/enrich_prediction.ipynb
07:26:23.429 [info] Interrupt kernel execution
07:26:23.430 [info] Interrupting kernel: new_rasfai
07:26:23.431 [info] Interrupting kernel via SIGINT
07:26:24.533 [warn] Cell completed with errors (cancelled)
07:26:24.540 [info] Interrupt requested & sent for /mnt/data/rasfai/enrich_prediction.ipynb in notebookEditor.
07:30:07.406 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
07:30:07.406 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
07:30:07.407 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
07:30:07.407 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:08:54.325 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for 'Untitled-1.ipynb' (disableUI=false)
08:08:54.588 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:08:54.627 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
08:08:54.795 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3330e83e299ea863cff8dce922743ee779590ff8e.json
    > cwd: /mnt/data/rasfai
08:08:55.867 [info] Kernel successfully started
08:08:55.869 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
08:08:56.850 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
08:09:51.371 [warn] Cell completed with errors lu [Error]: unexpected indent (3366638500.py, line 2)
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'IndentationError',
  evalue: 'unexpected indent (3366638500.py, line 2)',
  traceback: [
    '\x1B[0;36m  Cell \x1B[0;32mIn[4], line 2\x1B[0;36m\x1B[0m\n' +
      '\x1B[0;31m    dep = self.test_dependencies.copy()\x1B[0m\n' +
      '\x1B[0m    ^\x1B[0m\n' +
      '\x1B[0;31mIndentationError\x1B[0m\x1B[0;31m:\x1B[0m unexpected indent\n'
  ]
}
08:12:30.550 [warn] Cell completed with errors lu [Error]: [Errno 2] No such file or directory: 'test_similarity.csv'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'FileNotFoundError',
  evalue: "[Errno 2] No such file or directory: 'test_similarity.csv'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mFileNotFoundError\x1B[0m                         Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[10], line 3\x1B[0m\n' +
      "\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;18m__name__\x1B[39m \x1B[38;5;241m==\x1B[39m \x1B[38;5;124m'\x1B[39m\x1B[38;5;124m__main__\x1B[39m\x1B[38;5;124m'\x1B[39m:\n" +
      '\x1B[1;32m      2\x1B[0m     df_main \x1B[38;5;241m=\x1B[39m pd\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mData_Final.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m----> 3\x1B[0m     df_dep \x1B[38;5;241m=\x1B[39m \x1B[43mpd\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mread_csv\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mtest_similarity.csv\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m      5\x1B[0m     predictor \x1B[38;5;241m=\x1B[39m TestPredictor(df_main, df_dep)\n' +
      '\x1B[1;32m      6\x1B[0m     X, y \x1B[38;5;241m=\x1B[39m predictor\x1B[38;5;241m.\x1B[39mprepare_data()\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1026\x1B[0m, in \x1B[0;36mread_csv\x1B[0;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\x1B[0m\n' +
      '\x1B[1;32m   1013\x1B[0m kwds_defaults \x1B[38;5;241m=\x1B[39m _refine_defaults_read(\n' +
      '\x1B[1;32m   1014\x1B[0m     dialect,\n' +
      '\x1B[1;32m   1015\x1B[0m     delimiter,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1022\x1B[0m     dtype_backend\x1B[38;5;241m=\x1B[39mdtype_backend,\n' +
      '\x1B[1;32m   1023\x1B[0m )\n' +
      '\x1B[1;32m   1024\x1B[0m kwds\x1B[38;5;241m.\x1B[39mupdate(kwds_defaults)\n' +
      '\x1B[0;32m-> 1026\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43m_read\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:620\x1B[0m, in \x1B[0;36m_read\x1B[0;34m(filepath_or_buffer, kwds)\x1B[0m\n' +
      '\x1B[1;32m    617\x1B[0m _validate_names(kwds\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mnames\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mNone\x1B[39;00m))\n' +
      '\x1B[1;32m    619\x1B[0m \x1B[38;5;66;03m# Create the parser.\x1B[39;00m\n' +
      '\x1B[0;32m--> 620\x1B[0m parser \x1B[38;5;241m=\x1B[39m \x1B[43mTextFileReader\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    622\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m chunksize \x1B[38;5;129;01mor\x1B[39;00m iterator:\n' +
      '\x1B[1;32m    623\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m parser\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1620\x1B[0m, in \x1B[0;36mTextFileReader.__init__\x1B[0;34m(self, f, engine, **kwds)\x1B[0m\n' +
      '\x1B[1;32m   1617\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39moptions[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m] \x1B[38;5;241m=\x1B[39m kwds[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m   1619\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles: IOHandles \x1B[38;5;241m|\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[0;32m-> 1620\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_engine \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_make_engine\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mengine\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1880\x1B[0m, in \x1B[0;36mTextFileReader._make_engine\x1B[0;34m(self, f, engine)\x1B[0m\n' +
      '\x1B[1;32m   1878\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m mode:\n' +
      '\x1B[1;32m   1879\x1B[0m         mode \x1B[38;5;241m+\x1B[39m\x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m-> 1880\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;241m=\x1B[39m \x1B[43mget_handle\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1881\x1B[0m \x1B[43m    \x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1882\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[43m    \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[43m    \x1B[49m\x1B[43mcompression\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcompression\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1885\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmemory_map\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmemory_map\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m \x1B[43m    \x1B[49m\x1B[43mis_text\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mis_text\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1887\x1B[0m \x1B[43m    \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding_errors\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstrict\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1888\x1B[0m \x1B[43m    \x1B[49m\x1B[43mstorage_options\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstorage_options\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1889\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1890\x1B[0m \x1B[38;5;28;01massert\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[1;32m   1891\x1B[0m f \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles\x1B[38;5;241m.\x1B[39mhandle\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/common.py:873\x1B[0m, in \x1B[0;36mget_handle\x1B[0;34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\x1B[0m\n' +
      '\x1B[1;32m    868\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(handle, \x1B[38;5;28mstr\x1B[39m):\n' +
      '\x1B[1;32m    869\x1B[0m     \x1B[38;5;66;03m# Check whether the filename is to be opened in binary mode.\x1B[39;00m\n' +
      "\x1B[1;32m    870\x1B[0m     \x1B[38;5;66;03m# Binary mode does not support 'encoding' and 'newline'.\x1B[39;00m\n" +
      '\x1B[1;32m    871\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mencoding \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mmode:\n' +
      '\x1B[1;32m    872\x1B[0m         \x1B[38;5;66;03m# Encoding\x1B[39;00m\n' +
      '\x1B[0;32m--> 873\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mopen\x1B[39;49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    874\x1B[0m \x1B[43m            \x1B[49m\x1B[43mhandle\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    875\x1B[0m \x1B[43m            \x1B[49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    876\x1B[0m \x1B[43m            \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mencoding\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    877\x1B[0m \x1B[43m            \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43merrors\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    878\x1B[0m \x1B[43m            \x1B[49m\x1B[43mnewline\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    879\x1B[0m \x1B[43m        \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    880\x1B[0m     \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    881\x1B[0m         \x1B[38;5;66;03m# Binary mode\x1B[39;00m\n' +
      '\x1B[1;32m    882\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mopen\x1B[39m(handle, ioargs\x1B[38;5;241m.\x1B[39mmode)\n',
    "\x1B[0;31mFileNotFoundError\x1B[0m: [Errno 2] No such file or directory: 'test_similarity.csv'"
  ]
}
08:15:23.325 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:23.625 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:23.625 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:23.625 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:23.808 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:23.808 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:24.025 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:24.025 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:15:24.239 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:25:48.810 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:48.811 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.538 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.538 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.774 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.774 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.774 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.774 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.991 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.991 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:49.991 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.267 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.268 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.843 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:25:50.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/enrich_prediction.ipynb
08:33:09.253 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
08:38:18.284 [warn] Cell completed with errors lu [Error]: No module named 'tensorflow'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ModuleNotFoundError',
  evalue: "No module named 'tensorflow'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mModuleNotFoundError\x1B[0m                       Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[13], line 6\x1B[0m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01msklearn\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mmodel_selection\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m train_test_split\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01msklearn\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mpreprocessing\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m StandardScaler, MultiLabelBinarizer\n' +
      '\x1B[0;32m----> 6\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mtensorflow\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mkeras\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mmodels\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m Model\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mtensorflow\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mkeras\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mlayers\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m Input, Dense, Embedding, LSTM, concatenate, Dropout, BatchNormalization\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mtensorflow\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mkeras\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mpreprocessing\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mtext\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m Tokenizer\n',
    "\x1B[0;31mModuleNotFoundError\x1B[0m: No module named 'tensorflow'"
  ]
}
08:44:53.187 [info] Disposing kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher for notebook Untitled-1.ipynb due to selection of another kernel or closing of the notebook
08:44:53.188 [info] Dispose Kernel 'Untitled-1.ipynb' associated with 'Untitled-1.ipynb'
08:44:53.247 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
08:44:53.248 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
08:44:53.248 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
08:49:31.562 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/NewModel.ipynb' (disableUI=false)
08:49:31.793 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
08:49:31.841 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:49:31.883 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v34ff173a56402ef7cdef2ac1346d786d7d9a232f9.json
    > cwd: /mnt/data/rasfai
08:49:33.122 [info] Kernel successfully started
08:49:33.123 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
08:49:34.037 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
09:00:33.992 [warn] Cell completed with errors lu [Error]: "Column(s) ['Destruct'] do not exist"
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: `"Column(s) ['Destruct'] do not exist"`,
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[4], line 3\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# ------------------ GROUPING SAMPLES --------------------\x1B[39;00m\n' +
      '\x1B[1;32m      2\x1B[0m grouped \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28mlist\x1B[39m)\x1B[38;5;241m.\x1B[39mreset_index()\n' +
      '\x1B[0;32m----> 3\x1B[0m features \x1B[38;5;241m=\x1B[39m \x1B[43mdf\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mgroupby\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mSampleName\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg\x1B[49m\x1B[43m(\x1B[49m\x1B[43m{\x1B[49m\n' +
      '\x1B[1;32m      4\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mFeBase\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mDestruct\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mIsLarge\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mNonDestructPercent\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mFeBaseDependency\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[43m}\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241m.\x1B[39mreset_index()\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/generic.py:1432\x1B[0m, in \x1B[0;36mDataFrameGroupBy.aggregate\x1B[0;34m(self, func, engine, engine_kwargs, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1429\x1B[0m     kwargs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine_kwargs\x1B[39m\x1B[38;5;124m"\x1B[39m] \x1B[38;5;241m=\x1B[39m engine_kwargs\n' +
      '\x1B[1;32m   1431\x1B[0m op \x1B[38;5;241m=\x1B[39m GroupByApply(\x1B[38;5;28mself\x1B[39m, func, args\x1B[38;5;241m=\x1B[39margs, kwargs\x1B[38;5;241m=\x1B[39mkwargs)\n' +
      '\x1B[0;32m-> 1432\x1B[0m result \x1B[38;5;241m=\x1B[39m \x1B[43mop\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1433\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m is_dict_like(func) \x1B[38;5;129;01mand\x1B[39;00m result \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m   1434\x1B[0m     \x1B[38;5;66;03m# GH #52849\x1B[39;00m\n' +
      '\x1B[1;32m   1435\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mas_index \x1B[38;5;129;01mand\x1B[39;00m is_list_like(func):\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:190\x1B[0m, in \x1B[0;36mApply.agg\x1B[0;34m(self)\x1B[0m\n' +
      '\x1B[1;32m    187\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mapply_str()\n' +
      '\x1B[1;32m    189\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_dict_like(func):\n' +
      '\x1B[0;32m--> 190\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg_dict_like\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    191\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m is_list_like(func):\n' +
      "\x1B[1;32m    192\x1B[0m     \x1B[38;5;66;03m# we require a list, but not a 'str'\x1B[39;00m\n" +
      '\x1B[1;32m    193\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39magg_list_like()\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:423\x1B[0m, in \x1B[0;36mApply.agg_dict_like\x1B[0;34m(self)\x1B[0m\n' +
      '\x1B[1;32m    415\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21magg_dict_like\x1B[39m(\x1B[38;5;28mself\x1B[39m) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m DataFrame \x1B[38;5;241m|\x1B[39m Series:\n' +
      '\x1B[1;32m    416\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m    417\x1B[0m \x1B[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\x1B[39;00m\n' +
      '\x1B[1;32m    418\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m    421\x1B[0m \x1B[38;5;124;03m    Result of aggregation.\x1B[39;00m\n' +
      '\x1B[1;32m    422\x1B[0m \x1B[38;5;124;03m    """\x1B[39;00m\n' +
      '\x1B[0;32m--> 423\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg_or_apply_dict_like\x1B[49m\x1B[43m(\x1B[49m\x1B[43mop_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43magg\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:1608\x1B[0m, in \x1B[0;36mGroupByApply.agg_or_apply_dict_like\x1B[0;34m(self, op_name)\x1B[0m\n' +
      '\x1B[1;32m   1603\x1B[0m     kwargs\x1B[38;5;241m.\x1B[39mupdate({\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine\x1B[39m\x1B[38;5;124m"\x1B[39m: engine, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine_kwargs\x1B[39m\x1B[38;5;124m"\x1B[39m: engine_kwargs})\n' +
      '\x1B[1;32m   1605\x1B[0m \x1B[38;5;28;01mwith\x1B[39;00m com\x1B[38;5;241m.\x1B[39mtemp_setattr(\n' +
      '\x1B[1;32m   1606\x1B[0m     obj, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mas_index\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m, condition\x1B[38;5;241m=\x1B[39m\x1B[38;5;28mhasattr\x1B[39m(obj, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mas_index\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m   1607\x1B[0m ):\n' +
      '\x1B[0;32m-> 1608\x1B[0m     result_index, result_data \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcompute_dict_like\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1609\x1B[0m \x1B[43m        \x1B[49m\x1B[43mop_name\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselected_obj\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselection\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mkwargs\x1B[49m\n' +
      '\x1B[1;32m   1610\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1611\x1B[0m result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n' +
      '\x1B[1;32m   1612\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:462\x1B[0m, in \x1B[0;36mApply.compute_dict_like\x1B[0;34m(self, op_name, selected_obj, selection, kwargs)\x1B[0m\n' +
      '\x1B[1;32m    460\x1B[0m is_groupby \x1B[38;5;241m=\x1B[39m \x1B[38;5;28misinstance\x1B[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n' +
      '\x1B[1;32m    461\x1B[0m func \x1B[38;5;241m=\x1B[39m cast(AggFuncTypeDict, \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mfunc)\n' +
      '\x1B[0;32m--> 462\x1B[0m func \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mnormalize_dictlike_arg\x1B[49m\x1B[43m(\x1B[49m\x1B[43mop_name\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselected_obj\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mfunc\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    464\x1B[0m is_non_unique_col \x1B[38;5;241m=\x1B[39m (\n' +
      '\x1B[1;32m    465\x1B[0m     selected_obj\x1B[38;5;241m.\x1B[39mndim \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m2\x1B[39m\n' +
      '\x1B[1;32m    466\x1B[0m     \x1B[38;5;129;01mand\x1B[39;00m selected_obj\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnunique() \x1B[38;5;241m<\x1B[39m \x1B[38;5;28mlen\x1B[39m(selected_obj\x1B[38;5;241m.\x1B[39mcolumns)\n' +
      '\x1B[1;32m    467\x1B[0m )\n' +
      '\x1B[1;32m    469\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m selected_obj\x1B[38;5;241m.\x1B[39mndim \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m    470\x1B[0m     \x1B[38;5;66;03m# key only used for output\x1B[39;00m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:663\x1B[0m, in \x1B[0;36mApply.normalize_dictlike_arg\x1B[0;34m(self, how, obj, func)\x1B[0m\n' +
      '\x1B[1;32m    661\x1B[0m     cols \x1B[38;5;241m=\x1B[39m Index(\x1B[38;5;28mlist\x1B[39m(func\x1B[38;5;241m.\x1B[39mkeys()))\x1B[38;5;241m.\x1B[39mdifference(obj\x1B[38;5;241m.\x1B[39mcolumns, sort\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mTrue\x1B[39;00m)\n' +
      '\x1B[1;32m    662\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mlen\x1B[39m(cols) \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m0\x1B[39m:\n' +
      '\x1B[0;32m--> 663\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mColumn(s) \x1B[39m\x1B[38;5;132;01m{\x1B[39;00m\x1B[38;5;28mlist\x1B[39m(cols)\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m do not exist\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m    665\x1B[0m aggregator_types \x1B[38;5;241m=\x1B[39m (\x1B[38;5;28mlist\x1B[39m, \x1B[38;5;28mtuple\x1B[39m, \x1B[38;5;28mdict\x1B[39m)\n' +
      '\x1B[1;32m    667\x1B[0m \x1B[38;5;66;03m# if we have a dict of any non-scalars\x1B[39;00m\n' +
      "\x1B[1;32m    668\x1B[0m \x1B[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\x1B[39;00m\n" +
      '\x1B[1;32m    669\x1B[0m \x1B[38;5;66;03m# be list-likes\x1B[39;00m\n' +
      '\x1B[1;32m    670\x1B[0m \x1B[38;5;66;03m# Cannot use func.values() because arg may be a Series\x1B[39;00m\n',
    `\x1B[0;31mKeyError\x1B[0m: "Column(s) ['Destruct'] do not exist"`
  ]
}
09:49:08.635 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
09:50:25.072 [warn] Cell completed with errors lu [Error]: "Column(s) ['Destruct'] do not exist"
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: `"Column(s) ['Destruct'] do not exist"`,
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[6], line 11\x1B[0m\n' +
      '\x1B[1;32m      8\x1B[0m     \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m      9\x1B[0m         \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m⚠️ ستون‌های Destruct_x و Destruct_y تفاوت دارند!\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m---> 11\x1B[0m features \x1B[38;5;241m=\x1B[39m \x1B[43mdf\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mgroupby\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mSampleName\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg\x1B[49m\x1B[43m(\x1B[49m\x1B[43m{\x1B[49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mFeBase\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     13\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mDestruct\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mIsLarge\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     15\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mNonDestructPercent\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     16\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mFeBaseDependency\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmean\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\n' +
      '\x1B[1;32m     17\x1B[0m \x1B[43m}\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241m.\x1B[39mreset_index()\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/generic.py:1432\x1B[0m, in \x1B[0;36mDataFrameGroupBy.aggregate\x1B[0;34m(self, func, engine, engine_kwargs, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1429\x1B[0m     kwargs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine_kwargs\x1B[39m\x1B[38;5;124m"\x1B[39m] \x1B[38;5;241m=\x1B[39m engine_kwargs\n' +
      '\x1B[1;32m   1431\x1B[0m op \x1B[38;5;241m=\x1B[39m GroupByApply(\x1B[38;5;28mself\x1B[39m, func, args\x1B[38;5;241m=\x1B[39margs, kwargs\x1B[38;5;241m=\x1B[39mkwargs)\n' +
      '\x1B[0;32m-> 1432\x1B[0m result \x1B[38;5;241m=\x1B[39m \x1B[43mop\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1433\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m is_dict_like(func) \x1B[38;5;129;01mand\x1B[39;00m result \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m   1434\x1B[0m     \x1B[38;5;66;03m# GH #52849\x1B[39;00m\n' +
      '\x1B[1;32m   1435\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mas_index \x1B[38;5;129;01mand\x1B[39;00m is_list_like(func):\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:190\x1B[0m, in \x1B[0;36mApply.agg\x1B[0;34m(self)\x1B[0m\n' +
      '\x1B[1;32m    187\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mapply_str()\n' +
      '\x1B[1;32m    189\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_dict_like(func):\n' +
      '\x1B[0;32m--> 190\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg_dict_like\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    191\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m is_list_like(func):\n' +
      "\x1B[1;32m    192\x1B[0m     \x1B[38;5;66;03m# we require a list, but not a 'str'\x1B[39;00m\n" +
      '\x1B[1;32m    193\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39magg_list_like()\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:423\x1B[0m, in \x1B[0;36mApply.agg_dict_like\x1B[0;34m(self)\x1B[0m\n' +
      '\x1B[1;32m    415\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21magg_dict_like\x1B[39m(\x1B[38;5;28mself\x1B[39m) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m DataFrame \x1B[38;5;241m|\x1B[39m Series:\n' +
      '\x1B[1;32m    416\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m    417\x1B[0m \x1B[38;5;124;03m    Compute aggregation in the case of a dict-like argument.\x1B[39;00m\n' +
      '\x1B[1;32m    418\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m    421\x1B[0m \x1B[38;5;124;03m    Result of aggregation.\x1B[39;00m\n' +
      '\x1B[1;32m    422\x1B[0m \x1B[38;5;124;03m    """\x1B[39;00m\n' +
      '\x1B[0;32m--> 423\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43magg_or_apply_dict_like\x1B[49m\x1B[43m(\x1B[49m\x1B[43mop_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43magg\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:1608\x1B[0m, in \x1B[0;36mGroupByApply.agg_or_apply_dict_like\x1B[0;34m(self, op_name)\x1B[0m\n' +
      '\x1B[1;32m   1603\x1B[0m     kwargs\x1B[38;5;241m.\x1B[39mupdate({\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine\x1B[39m\x1B[38;5;124m"\x1B[39m: engine, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mengine_kwargs\x1B[39m\x1B[38;5;124m"\x1B[39m: engine_kwargs})\n' +
      '\x1B[1;32m   1605\x1B[0m \x1B[38;5;28;01mwith\x1B[39;00m com\x1B[38;5;241m.\x1B[39mtemp_setattr(\n' +
      '\x1B[1;32m   1606\x1B[0m     obj, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mas_index\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m, condition\x1B[38;5;241m=\x1B[39m\x1B[38;5;28mhasattr\x1B[39m(obj, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mas_index\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m   1607\x1B[0m ):\n' +
      '\x1B[0;32m-> 1608\x1B[0m     result_index, result_data \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcompute_dict_like\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1609\x1B[0m \x1B[43m        \x1B[49m\x1B[43mop_name\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselected_obj\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselection\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mkwargs\x1B[49m\n' +
      '\x1B[1;32m   1610\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1611\x1B[0m result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mwrap_results_dict_like(selected_obj, result_index, result_data)\n' +
      '\x1B[1;32m   1612\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:462\x1B[0m, in \x1B[0;36mApply.compute_dict_like\x1B[0;34m(self, op_name, selected_obj, selection, kwargs)\x1B[0m\n' +
      '\x1B[1;32m    460\x1B[0m is_groupby \x1B[38;5;241m=\x1B[39m \x1B[38;5;28misinstance\x1B[39m(obj, (DataFrameGroupBy, SeriesGroupBy))\n' +
      '\x1B[1;32m    461\x1B[0m func \x1B[38;5;241m=\x1B[39m cast(AggFuncTypeDict, \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mfunc)\n' +
      '\x1B[0;32m--> 462\x1B[0m func \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mnormalize_dictlike_arg\x1B[49m\x1B[43m(\x1B[49m\x1B[43mop_name\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mselected_obj\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mfunc\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    464\x1B[0m is_non_unique_col \x1B[38;5;241m=\x1B[39m (\n' +
      '\x1B[1;32m    465\x1B[0m     selected_obj\x1B[38;5;241m.\x1B[39mndim \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m2\x1B[39m\n' +
      '\x1B[1;32m    466\x1B[0m     \x1B[38;5;129;01mand\x1B[39;00m selected_obj\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnunique() \x1B[38;5;241m<\x1B[39m \x1B[38;5;28mlen\x1B[39m(selected_obj\x1B[38;5;241m.\x1B[39mcolumns)\n' +
      '\x1B[1;32m    467\x1B[0m )\n' +
      '\x1B[1;32m    469\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m selected_obj\x1B[38;5;241m.\x1B[39mndim \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m    470\x1B[0m     \x1B[38;5;66;03m# key only used for output\x1B[39;00m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/apply.py:663\x1B[0m, in \x1B[0;36mApply.normalize_dictlike_arg\x1B[0;34m(self, how, obj, func)\x1B[0m\n' +
      '\x1B[1;32m    661\x1B[0m     cols \x1B[38;5;241m=\x1B[39m Index(\x1B[38;5;28mlist\x1B[39m(func\x1B[38;5;241m.\x1B[39mkeys()))\x1B[38;5;241m.\x1B[39mdifference(obj\x1B[38;5;241m.\x1B[39mcolumns, sort\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mTrue\x1B[39;00m)\n' +
      '\x1B[1;32m    662\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mlen\x1B[39m(cols) \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m0\x1B[39m:\n' +
      '\x1B[0;32m--> 663\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mColumn(s) \x1B[39m\x1B[38;5;132;01m{\x1B[39;00m\x1B[38;5;28mlist\x1B[39m(cols)\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m do not exist\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m    665\x1B[0m aggregator_types \x1B[38;5;241m=\x1B[39m (\x1B[38;5;28mlist\x1B[39m, \x1B[38;5;28mtuple\x1B[39m, \x1B[38;5;28mdict\x1B[39m)\n' +
      '\x1B[1;32m    667\x1B[0m \x1B[38;5;66;03m# if we have a dict of any non-scalars\x1B[39;00m\n' +
      "\x1B[1;32m    668\x1B[0m \x1B[38;5;66;03m# eg. {'A' : ['mean']}, normalize all to\x1B[39;00m\n" +
      '\x1B[1;32m    669\x1B[0m \x1B[38;5;66;03m# be list-likes\x1B[39;00m\n' +
      '\x1B[1;32m    670\x1B[0m \x1B[38;5;66;03m# Cannot use func.values() because arg may be a Series\x1B[39;00m\n',
    `\x1B[0;31mKeyError\x1B[0m: "Column(s) ['Destruct'] do not exist"`
  ]
}
10:24:39.911 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for 'Untitled-1.ipynb' (disableUI=false)
10:24:40.167 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
10:24:40.208 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
10:24:40.389 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3282eaeca1676352de38cc672fda5bf59ca60a805.json
    > cwd: /mnt/data/rasfai
10:24:41.535 [info] Kernel successfully started
10:24:41.536 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
10:24:42.748 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
10:28:42.507 [warn] Cell completed with errors lu [Error]: sequence item 0: expected str instance, float found
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: 'sequence item 0: expected str instance, float found',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1824\x1B[0m, in \x1B[0;36mGroupBy.apply\x1B[0;34m(self, func, include_groups, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1823\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 1824\x1B[0m     result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_python_apply_general\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_selected_obj\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1825\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m (\n' +
      '\x1B[1;32m   1826\x1B[0m         \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mobj, Series)\n' +
      '\x1B[1;32m   1827\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_selection \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[1;32m   1828\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_selected_obj\x1B[38;5;241m.\x1B[39mshape \x1B[38;5;241m!=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_obj_with_exclusions\x1B[38;5;241m.\x1B[39mshape\n' +
      '\x1B[1;32m   1829\x1B[0m     ):\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1885\x1B[0m, in \x1B[0;36mGroupBy._python_apply_general\x1B[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\x1B[0m\n' +
      '\x1B[1;32m   1859\x1B[0m \x1B[38;5;250m\x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m   1860\x1B[0m \x1B[38;5;124;03mApply function f in python space\x1B[39;00m\n' +
      '\x1B[1;32m   1861\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[38;5;124;03m    data after applying f\x1B[39;00m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[0;32m-> 1885\x1B[0m values, mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_grouper\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply_groupwise\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdata\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43maxis\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m not_indexed_same \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/ops.py:919\x1B[0m, in \x1B[0;36mBaseGrouper.apply_groupwise\x1B[0;34m(self, f, data, axis)\x1B[0m\n' +
      '\x1B[1;32m    918\x1B[0m group_axes \x1B[38;5;241m=\x1B[39m group\x1B[38;5;241m.\x1B[39maxes\n' +
      '\x1B[0;32m--> 919\x1B[0m res \x1B[38;5;241m=\x1B[39m \x1B[43mf\x1B[49m\x1B[43m(\x1B[49m\x1B[43mgroup\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    920\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m mutated \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m _is_indexed_like(res, group_axes, axis):\n',
    'Cell \x1B[0;32mIn[7], line 2\x1B[0m, in \x1B[0;36m<lambda>\x1B[0;34m(x)\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# لیست آزمون‌ها برای هر نمونه\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m)\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m      4\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n",
    '\x1B[0;31mTypeError\x1B[0m: sequence item 0: expected str instance, float found',
    '\nDuring handling of the above exception, another exception occurred:\n',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[7], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# لیست آزمون‌ها برای هر نمونه\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m \x1B[43mdf\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mgroupby\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mSampleName\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43;01mlambda\x1B[39;49;00m\x1B[43m \x1B[49m\x1B[43mx\x1B[49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m      4\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m      5\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_tests)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/generic.py:230\x1B[0m, in \x1B[0;36mSeriesGroupBy.apply\x1B[0;34m(self, func, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m    224\x1B[0m \x1B[38;5;129m@Appender\x1B[39m(\n' +
      '\x1B[1;32m    225\x1B[0m     _apply_docs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mtemplate\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mformat(\n' +
      '\x1B[1;32m    226\x1B[0m         \x1B[38;5;28minput\x1B[39m\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mseries\x1B[39m\x1B[38;5;124m"\x1B[39m, examples\x1B[38;5;241m=\x1B[39m_apply_docs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mseries_examples\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m    227\x1B[0m     )\n' +
      '\x1B[1;32m    228\x1B[0m )\n' +
      '\x1B[1;32m    229\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mapply\x1B[39m(\x1B[38;5;28mself\x1B[39m, func, \x1B[38;5;241m*\x1B[39margs, \x1B[38;5;241m*\x1B[39m\x1B[38;5;241m*\x1B[39mkwargs) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m Series:\n' +
      '\x1B[0;32m--> 230\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43msuper\x1B[39;49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfunc\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43margs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1846\x1B[0m, in \x1B[0;36mGroupBy.apply\x1B[0;34m(self, func, include_groups, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1830\x1B[0m             warnings\x1B[38;5;241m.\x1B[39mwarn(\n' +
      '\x1B[1;32m   1831\x1B[0m                 message\x1B[38;5;241m=\x1B[39m_apply_groupings_depr\x1B[38;5;241m.\x1B[39mformat(\n' +
      '\x1B[1;32m   1832\x1B[0m                     \x1B[38;5;28mtype\x1B[39m(\x1B[38;5;28mself\x1B[39m)\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mapply\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1835\x1B[0m                 stacklevel\x1B[38;5;241m=\x1B[39mfind_stack_level(),\n' +
      '\x1B[1;32m   1836\x1B[0m             )\n' +
      '\x1B[1;32m   1837\x1B[0m     \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   1838\x1B[0m         \x1B[38;5;66;03m# gh-20949\x1B[39;00m\n' +
      '\x1B[1;32m   1839\x1B[0m         \x1B[38;5;66;03m# try again, with .apply acting as a filtering\x1B[39;00m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1843\x1B[0m         \x1B[38;5;66;03m# fails on *some* columns, e.g. a numeric operation\x1B[39;00m\n' +
      '\x1B[1;32m   1844\x1B[0m         \x1B[38;5;66;03m# on a string grouper column\x1B[39;00m\n' +
      '\x1B[0;32m-> 1846\x1B[0m         \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_python_apply_general\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_obj_with_exclusions\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1848\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1885\x1B[0m, in \x1B[0;36mGroupBy._python_apply_general\x1B[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\x1B[0m\n' +
      '\x1B[1;32m   1850\x1B[0m \x1B[38;5;129m@final\x1B[39m\n' +
      '\x1B[1;32m   1851\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21m_python_apply_general\x1B[39m(\n' +
      '\x1B[1;32m   1852\x1B[0m     \x1B[38;5;28mself\x1B[39m,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1857\x1B[0m     is_agg: \x1B[38;5;28mbool\x1B[39m \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mFalse\x1B[39;00m,\n' +
      '\x1B[1;32m   1858\x1B[0m ) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m NDFrameT:\n' +
      '\x1B[1;32m   1859\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m   1860\x1B[0m \x1B[38;5;124;03m    Apply function f in python space\x1B[39;00m\n' +
      '\x1B[1;32m   1861\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[38;5;124;03m        data after applying f\x1B[39;00m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[38;5;124;03m    """\x1B[39;00m\n' +
      '\x1B[0;32m-> 1885\x1B[0m     values, mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_grouper\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply_groupwise\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdata\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43maxis\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m not_indexed_same \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m   1887\x1B[0m         not_indexed_same \x1B[38;5;241m=\x1B[39m mutated\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/ops.py:919\x1B[0m, in \x1B[0;36mBaseGrouper.apply_groupwise\x1B[0;34m(self, f, data, axis)\x1B[0m\n' +
      '\x1B[1;32m    917\x1B[0m \x1B[38;5;66;03m# group might be modified\x1B[39;00m\n' +
      '\x1B[1;32m    918\x1B[0m group_axes \x1B[38;5;241m=\x1B[39m group\x1B[38;5;241m.\x1B[39maxes\n' +
      '\x1B[0;32m--> 919\x1B[0m res \x1B[38;5;241m=\x1B[39m \x1B[43mf\x1B[49m\x1B[43m(\x1B[49m\x1B[43mgroup\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    920\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m mutated \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m _is_indexed_like(res, group_axes, axis):\n' +
      '\x1B[1;32m    921\x1B[0m     mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mTrue\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[7], line 2\x1B[0m, in \x1B[0;36m<lambda>\x1B[0;34m(x)\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# لیست آزمون‌ها برای هر نمونه\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m)\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m      4\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m      5\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_tests)\n',
    '\x1B[0;31mTypeError\x1B[0m: sequence item 0: expected str instance, float found'
  ]
}
10:32:22.244 [warn] Cell completed with errors lu [Error]: sequence item 0: expected str instance, float found
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: 'sequence item 0: expected str instance, float found',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1824\x1B[0m, in \x1B[0;36mGroupBy.apply\x1B[0;34m(self, func, include_groups, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1823\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 1824\x1B[0m     result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_python_apply_general\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_selected_obj\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1825\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m (\n' +
      '\x1B[1;32m   1826\x1B[0m         \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mobj, Series)\n' +
      '\x1B[1;32m   1827\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_selection \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[1;32m   1828\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_selected_obj\x1B[38;5;241m.\x1B[39mshape \x1B[38;5;241m!=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_obj_with_exclusions\x1B[38;5;241m.\x1B[39mshape\n' +
      '\x1B[1;32m   1829\x1B[0m     ):\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1885\x1B[0m, in \x1B[0;36mGroupBy._python_apply_general\x1B[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\x1B[0m\n' +
      '\x1B[1;32m   1859\x1B[0m \x1B[38;5;250m\x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m   1860\x1B[0m \x1B[38;5;124;03mApply function f in python space\x1B[39;00m\n' +
      '\x1B[1;32m   1861\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[38;5;124;03m    data after applying f\x1B[39;00m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[0;32m-> 1885\x1B[0m values, mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_grouper\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply_groupwise\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdata\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43maxis\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m not_indexed_same \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/ops.py:919\x1B[0m, in \x1B[0;36mBaseGrouper.apply_groupwise\x1B[0;34m(self, f, data, axis)\x1B[0m\n' +
      '\x1B[1;32m    918\x1B[0m group_axes \x1B[38;5;241m=\x1B[39m group\x1B[38;5;241m.\x1B[39maxes\n' +
      '\x1B[0;32m--> 919\x1B[0m res \x1B[38;5;241m=\x1B[39m \x1B[43mf\x1B[49m\x1B[43m(\x1B[49m\x1B[43mgroup\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    920\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m mutated \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m _is_indexed_like(res, group_axes, axis):\n',
    'Cell \x1B[0;32mIn[8], line 8\x1B[0m, in \x1B[0;36m<lambda>\x1B[0;34m(x)\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m (\n' +
      '\x1B[1;32m      3\x1B[0m     df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m      4\x1B[0m     \x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;241m.\x1B[39mjoin(\x1B[38;5;28mstr\x1B[39m(i) \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m x\x1B[38;5;241m.\x1B[39mdropna()))\n' +
      '\x1B[1;32m      5\x1B[0m     \x1B[38;5;241m.\x1B[39mtolist()\n' +
      '\x1B[1;32m      6\x1B[0m )\n' +
      '\x1B[0;32m----> 8\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m)\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m     10\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n",
    '\x1B[0;31mTypeError\x1B[0m: sequence item 0: expected str instance, float found',
    '\nDuring handling of the above exception, another exception occurred:\n',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[8], line 8\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# لیست آزمون‌ها برای هر نمونه\x1B[39;00m\n' +
      '\x1B[1;32m      2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m (\n' +
      '\x1B[1;32m      3\x1B[0m     df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m      4\x1B[0m     \x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;241m.\x1B[39mjoin(\x1B[38;5;28mstr\x1B[39m(i) \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m x\x1B[38;5;241m.\x1B[39mdropna()))\n' +
      '\x1B[1;32m      5\x1B[0m     \x1B[38;5;241m.\x1B[39mtolist()\n' +
      '\x1B[1;32m      6\x1B[0m )\n' +
      '\x1B[0;32m----> 8\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m \x1B[43mdf\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mgroupby\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mSampleName\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43;01mlambda\x1B[39;49;00m\x1B[43m \x1B[49m\x1B[43mx\x1B[49m\x1B[43m:\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m     10\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m     11\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_tests)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/generic.py:230\x1B[0m, in \x1B[0;36mSeriesGroupBy.apply\x1B[0;34m(self, func, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m    224\x1B[0m \x1B[38;5;129m@Appender\x1B[39m(\n' +
      '\x1B[1;32m    225\x1B[0m     _apply_docs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mtemplate\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mformat(\n' +
      '\x1B[1;32m    226\x1B[0m         \x1B[38;5;28minput\x1B[39m\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mseries\x1B[39m\x1B[38;5;124m"\x1B[39m, examples\x1B[38;5;241m=\x1B[39m_apply_docs[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mseries_examples\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m    227\x1B[0m     )\n' +
      '\x1B[1;32m    228\x1B[0m )\n' +
      '\x1B[1;32m    229\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mapply\x1B[39m(\x1B[38;5;28mself\x1B[39m, func, \x1B[38;5;241m*\x1B[39margs, \x1B[38;5;241m*\x1B[39m\x1B[38;5;241m*\x1B[39mkwargs) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m Series:\n' +
      '\x1B[0;32m--> 230\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43msuper\x1B[39;49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfunc\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43margs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1846\x1B[0m, in \x1B[0;36mGroupBy.apply\x1B[0;34m(self, func, include_groups, *args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1830\x1B[0m             warnings\x1B[38;5;241m.\x1B[39mwarn(\n' +
      '\x1B[1;32m   1831\x1B[0m                 message\x1B[38;5;241m=\x1B[39m_apply_groupings_depr\x1B[38;5;241m.\x1B[39mformat(\n' +
      '\x1B[1;32m   1832\x1B[0m                     \x1B[38;5;28mtype\x1B[39m(\x1B[38;5;28mself\x1B[39m)\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mapply\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1835\x1B[0m                 stacklevel\x1B[38;5;241m=\x1B[39mfind_stack_level(),\n' +
      '\x1B[1;32m   1836\x1B[0m             )\n' +
      '\x1B[1;32m   1837\x1B[0m     \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   1838\x1B[0m         \x1B[38;5;66;03m# gh-20949\x1B[39;00m\n' +
      '\x1B[1;32m   1839\x1B[0m         \x1B[38;5;66;03m# try again, with .apply acting as a filtering\x1B[39;00m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1843\x1B[0m         \x1B[38;5;66;03m# fails on *some* columns, e.g. a numeric operation\x1B[39;00m\n' +
      '\x1B[1;32m   1844\x1B[0m         \x1B[38;5;66;03m# on a string grouper column\x1B[39;00m\n' +
      '\x1B[0;32m-> 1846\x1B[0m         \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_python_apply_general\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_obj_with_exclusions\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1848\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1885\x1B[0m, in \x1B[0;36mGroupBy._python_apply_general\x1B[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\x1B[0m\n' +
      '\x1B[1;32m   1850\x1B[0m \x1B[38;5;129m@final\x1B[39m\n' +
      '\x1B[1;32m   1851\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21m_python_apply_general\x1B[39m(\n' +
      '\x1B[1;32m   1852\x1B[0m     \x1B[38;5;28mself\x1B[39m,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1857\x1B[0m     is_agg: \x1B[38;5;28mbool\x1B[39m \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mFalse\x1B[39;00m,\n' +
      '\x1B[1;32m   1858\x1B[0m ) \x1B[38;5;241m-\x1B[39m\x1B[38;5;241m>\x1B[39m NDFrameT:\n' +
      '\x1B[1;32m   1859\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m   1860\x1B[0m \x1B[38;5;124;03m    Apply function f in python space\x1B[39;00m\n' +
      '\x1B[1;32m   1861\x1B[0m \n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[38;5;124;03m        data after applying f\x1B[39;00m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[38;5;124;03m    """\x1B[39;00m\n' +
      '\x1B[0;32m-> 1885\x1B[0m     values, mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_grouper\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mapply_groupwise\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdata\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43maxis\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m not_indexed_same \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      '\x1B[1;32m   1887\x1B[0m         not_indexed_same \x1B[38;5;241m=\x1B[39m mutated\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/groupby/ops.py:919\x1B[0m, in \x1B[0;36mBaseGrouper.apply_groupwise\x1B[0;34m(self, f, data, axis)\x1B[0m\n' +
      '\x1B[1;32m    917\x1B[0m \x1B[38;5;66;03m# group might be modified\x1B[39;00m\n' +
      '\x1B[1;32m    918\x1B[0m group_axes \x1B[38;5;241m=\x1B[39m group\x1B[38;5;241m.\x1B[39maxes\n' +
      '\x1B[0;32m--> 919\x1B[0m res \x1B[38;5;241m=\x1B[39m \x1B[43mf\x1B[49m\x1B[43m(\x1B[49m\x1B[43mgroup\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    920\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m mutated \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m _is_indexed_like(res, group_axes, axis):\n' +
      '\x1B[1;32m    921\x1B[0m     mutated \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mTrue\x1B[39;00m\n',
    'Cell \x1B[0;32mIn[8], line 8\x1B[0m, in \x1B[0;36m<lambda>\x1B[0;34m(x)\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# لیست آزمون‌ها برای هر نمونه\x1B[39;00m\n' +
      '\x1B[1;32m      2\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m (\n' +
      '\x1B[1;32m      3\x1B[0m     df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m      4\x1B[0m     \x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;241m.\x1B[39mjoin(\x1B[38;5;28mstr\x1B[39m(i) \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m x\x1B[38;5;241m.\x1B[39mdropna()))\n' +
      '\x1B[1;32m      5\x1B[0m     \x1B[38;5;241m.\x1B[39mtolist()\n' +
      '\x1B[1;32m      6\x1B[0m )\n' +
      '\x1B[0;32m----> 8\x1B[0m sample_tests \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mgroupby(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m)[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mapply(\x1B[38;5;28;01mlambda\x1B[39;00m x: \x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m \x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mjoin\x1B[49m\x1B[43m(\x1B[49m\x1B[43mx\x1B[49m\x1B[43m)\x1B[49m)\x1B[38;5;241m.\x1B[39mtolist()\n' +
      "\x1B[1;32m     10\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m     11\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_tests)\n',
    '\x1B[0;31mTypeError\x1B[0m: sequence item 0: expected str instance, float found'
  ]
}
10:56:41.109 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
10:56:41.653 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
10:56:41.872 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
10:56:42.087 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
10:56:42.088 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
11:18:44.478 [info] Disposing request as the cell (-1) was deleted Untitled-1.ipynb
11:32:47.660 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Full_Similarity_Computation_With_Tqdm.ipynb' (disableUI=true)
11:32:47.981 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
11:32:48.049 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
11:32:48.121 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3bd3e316b4e58e1d35985b9ec7e72b4ce26c39c3e.json
    > cwd: /mnt/data/rasfai
11:32:49.218 [info] Kernel successfully started
11:32:49.219 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
11:32:50.440 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
11:32:56.676 [info] Dispose Kernel '/mnt/data/rasfai/Full_Similarity_Computation_With_Tqdm.ipynb' associated with '/mnt/data/rasfai/Full_Similarity_Computation_With_Tqdm.ipynb'
11:33:02.825 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' (disableUI=true)
11:33:02.887 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
11:33:03.024 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3cb402dea7afe8ca0959c8c7304eb96c542adf1b8.json
    > cwd: /mnt/data/rasfai
11:33:04.178 [info] Kernel successfully started
11:33:04.179 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
11:33:04.756 [info] Dispose Kernel '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' associated with '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb'
11:33:20.294 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' (disableUI=true)
11:33:20.377 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
11:33:20.530 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v360dab9b871da1dd11fba0b85bb3a814ec8fe43ce.json
    > cwd: /mnt/data/rasfai
11:33:21.632 [info] Kernel successfully started
11:33:21.633 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
11:33:22.368 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
11:33:24.702 [info] Dispose Kernel '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' associated with '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb'
11:36:46.786 [info] Disposing kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher for notebook Untitled-1.ipynb due to selection of another kernel or closing of the notebook
11:36:46.786 [info] Dispose Kernel 'Untitled-1.ipynb' associated with 'Untitled-1.ipynb'
11:36:46.856 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.857 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
11:36:46.858 [info] Disposing request as the cell (1) was deleted Untitled-1.ipynb
11:36:46.860 [info] Disposing request as the cell (2) was deleted Untitled-1.ipynb
11:36:46.861 [info] Disposing request as the cell (3) was deleted Untitled-1.ipynb
11:36:46.879 [info] Disposing request as the cell (4) was deleted Untitled-1.ipynb
11:36:46.880 [info] Disposing request as the cell (5) was deleted Untitled-1.ipynb
11:36:46.882 [info] Disposing request as the cell (6) was deleted Untitled-1.ipynb
11:36:46.884 [info] Disposing request as the cell (7) was deleted Untitled-1.ipynb
11:36:46.885 [info] Disposing request as the cell (9) was deleted Untitled-1.ipynb
11:36:46.886 [info] Disposing request as the cell (9) was deleted Untitled-1.ipynb
11:36:46.887 [info] Disposing request as the cell (8) was deleted Untitled-1.ipynb
11:36:56.163 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/dependencies_calc.ipynb' (disableUI=false)
11:36:56.260 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
11:36:56.369 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v32d0b3039dd0786306158eeec57e6b51d24a6a210.json
    > cwd: /mnt/data/rasfai
11:36:57.644 [info] Kernel successfully started
11:36:57.646 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
11:36:58.519 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
11:49:14.028 [info] Disposing request as the cell (9) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
11:49:14.029 [info] Dispose Kernel '/mnt/data/rasfai/dependencies_calc.ipynb' associated with '/mnt/data/rasfai/dependencies_calc.ipynb'
12:00:12.162 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/dependencies_calc.ipynb' (disableUI=true)
12:00:12.480 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
12:00:12.577 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
12:00:12.631 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3999b8ab5a7a5dc552b26c5105a5a53dc81dc1e6a.json
    > cwd: /mnt/data/rasfai
12:00:13.863 [info] Kernel successfully started
12:00:13.864 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
12:00:15.285 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
12:08:05.730 [warn] Cell completed with errors lu [Error]: name 'CountVectorizer' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'CountVectorizer' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[15], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# vectorization\x1B[39;00m\n' +
      "\x1B[0;32m----> 2\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m \x1B[43mCountVectorizer\x1B[49m(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[1;32m      3\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_strings)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'CountVectorizer' is not defined"
  ]
}
12:09:03.162 [warn] Cell completed with errors lu [Error]: name 'sample_strings' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'sample_strings' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[17], line 3\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# vectorization\x1B[39;00m\n' +
      "\x1B[1;32m      2\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m CountVectorizer(token_pattern\x1B[38;5;241m=\x1B[39m\x1B[38;5;124mr\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+\x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      '\x1B[0;32m----> 3\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(\x1B[43msample_strings\x1B[49m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'sample_strings' is not defined"
  ]
}
12:09:53.601 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:09:53.851 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:09:54.283 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:09:54.283 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:13:59.271 [info] Interrupt kernel execution
12:13:59.272 [info] Interrupt requested /mnt/data/rasfai/dependencies_calc.ipynb
12:13:59.272 [info] Interrupt kernel execution
12:13:59.272 [info] Interrupting kernel: new_rasfai
12:13:59.273 [info] Interrupting kernel via SIGINT
12:14:09.429 [info] Interrupt requested & sent for /mnt/data/rasfai/dependencies_calc.ipynb in notebookEditor.
12:14:10.752 [info] Restart requested /mnt/data/rasfai/dependencies_calc.ipynb
12:14:10.821 [error] Error in waiting for code ms-toolsai.jupyter-1 to complete Error: Canceled future for execute_request message before replies were done
    at Ms.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:43404)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57939
    at Map.forEach (<anonymous>)
    at n._clearKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57925)
    at n.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:51191)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11117
    at ei (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:60:10695)
    at dT.start (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11093)
    at dT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:10878)
    at iT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:279:30759)
    at T_.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:33245)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at T_.interrupt (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:31928)
    at Function.wrapKernelMethodImpl (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:84016)
12:14:10.827 [error] Error in waiting for code ms-toolsai.jupyter-2 to complete Error: Canceled future for execute_request message before replies were done
    at Ms.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:43404)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57939
    at Map.forEach (<anonymous>)
    at n._clearKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57925)
    at n.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:51191)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11117
    at ei (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:60:10695)
    at dT.start (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11093)
    at dT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:10878)
    at iT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:279:30759)
    at T_.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:33245)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at T_.interrupt (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:31928)
    at Function.wrapKernelMethodImpl (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:84016)
12:14:10.828 [error] Error in waiting for code ms-toolsai.jupyter-3 to complete Error: Canceled future for execute_request message before replies were done
    at Ms.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:43404)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57939
    at Map.forEach (<anonymous>)
    at n._clearKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:57925)
    at n.dispose (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/node_modules/@jupyterlab/services/lib/kernel/default/index.js:17:51191)
    at ~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11117
    at ei (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:60:10695)
    at dT.start (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:11093)
    at dT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:10878)
    at iT.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:279:30759)
    at T_.restart (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:33245)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at T_.interrupt (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:31928)
    at Function.wrapKernelMethodImpl (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:84016)
12:14:11.072 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
12:14:11.116 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v37385e71174798ea3db59b4ad3d3d5455bafa8813.json
    > cwd: /mnt/data/rasfai
12:14:12.013 [info] Restarted cfe391fd-601e-4454-98ee-9445c3c88954
12:14:12.710 [warn] Cell completed with errors lu [Error]: name 'pd' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'pd' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mpd\x1B[49m[\x1B[38;5;241m10\x1B[39m:\x1B[38;5;241m20\x1B[39m])\n',
    "\x1B[0;31mNameError\x1B[0m: name 'pd' is not defined"
  ]
}
12:14:20.516 [warn] Cell completed with errors lu [Error]: name 'pd' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'pd' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[3], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# خواندن داده\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m df \x1B[38;5;241m=\x1B[39m \x1B[43mpd\x1B[49m\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mData_Final.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      3\x1B[0m df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n' +
      '\x1B[1;32m      4\x1B[0m df \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mdropna(subset\x1B[38;5;241m=\x1B[39m[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m])\n',
    "\x1B[0;31mNameError\x1B[0m: name 'pd' is not defined"
  ]
}
12:14:28.653 [warn] Cell completed with errors lu [Error]: name 'pd' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'pd' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[5], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# خواندن داده\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m df \x1B[38;5;241m=\x1B[39m \x1B[43mpd\x1B[49m\x1B[38;5;241m.\x1B[39mread_csv(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mData_Final.csv\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      3\x1B[0m df\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n' +
      '\x1B[1;32m      4\x1B[0m df \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39mdropna(subset\x1B[38;5;241m=\x1B[39m[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m])\n',
    "\x1B[0;31mNameError\x1B[0m: name 'pd' is not defined"
  ]
}
12:14:41.993 [info] Restart requested /mnt/data/rasfai/dependencies_calc.ipynb
12:14:42.123 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
12:14:42.213 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v33d20ee451b72606c8b95a3da5a28b6a7d3a823c8.json
    > cwd: /mnt/data/rasfai
12:14:43.053 [info] Restarted cfe391fd-601e-4454-98ee-9445c3c88954
12:15:34.850 [warn] Cell completed with errors lu [Error]: 'module' object is not subscriptable
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: "'module' object is not subscriptable",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[4], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mpd\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;241;43m10\x1B[39;49m\x1B[43m:\x1B[49m\x1B[38;5;241;43m20\x1B[39;49m\x1B[43m]\x1B[49m)\n',
    "\x1B[0;31mTypeError\x1B[0m: 'module' object is not subscriptable"
  ]
}
12:15:54.099 [warn] Cell completed with errors lu [Error]: 'module' object is not callable
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: "'module' object is not callable",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[5], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mpd\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdf\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mMasterTestCode\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m]\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mvalue_counts\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mhead\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m10\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m)\x1B[49m)\n',
    "\x1B[0;31mTypeError\x1B[0m: 'module' object is not callable"
  ]
}
12:18:34.608 [warn] Cell completed with errors lu [Error]: name 'important_pairs' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'important_pairs' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[13], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mimportant_pairs\x1B[49m\x1B[38;5;241m.\x1B[39mhead(\x1B[38;5;241m10\x1B[39m))\n',
    "\x1B[0;31mNameError\x1B[0m: name 'important_pairs' is not defined"
  ]
}
12:18:53.555 [warn] Cell completed with errors lu [Error]: 'numpy.ndarray' object has no attribute 'head'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'AttributeError',
  evalue: "'numpy.ndarray' object has no attribute 'head'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mAttributeError\x1B[0m                            Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[14], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mlabels\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mhead\x1B[49m(\x1B[38;5;241m10\x1B[39m))\n',
    "\x1B[0;31mAttributeError\x1B[0m: 'numpy.ndarray' object has no attribute 'head'"
  ]
}
12:19:07.766 [warn] Cell completed with errors lu [Error]: 'numpy.ndarray' object has no attribute 'head'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'AttributeError',
  evalue: "'numpy.ndarray' object has no attribute 'head'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mAttributeError\x1B[0m                            Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[15], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43msimilarity_matrix\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mhead\x1B[49m(\x1B[38;5;241m10\x1B[39m))\n',
    "\x1B[0;31mAttributeError\x1B[0m: 'numpy.ndarray' object has no attribute 'head'"
  ]
}
12:19:26.513 [warn] Cell completed with errors lu [Error]: 'list' object has no attribute 'head'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'AttributeError',
  evalue: "'list' object has no attribute 'head'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mAttributeError\x1B[0m                            Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[17], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[43mimportant_pairs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mhead\x1B[49m(\x1B[38;5;241m10\x1B[39m))\n',
    "\x1B[0;31mAttributeError\x1B[0m: 'list' object has no attribute 'head'"
  ]
}
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:43.508 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:49.546 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:54.950 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:54.950 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:19:54.950 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:20:27.981 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
12:22:17.182 [info] Interrupt kernel execution
12:22:17.183 [info] Interrupt requested /mnt/data/rasfai/dependencies_calc.ipynb
12:22:17.183 [info] Interrupt kernel execution
12:22:17.184 [info] Interrupting kernel: new_rasfai
12:22:17.184 [info] Interrupting kernel via SIGINT
12:22:27.320 [info] Interrupt requested & sent for /mnt/data/rasfai/dependencies_calc.ipynb in notebookEditor.
12:22:28.981 [info] Restart requested /mnt/data/rasfai/dependencies_calc.ipynb
12:22:29.100 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
12:22:29.202 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3785e73149f04d7d63642515e1084f738a0c95d81.json
    > cwd: /mnt/data/rasfai
12:22:30.064 [info] Restarted cfe391fd-601e-4454-98ee-9445c3c88954
12:22:52.127 [warn] Cell completed with errors lu [Error]: name 'CountVectorizer' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'CountVectorizer' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# بردارسازی\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m vectorizer \x1B[38;5;241m=\x1B[39m \x1B[43mCountVectorizer\x1B[49m(tokenizer\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m txt: txt\x1B[38;5;241m.\x1B[39msplit(), preprocessor\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mlambda\x1B[39;00m x: x)\n' +
      '\x1B[1;32m      3\x1B[0m X \x1B[38;5;241m=\x1B[39m vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(sample_strings)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'CountVectorizer' is not defined"
  ]
}
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.349 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.350 [info] Disposing request as the cell (1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.351 [info] Disposing request as the cell (1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.351 [info] Disposing request as the cell (1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.351 [info] Disposing request as the cell (1) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.352 [info] Disposing request as the cell (2) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.352 [info] Disposing request as the cell (2) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.352 [info] Disposing request as the cell (2) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.356 [info] Disposing request as the cell (3) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.358 [info] Disposing request as the cell (4) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.358 [info] Disposing request as the cell (4) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.358 [info] Disposing request as the cell (4) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.358 [info] Disposing request as the cell (4) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.358 [info] Disposing request as the cell (4) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.360 [info] Disposing request as the cell (5) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.360 [info] Disposing request as the cell (5) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.360 [info] Disposing request as the cell (5) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.362 [info] Disposing request as the cell (6) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.362 [info] Disposing request as the cell (6) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.362 [info] Disposing request as the cell (6) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.363 [info] Disposing request as the cell (7) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.363 [info] Disposing request as the cell (7) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.363 [info] Disposing request as the cell (7) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.363 [info] Disposing request as the cell (7) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.365 [info] Disposing request as the cell (8) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.369 [info] Disposing request as the cell (9) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.369 [info] Disposing request as the cell (9) was deleted /mnt/data/rasfai/dependencies_calc.ipynb
13:07:46.369 [info] Dispose Kernel '/mnt/data/rasfai/dependencies_calc.ipynb' associated with '/mnt/data/rasfai/dependencies_calc.ipynb'
13:07:49.931 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:07:50.171 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:07:50.400 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:07:50.400 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:15:39.985 [info] Interrupt kernel execution
13:15:39.985 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
13:15:40.060 [info] Interrupt kernel execution
13:15:40.061 [info] Interrupting kernel: new_rasfai
13:15:40.078 [info] Interrupting kernel via SIGINT
13:15:50.572 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
13:15:52.077 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
13:15:53.010 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
13:15:53.086 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v37d9ca9e94315f2d6e21ad3928fc180f80f2f1d2f.json
    > cwd: /mnt/data/rasfai
13:15:56.579 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
13:20:36.232 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:20:36.534 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:20:36.756 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
13:30:16.826 [warn] Cell completed with errors lu [Error]: Found input variables with inconsistent numbers of samples: [3044967, 774674]
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'Found input variables with inconsistent numbers of samples: [3044967, 774674]',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[7], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# ------------------ Split ------------------\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m X_train, X_test, y_train, y_test \x1B[38;5;241m=\x1B[39m \x1B[43mtrain_test_split\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_all\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_all\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mtest_size\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.1\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mrandom_state\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m42\x1B[39;49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/_param_validation.py:216\x1B[0m, in \x1B[0;36mvalidate_params.<locals>.decorator.<locals>.wrapper\x1B[0;34m(*args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m    210\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[1;32m    211\x1B[0m     \x1B[38;5;28;01mwith\x1B[39;00m config_context(\n' +
      '\x1B[1;32m    212\x1B[0m         skip_parameter_validation\x1B[38;5;241m=\x1B[39m(\n' +
      '\x1B[1;32m    213\x1B[0m             prefer_skip_nested_validation \x1B[38;5;129;01mor\x1B[39;00m global_skip_validation\n' +
      '\x1B[1;32m    214\x1B[0m         )\n' +
      '\x1B[1;32m    215\x1B[0m     ):\n' +
      '\x1B[0;32m--> 216\x1B[0m         \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43mfunc\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43margs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    217\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m InvalidParameterError \x1B[38;5;28;01mas\x1B[39;00m e:\n' +
      '\x1B[1;32m    218\x1B[0m     \x1B[38;5;66;03m# When the function is just a wrapper around an estimator, we allow\x1B[39;00m\n' +
      '\x1B[1;32m    219\x1B[0m     \x1B[38;5;66;03m# the function to delegate validation to the estimator, but we replace\x1B[39;00m\n' +
      '\x1B[1;32m    220\x1B[0m     \x1B[38;5;66;03m# the name of the estimator by the name of the function in the error\x1B[39;00m\n' +
      '\x1B[1;32m    221\x1B[0m     \x1B[38;5;66;03m# message to avoid confusion.\x1B[39;00m\n' +
      '\x1B[1;32m    222\x1B[0m     msg \x1B[38;5;241m=\x1B[39m re\x1B[38;5;241m.\x1B[39msub(\n' +
      '\x1B[1;32m    223\x1B[0m         \x1B[38;5;124mr\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mparameter of \x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+ must be\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m    224\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mparameter of \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mfunc\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__qualname__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m must be\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m    225\x1B[0m         \x1B[38;5;28mstr\x1B[39m(e),\n' +
      '\x1B[1;32m    226\x1B[0m     )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/model_selection/_split.py:2848\x1B[0m, in \x1B[0;36mtrain_test_split\x1B[0;34m(test_size, train_size, random_state, shuffle, stratify, *arrays)\x1B[0m\n' +
      '\x1B[1;32m   2845\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_arrays \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m0\x1B[39m:\n' +
      '\x1B[1;32m   2846\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mAt least one array required as input\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m-> 2848\x1B[0m arrays \x1B[38;5;241m=\x1B[39m \x1B[43mindexable\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43marrays\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2850\x1B[0m n_samples \x1B[38;5;241m=\x1B[39m _num_samples(arrays[\x1B[38;5;241m0\x1B[39m])\n' +
      '\x1B[1;32m   2851\x1B[0m n_train, n_test \x1B[38;5;241m=\x1B[39m _validate_shuffle_split(\n' +
      '\x1B[1;32m   2852\x1B[0m     n_samples, test_size, train_size, default_test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.25\x1B[39m\n' +
      '\x1B[1;32m   2853\x1B[0m )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:532\x1B[0m, in \x1B[0;36mindexable\x1B[0;34m(*iterables)\x1B[0m\n' +
      '\x1B[1;32m    502\x1B[0m \x1B[38;5;250m\x1B[39m\x1B[38;5;124;03m"""Make arrays indexable for cross-validation.\x1B[39;00m\n' +
      '\x1B[1;32m    503\x1B[0m \n' +
      '\x1B[1;32m    504\x1B[0m \x1B[38;5;124;03mChecks consistent length, passes through None, and ensures that everything\x1B[39;00m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      "\x1B[1;32m    528\x1B[0m \x1B[38;5;124;03m[[1, 2, 3], array([2, 3, 4]), None, <...Sparse...dtype 'int64'...shape (3, 1)>]\x1B[39;00m\n" +
      '\x1B[1;32m    529\x1B[0m \x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m    531\x1B[0m result \x1B[38;5;241m=\x1B[39m [_make_indexable(X) \x1B[38;5;28;01mfor\x1B[39;00m X \x1B[38;5;129;01min\x1B[39;00m iterables]\n' +
      '\x1B[0;32m--> 532\x1B[0m \x1B[43mcheck_consistent_length\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mresult\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    533\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:475\x1B[0m, in \x1B[0;36mcheck_consistent_length\x1B[0;34m(*arrays)\x1B[0m\n' +
      '\x1B[1;32m    473\x1B[0m uniques \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39munique(lengths)\n' +
      '\x1B[1;32m    474\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mlen\x1B[39m(uniques) \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[0;32m--> 475\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m    476\x1B[0m         \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFound input variables with inconsistent numbers of samples: \x1B[39m\x1B[38;5;132;01m%r\x1B[39;00m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m    477\x1B[0m         \x1B[38;5;241m%\x1B[39m [\x1B[38;5;28mint\x1B[39m(l) \x1B[38;5;28;01mfor\x1B[39;00m l \x1B[38;5;129;01min\x1B[39;00m lengths]\n' +
      '\x1B[1;32m    478\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: Found input variables with inconsistent numbers of samples: [3044967, 774674]'
  ]
}
13:30:16.835 [warn] Cancel all remaining cells due to cancellation or failure in execution
13:39:27.362 [warn] Cell completed with errors lu [Error]: name 'y_train' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_train' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[9], line 4\x1B[0m\n' +
      '\x1B[1;32m      2\x1B[0m models \x1B[38;5;241m=\x1B[39m []\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🎯 شروع آموزش مدل LightGBM برای هر برچسب...\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m----> 4\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m tqdm(\x1B[38;5;28mrange\x1B[39m(\x1B[43my_train\x1B[49m\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m1\x1B[39m]), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mTraining labels\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[1;32m      5\x1B[0m     y_label \x1B[38;5;241m=\x1B[39m y_train[:, i]\n' +
      '\x1B[1;32m      6\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m100\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m, n_jobs\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m-\x1B[39m\x1B[38;5;241m1\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y_train' is not defined"
  ]
}
14:48:00.655 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
14:48:00.998 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
14:48:01.060 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3e5ab8016c7f70a3143e940ed056caf2f65ce21f4.json
    > cwd: /mnt/data/rasfai
14:48:03.000 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
14:48:19.958 [warn] Cell completed with errors lu [Error]: name 'models' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'models' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 11\x1B[0m\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🧠 در حال پیش‌بینی برای داده‌های تست...\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m     10\x1B[0m y_preds \x1B[38;5;241m=\x1B[39m []\n' +
      '\x1B[0;32m---> 11\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m model \x1B[38;5;129;01min\x1B[39;00m tqdm(\x1B[43mmodels\x1B[49m, desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🚀 Predicting labels\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[1;32m     12\x1B[0m     preds \x1B[38;5;241m=\x1B[39m model\x1B[38;5;241m.\x1B[39mpredict(X_test)\n' +
      '\x1B[1;32m     13\x1B[0m     y_preds\x1B[38;5;241m.\x1B[39mappend(preds)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'models' is not defined"
  ]
}
14:51:10.094 [warn] Cell completed with errors lu [Error]: invalid load key, '\x10'.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'UnpicklingError',
  evalue: "invalid load key, '\\x10'.",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mUnpicklingError\x1B[0m                           Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[2], line 14\x1B[0m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m📦 در حال بارگذاری مدل‌ها...\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m     13\x1B[0m \x1B[38;5;28;01mwith\x1B[39;00m \x1B[38;5;28mopen\x1B[39m(MODEL_PATH, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mrb\x1B[39m\x1B[38;5;124m"\x1B[39m) \x1B[38;5;28;01mas\x1B[39;00m f:\n' +
      '\x1B[0;32m---> 14\x1B[0m     models \x1B[38;5;241m=\x1B[39m \x1B[43mpickle\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mload\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     15\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m✅ \x1B[39m\x1B[38;5;132;01m{\x1B[39;00m\x1B[38;5;28mlen\x1B[39m(models)\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m مدل لود شدند.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m     17\x1B[0m \x1B[38;5;66;03m# ---------------- Predict ----------------\x1B[39;00m\n',
    "\x1B[0;31mUnpicklingError\x1B[0m: invalid load key, '\\x10'."
  ]
}
14:54:31.277 [warn] Cell completed with errors lu [Error]: name 'X_test' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'X_test' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[3], line 27\x1B[0m\n' +
      '\x1B[1;32m     25\x1B[0m \x1B[38;5;66;03m# ---------------- Predict ----------------\x1B[39;00m\n' +
      '\x1B[1;32m     26\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔍 در حال پیش‌بینی روی داده تست...\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m---> 27\x1B[0m y_pred_proba \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mzeros((\x1B[43mX_test\x1B[49m\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m0\x1B[39m], \x1B[38;5;28mlen\x1B[39m(models)))\n' +
      '\x1B[1;32m     29\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i, model \x1B[38;5;129;01min\x1B[39;00m tqdm(\x1B[38;5;28menumerate\x1B[39m(models), total\x1B[38;5;241m=\x1B[39m\x1B[38;5;28mlen\x1B[39m(models), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mپیش‌بینی\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[1;32m     30\x1B[0m     y_pred_proba[:, i] \x1B[38;5;241m=\x1B[39m model\x1B[38;5;241m.\x1B[39mpredict_proba(X_test)[:, \x1B[38;5;241m1\x1B[39m]  \x1B[38;5;66;03m# گرفتن احتمال برچسب 1\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'X_test' is not defined"
  ]
}
15:00:41.597 [info] Interrupt kernel execution
15:00:41.598 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
15:00:41.599 [info] Interrupt kernel execution
15:00:41.600 [info] Interrupting kernel: new_rasfai
15:00:41.602 [info] Interrupting kernel via SIGINT
15:00:42.917 [warn] Cell completed with errors (cancelled)
15:00:42.943 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
15:00:46.100 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
15:00:46.894 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
15:00:46.957 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3a937a45e6c46737dc3f5b8d2fb28144d5fb53413.json
    > cwd: /mnt/data/rasfai
15:00:49.897 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
15:05:45.576 [warn] Cell completed with errors lu [Error]: X has 100 features, but LGBMClassifier is expecting 107 features as input.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'X has 100 features, but LGBMClassifier is expecting 107 features as input.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 37\x1B[0m\n' +
      '\x1B[1;32m     34\x1B[0m y_pred_proba \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mzeros((X_test\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m0\x1B[39m], \x1B[38;5;28mlen\x1B[39m(models)))\n' +
      '\x1B[1;32m     36\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i, model \x1B[38;5;129;01min\x1B[39;00m tqdm(\x1B[38;5;28menumerate\x1B[39m(models), total\x1B[38;5;241m=\x1B[39m\x1B[38;5;28mlen\x1B[39m(models), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mپیش‌بینی\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[0;32m---> 37\x1B[0m     y_pred_proba[:, i] \x1B[38;5;241m=\x1B[39m \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict_proba\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_test\x1B[49m\x1B[43m)\x1B[49m[:, \x1B[38;5;241m1\x1B[39m]\n' +
      '\x1B[1;32m     39\x1B[0m     \x1B[38;5;66;03m# 👇 درصد پیشرفت دستی (اختیاری)\x1B[39;00m\n' +
      '\x1B[1;32m     40\x1B[0m     progress \x1B[38;5;241m=\x1B[39m (i \x1B[38;5;241m+\x1B[39m \x1B[38;5;241m1\x1B[39m) \x1B[38;5;241m/\x1B[39m \x1B[38;5;28mlen\x1B[39m(models) \x1B[38;5;241m*\x1B[39m \x1B[38;5;241m100\x1B[39m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/lightgbm/sklearn.py:1627\x1B[0m, in \x1B[0;36mLGBMClassifier.predict_proba\x1B[0;34m(self, X, raw_score, start_iteration, num_iteration, pred_leaf, pred_contrib, validate_features, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1615\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mpredict_proba\x1B[39m(\n' +
      '\x1B[1;32m   1616\x1B[0m     \x1B[38;5;28mself\x1B[39m,\n' +
      '\x1B[1;32m   1617\x1B[0m     X: _LGBM_ScikitMatrixLike,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1624\x1B[0m     \x1B[38;5;241m*\x1B[39m\x1B[38;5;241m*\x1B[39mkwargs: Any,\n' +
      '\x1B[1;32m   1625\x1B[0m ):\n' +
      '\x1B[1;32m   1626\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""Docstring is set after definition, using a template."""\x1B[39;00m\n' +
      '\x1B[0;32m-> 1627\x1B[0m     result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43msuper\x1B[39;49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1628\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1629\x1B[0m \x1B[43m        \x1B[49m\x1B[43mraw_score\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mraw_score\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1630\x1B[0m \x1B[43m        \x1B[49m\x1B[43mstart_iteration\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mstart_iteration\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1631\x1B[0m \x1B[43m        \x1B[49m\x1B[43mnum_iteration\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mnum_iteration\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1632\x1B[0m \x1B[43m        \x1B[49m\x1B[43mpred_leaf\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mpred_leaf\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1633\x1B[0m \x1B[43m        \x1B[49m\x1B[43mpred_contrib\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mpred_contrib\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1634\x1B[0m \x1B[43m        \x1B[49m\x1B[43mvalidate_features\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mvalidate_features\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1635\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1636\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1637\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mcallable\x1B[39m(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_objective) \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m (raw_score \x1B[38;5;129;01mor\x1B[39;00m pred_leaf \x1B[38;5;129;01mor\x1B[39;00m pred_contrib):\n' +
      '\x1B[1;32m   1638\x1B[0m         _log_warning(\n' +
      '\x1B[1;32m   1639\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCannot compute class probabilities or labels \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1640\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mdue to the usage of customized objective function.\x1B[39m\x1B[38;5;130;01m\\n\x1B[39;00m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1641\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mReturning raw scores instead.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1642\x1B[0m         )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/lightgbm/sklearn.py:1108\x1B[0m, in \x1B[0;36mLGBMModel.predict\x1B[0;34m(self, X, raw_score, start_iteration, num_iteration, pred_leaf, pred_contrib, validate_features, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1106\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m LGBMNotFittedError(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mEstimator not fitted, call fit before exploiting the model.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m   1107\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(X, (pd_DataFrame, dt_DataTable)):\n' +
      '\x1B[0;32m-> 1108\x1B[0m     X \x1B[38;5;241m=\x1B[39m \x1B[43m_LGBMValidateData\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1109\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1110\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      "\x1B[1;32m   1111\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# 'y' being omitted = run scikit-learn's check_array() instead of check_X_y()\x1B[39;49;00m\n" +
      '\x1B[1;32m   1112\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m#\x1B[39;49;00m\n' +
      "\x1B[1;32m   1113\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# Prevent scikit-learn from deleting or modifying attributes like 'feature_names_in_' and 'n_features_in_'.\x1B[39;49;00m\n" +
      "\x1B[1;32m   1114\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# These shouldn't be changed at predict() time.\x1B[39;49;00m\n" +
      '\x1B[1;32m   1115\x1B[0m \x1B[43m        \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1116\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# allow any input type (this validation is done further down, in lgb.Dataset())\x1B[39;49;00m\n' +
      '\x1B[1;32m   1117\x1B[0m \x1B[43m        \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mTrue\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1118\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# do not raise an error if Inf of NaN values are found (LightGBM handles these internally)\x1B[39;49;00m\n' +
      '\x1B[1;32m   1119\x1B[0m \x1B[43m        \x1B[49m\x1B[43mensure_all_finite\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1120\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# raise an error on 0-row inputs\x1B[39;49;00m\n' +
      '\x1B[1;32m   1121\x1B[0m \x1B[43m        \x1B[49m\x1B[43mensure_min_samples\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1122\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1123\x1B[0m \x1B[38;5;66;03m# retrieve original params that possibly can be used in both training and prediction\x1B[39;00m\n' +
      '\x1B[1;32m   1124\x1B[0m \x1B[38;5;66;03m# and then overwrite them (considering aliases) with params that were passed directly in prediction\x1B[39;00m\n' +
      '\x1B[1;32m   1125\x1B[0m predict_params \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_process_params(stage\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mpredict\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2965\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2962\x1B[0m     out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2964\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m check_params\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mensure_2d\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[0;32m-> 2965\x1B[0m     \x1B[43m_check_n_features\x1B[49m\x1B[43m(\x1B[49m\x1B[43m_estimator\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mreset\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2967\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m out\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2829\x1B[0m, in \x1B[0;36m_check_n_features\x1B[0;34m(estimator, X, reset)\x1B[0m\n' +
      '\x1B[1;32m   2826\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m\n' +
      '\x1B[1;32m   2828\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_features \x1B[38;5;241m!=\x1B[39m estimator\x1B[38;5;241m.\x1B[39mn_features_in_:\n' +
      '\x1B[0;32m-> 2829\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   2830\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mX has \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mn_features\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features, but \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__class__\x1B[39m\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2831\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mis expecting \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39mn_features_in_\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features as input.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2832\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: X has 100 features, but LGBMClassifier is expecting 107 features as input.'
  ]
}
15:16:16.381 [warn] Cell completed with errors lu [Error]: [Errno 2] No such file or directory: 'YOUR_NEW_DATA.csv'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'FileNotFoundError',
  evalue: "[Errno 2] No such file or directory: 'YOUR_NEW_DATA.csv'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mFileNotFoundError\x1B[0m                         Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[2], line 15\x1B[0m\n' +
      '\x1B[1;32m     12\x1B[0m mlb \x1B[38;5;241m=\x1B[39m joblib\x1B[38;5;241m.\x1B[39mload(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mmodel_output/label_binarizer.pkl\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[38;5;66;03m# ------------------ Load New Data ------------------\x1B[39;00m\n' +
      '\x1B[0;32m---> 15\x1B[0m df_new \x1B[38;5;241m=\x1B[39m \x1B[43mpd\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mread_csv\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mYOUR_NEW_DATA.csv\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m  \x1B[38;5;66;03m# نام فایل جدید\x1B[39;00m\n' +
      '\x1B[1;32m     16\x1B[0m df_new\x1B[38;5;241m.\x1B[39mcolumns \x1B[38;5;241m=\x1B[39m df_new\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mstr\x1B[38;5;241m.\x1B[39mstrip()\n' +
      '\x1B[1;32m     18\x1B[0m \x1B[38;5;66;03m# ------------------ Build Features ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     19\x1B[0m \x1B[38;5;66;03m# فرض: هر نمونه یک یا چند MasterTestCode دارد، گروه‌بندی روی SampleName\x1B[39;00m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1026\x1B[0m, in \x1B[0;36mread_csv\x1B[0;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\x1B[0m\n' +
      '\x1B[1;32m   1013\x1B[0m kwds_defaults \x1B[38;5;241m=\x1B[39m _refine_defaults_read(\n' +
      '\x1B[1;32m   1014\x1B[0m     dialect,\n' +
      '\x1B[1;32m   1015\x1B[0m     delimiter,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1022\x1B[0m     dtype_backend\x1B[38;5;241m=\x1B[39mdtype_backend,\n' +
      '\x1B[1;32m   1023\x1B[0m )\n' +
      '\x1B[1;32m   1024\x1B[0m kwds\x1B[38;5;241m.\x1B[39mupdate(kwds_defaults)\n' +
      '\x1B[0;32m-> 1026\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43m_read\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:620\x1B[0m, in \x1B[0;36m_read\x1B[0;34m(filepath_or_buffer, kwds)\x1B[0m\n' +
      '\x1B[1;32m    617\x1B[0m _validate_names(kwds\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mnames\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mNone\x1B[39;00m))\n' +
      '\x1B[1;32m    619\x1B[0m \x1B[38;5;66;03m# Create the parser.\x1B[39;00m\n' +
      '\x1B[0;32m--> 620\x1B[0m parser \x1B[38;5;241m=\x1B[39m \x1B[43mTextFileReader\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    622\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m chunksize \x1B[38;5;129;01mor\x1B[39;00m iterator:\n' +
      '\x1B[1;32m    623\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m parser\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1620\x1B[0m, in \x1B[0;36mTextFileReader.__init__\x1B[0;34m(self, f, engine, **kwds)\x1B[0m\n' +
      '\x1B[1;32m   1617\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39moptions[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m] \x1B[38;5;241m=\x1B[39m kwds[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m   1619\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles: IOHandles \x1B[38;5;241m|\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[0;32m-> 1620\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_engine \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_make_engine\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mengine\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1880\x1B[0m, in \x1B[0;36mTextFileReader._make_engine\x1B[0;34m(self, f, engine)\x1B[0m\n' +
      '\x1B[1;32m   1878\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m mode:\n' +
      '\x1B[1;32m   1879\x1B[0m         mode \x1B[38;5;241m+\x1B[39m\x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m-> 1880\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;241m=\x1B[39m \x1B[43mget_handle\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1881\x1B[0m \x1B[43m    \x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1882\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[43m    \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[43m    \x1B[49m\x1B[43mcompression\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcompression\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1885\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmemory_map\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmemory_map\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m \x1B[43m    \x1B[49m\x1B[43mis_text\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mis_text\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1887\x1B[0m \x1B[43m    \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding_errors\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstrict\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1888\x1B[0m \x1B[43m    \x1B[49m\x1B[43mstorage_options\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstorage_options\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1889\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1890\x1B[0m \x1B[38;5;28;01massert\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[1;32m   1891\x1B[0m f \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles\x1B[38;5;241m.\x1B[39mhandle\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/common.py:873\x1B[0m, in \x1B[0;36mget_handle\x1B[0;34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\x1B[0m\n' +
      '\x1B[1;32m    868\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(handle, \x1B[38;5;28mstr\x1B[39m):\n' +
      '\x1B[1;32m    869\x1B[0m     \x1B[38;5;66;03m# Check whether the filename is to be opened in binary mode.\x1B[39;00m\n' +
      "\x1B[1;32m    870\x1B[0m     \x1B[38;5;66;03m# Binary mode does not support 'encoding' and 'newline'.\x1B[39;00m\n" +
      '\x1B[1;32m    871\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mencoding \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mmode:\n' +
      '\x1B[1;32m    872\x1B[0m         \x1B[38;5;66;03m# Encoding\x1B[39;00m\n' +
      '\x1B[0;32m--> 873\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mopen\x1B[39;49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    874\x1B[0m \x1B[43m            \x1B[49m\x1B[43mhandle\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    875\x1B[0m \x1B[43m            \x1B[49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    876\x1B[0m \x1B[43m            \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mencoding\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    877\x1B[0m \x1B[43m            \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43merrors\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    878\x1B[0m \x1B[43m            \x1B[49m\x1B[43mnewline\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    879\x1B[0m \x1B[43m        \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    880\x1B[0m     \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    881\x1B[0m         \x1B[38;5;66;03m# Binary mode\x1B[39;00m\n' +
      '\x1B[1;32m    882\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mopen\x1B[39m(handle, ioargs\x1B[38;5;241m.\x1B[39mmode)\n',
    "\x1B[0;31mFileNotFoundError\x1B[0m: [Errno 2] No such file or directory: 'YOUR_NEW_DATA.csv'"
  ]
}
15:19:24.137 [warn] Cell completed with errors lu [Error]: X has 100 features, but LGBMClassifier is expecting 107 features as input.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'X has 100 features, but LGBMClassifier is expecting 107 features as input.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[4], line 32\x1B[0m\n' +
      '\x1B[1;32m     29\x1B[0m y_pred_proba \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mzeros((X_new\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m0\x1B[39m], \x1B[38;5;28mlen\x1B[39m(models)))\n' +
      '\x1B[1;32m     31\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i, model \x1B[38;5;129;01min\x1B[39;00m tqdm(\x1B[38;5;28menumerate\x1B[39m(models), total\x1B[38;5;241m=\x1B[39m\x1B[38;5;28mlen\x1B[39m(models), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mپیش‌بینی\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[0;32m---> 32\x1B[0m     y_pred_proba[:, i] \x1B[38;5;241m=\x1B[39m \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict_proba\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_new\x1B[49m\x1B[43m)\x1B[49m[:, \x1B[38;5;241m1\x1B[39m]\n' +
      '\x1B[1;32m     34\x1B[0m \x1B[38;5;66;03m# ------------------ خروجی قابل خواندن ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     35\x1B[0m threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;241m0.5\x1B[39m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/lightgbm/sklearn.py:1627\x1B[0m, in \x1B[0;36mLGBMClassifier.predict_proba\x1B[0;34m(self, X, raw_score, start_iteration, num_iteration, pred_leaf, pred_contrib, validate_features, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1615\x1B[0m \x1B[38;5;28;01mdef\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21mpredict_proba\x1B[39m(\n' +
      '\x1B[1;32m   1616\x1B[0m     \x1B[38;5;28mself\x1B[39m,\n' +
      '\x1B[1;32m   1617\x1B[0m     X: _LGBM_ScikitMatrixLike,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1624\x1B[0m     \x1B[38;5;241m*\x1B[39m\x1B[38;5;241m*\x1B[39mkwargs: Any,\n' +
      '\x1B[1;32m   1625\x1B[0m ):\n' +
      '\x1B[1;32m   1626\x1B[0m \x1B[38;5;250m    \x1B[39m\x1B[38;5;124;03m"""Docstring is set after definition, using a template."""\x1B[39;00m\n' +
      '\x1B[0;32m-> 1627\x1B[0m     result \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43msuper\x1B[39;49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mpredict\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1628\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1629\x1B[0m \x1B[43m        \x1B[49m\x1B[43mraw_score\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mraw_score\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1630\x1B[0m \x1B[43m        \x1B[49m\x1B[43mstart_iteration\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mstart_iteration\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1631\x1B[0m \x1B[43m        \x1B[49m\x1B[43mnum_iteration\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mnum_iteration\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1632\x1B[0m \x1B[43m        \x1B[49m\x1B[43mpred_leaf\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mpred_leaf\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1633\x1B[0m \x1B[43m        \x1B[49m\x1B[43mpred_contrib\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mpred_contrib\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1634\x1B[0m \x1B[43m        \x1B[49m\x1B[43mvalidate_features\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mvalidate_features\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1635\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1636\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1637\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mcallable\x1B[39m(\x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_objective) \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m (raw_score \x1B[38;5;129;01mor\x1B[39;00m pred_leaf \x1B[38;5;129;01mor\x1B[39;00m pred_contrib):\n' +
      '\x1B[1;32m   1638\x1B[0m         _log_warning(\n' +
      '\x1B[1;32m   1639\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mCannot compute class probabilities or labels \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1640\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mdue to the usage of customized objective function.\x1B[39m\x1B[38;5;130;01m\\n\x1B[39;00m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1641\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mReturning raw scores instead.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1642\x1B[0m         )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/lightgbm/sklearn.py:1108\x1B[0m, in \x1B[0;36mLGBMModel.predict\x1B[0;34m(self, X, raw_score, start_iteration, num_iteration, pred_leaf, pred_contrib, validate_features, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m   1106\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m LGBMNotFittedError(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mEstimator not fitted, call fit before exploiting the model.\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m   1107\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(X, (pd_DataFrame, dt_DataTable)):\n' +
      '\x1B[0;32m-> 1108\x1B[0m     X \x1B[38;5;241m=\x1B[39m \x1B[43m_LGBMValidateData\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1109\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1110\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      "\x1B[1;32m   1111\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# 'y' being omitted = run scikit-learn's check_array() instead of check_X_y()\x1B[39;49;00m\n" +
      '\x1B[1;32m   1112\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m#\x1B[39;49;00m\n' +
      "\x1B[1;32m   1113\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# Prevent scikit-learn from deleting or modifying attributes like 'feature_names_in_' and 'n_features_in_'.\x1B[39;49;00m\n" +
      "\x1B[1;32m   1114\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# These shouldn't be changed at predict() time.\x1B[39;49;00m\n" +
      '\x1B[1;32m   1115\x1B[0m \x1B[43m        \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1116\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# allow any input type (this validation is done further down, in lgb.Dataset())\x1B[39;49;00m\n' +
      '\x1B[1;32m   1117\x1B[0m \x1B[43m        \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mTrue\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1118\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# do not raise an error if Inf of NaN values are found (LightGBM handles these internally)\x1B[39;49;00m\n' +
      '\x1B[1;32m   1119\x1B[0m \x1B[43m        \x1B[49m\x1B[43mensure_all_finite\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1120\x1B[0m \x1B[43m        \x1B[49m\x1B[38;5;66;43;03m# raise an error on 0-row inputs\x1B[39;49;00m\n' +
      '\x1B[1;32m   1121\x1B[0m \x1B[43m        \x1B[49m\x1B[43mensure_min_samples\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1122\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1123\x1B[0m \x1B[38;5;66;03m# retrieve original params that possibly can be used in both training and prediction\x1B[39;00m\n' +
      '\x1B[1;32m   1124\x1B[0m \x1B[38;5;66;03m# and then overwrite them (considering aliases) with params that were passed directly in prediction\x1B[39;00m\n' +
      '\x1B[1;32m   1125\x1B[0m predict_params \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_process_params(stage\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mpredict\x1B[39m\x1B[38;5;124m"\x1B[39m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2965\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2962\x1B[0m     out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2964\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m check_params\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mensure_2d\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mTrue\x1B[39;00m):\n' +
      '\x1B[0;32m-> 2965\x1B[0m     \x1B[43m_check_n_features\x1B[49m\x1B[43m(\x1B[49m\x1B[43m_estimator\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mreset\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2967\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m out\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2829\x1B[0m, in \x1B[0;36m_check_n_features\x1B[0;34m(estimator, X, reset)\x1B[0m\n' +
      '\x1B[1;32m   2826\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m\n' +
      '\x1B[1;32m   2828\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_features \x1B[38;5;241m!=\x1B[39m estimator\x1B[38;5;241m.\x1B[39mn_features_in_:\n' +
      '\x1B[0;32m-> 2829\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   2830\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mX has \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mn_features\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features, but \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__class__\x1B[39m\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__name__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m \x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2831\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mis expecting \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mestimator\x1B[38;5;241m.\x1B[39mn_features_in_\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m features as input.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   2832\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: X has 100 features, but LGBMClassifier is expecting 107 features as input.'
  ]
}
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:33:45.116 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
15:45:05.566 [warn] Cell completed with errors lu [Error]: Found array with 0 sample(s) (shape=(0, 100)) while a minimum of 1 is required by TfidfTransformer.
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'Found array with 0 sample(s) (shape=(0, 100)) while a minimum of 1 is required by TfidfTransformer.',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[9], line 39\x1B[0m\n' +
      '\x1B[1;32m     36\x1B[0m df_grouped \x1B[38;5;241m=\x1B[39m df_grouped\x1B[38;5;241m.\x1B[39mloc[sample_names]\n' +
      '\x1B[1;32m     38\x1B[0m \x1B[38;5;66;03m# ------------------ ساخت فیچر نهایی ------------------\x1B[39;00m\n' +
      '\x1B[0;32m---> 39\x1B[0m X_text \x1B[38;5;241m=\x1B[39m \x1B[43mvectorizer\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mtransform\x1B[49m\x1B[43m(\x1B[49m\x1B[43mdf_grouped\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mindex\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mastype\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mstr\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     40\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m df_grouped[[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mStrongDepCount\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     41\x1B[0m                         \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_mean\x1B[39m\x1B[38;5;124m"\x1B[39m]]\x1B[38;5;241m.\x1B[39mfillna(\x1B[38;5;241m0\x1B[39m)\x1B[38;5;241m.\x1B[39mvalues\n' +
      '\x1B[1;32m     42\x1B[0m X_numeric_sparse \x1B[38;5;241m=\x1B[39m csr_matrix(X_numeric)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/feature_extraction/text.py:2129\x1B[0m, in \x1B[0;36mTfidfVectorizer.transform\x1B[0;34m(self, raw_documents)\x1B[0m\n' +
      '\x1B[1;32m   2126\x1B[0m check_is_fitted(\x1B[38;5;28mself\x1B[39m, msg\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mThe TF-IDF vectorizer is not fitted\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m   2128\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[38;5;28msuper\x1B[39m()\x1B[38;5;241m.\x1B[39mtransform(raw_documents)\n' +
      '\x1B[0;32m-> 2129\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_tfidf\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mtransform\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mcopy\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/feature_extraction/text.py:1700\x1B[0m, in \x1B[0;36mTfidfTransformer.transform\x1B[0;34m(self, X, copy)\x1B[0m\n' +
      '\x1B[1;32m   1683\x1B[0m \x1B[38;5;250m\x1B[39m\x1B[38;5;124;03m"""Transform a count matrix to a tf or tf-idf representation.\x1B[39;00m\n' +
      '\x1B[1;32m   1684\x1B[0m \n' +
      '\x1B[1;32m   1685\x1B[0m \x1B[38;5;124;03mParameters\x1B[39;00m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1697\x1B[0m \x1B[38;5;124;03m    Tf-idf-weighted document-term matrix.\x1B[39;00m\n' +
      '\x1B[1;32m   1698\x1B[0m \x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m   1699\x1B[0m check_is_fitted(\x1B[38;5;28mself\x1B[39m)\n' +
      '\x1B[0;32m-> 1700\x1B[0m X \x1B[38;5;241m=\x1B[39m \x1B[43mvalidate_data\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1701\x1B[0m \x1B[43m    \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1702\x1B[0m \x1B[43m    \x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1703\x1B[0m \x1B[43m    \x1B[49m\x1B[43maccept_sparse\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcsr\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1704\x1B[0m \x1B[43m    \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43m[\x1B[49m\x1B[43mnp\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mfloat64\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mnp\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mfloat32\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1705\x1B[0m \x1B[43m    \x1B[49m\x1B[43mcopy\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mcopy\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1706\x1B[0m \x1B[43m    \x1B[49m\x1B[43mreset\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1707\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1708\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m sp\x1B[38;5;241m.\x1B[39missparse(X):\n' +
      '\x1B[1;32m   1709\x1B[0m     X \x1B[38;5;241m=\x1B[39m sp\x1B[38;5;241m.\x1B[39mcsr_matrix(X, dtype\x1B[38;5;241m=\x1B[39mX\x1B[38;5;241m.\x1B[39mdtype)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:2944\x1B[0m, in \x1B[0;36mvalidate_data\x1B[0;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)\x1B[0m\n' +
      '\x1B[1;32m   2942\x1B[0m         out \x1B[38;5;241m=\x1B[39m X, y\n' +
      '\x1B[1;32m   2943\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m no_val_y:\n' +
      '\x1B[0;32m-> 2944\x1B[0m     out \x1B[38;5;241m=\x1B[39m \x1B[43mcheck_array\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43minput_name\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mX\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mcheck_params\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2945\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m no_val_X \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m no_val_y:\n' +
      '\x1B[1;32m   2946\x1B[0m     out \x1B[38;5;241m=\x1B[39m _check_y(y, \x1B[38;5;241m*\x1B[39m\x1B[38;5;241m*\x1B[39mcheck_params)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:1130\x1B[0m, in \x1B[0;36mcheck_array\x1B[0;34m(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_writeable, force_all_finite, ensure_all_finite, ensure_non_negative, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)\x1B[0m\n' +
      '\x1B[1;32m   1128\x1B[0m     n_samples \x1B[38;5;241m=\x1B[39m _num_samples(array)\n' +
      '\x1B[1;32m   1129\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m n_samples \x1B[38;5;241m<\x1B[39m ensure_min_samples:\n' +
      '\x1B[0;32m-> 1130\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m   1131\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFound array with \x1B[39m\x1B[38;5;132;01m%d\x1B[39;00m\x1B[38;5;124m sample(s) (shape=\x1B[39m\x1B[38;5;132;01m%s\x1B[39;00m\x1B[38;5;124m) while a\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1132\x1B[0m             \x1B[38;5;124m"\x1B[39m\x1B[38;5;124m minimum of \x1B[39m\x1B[38;5;132;01m%d\x1B[39;00m\x1B[38;5;124m is required\x1B[39m\x1B[38;5;132;01m%s\x1B[39;00m\x1B[38;5;124m.\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m   1133\x1B[0m             \x1B[38;5;241m%\x1B[39m (n_samples, array\x1B[38;5;241m.\x1B[39mshape, ensure_min_samples, context)\n' +
      '\x1B[1;32m   1134\x1B[0m         )\n' +
      '\x1B[1;32m   1136\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m ensure_min_features \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m0\x1B[39m \x1B[38;5;129;01mand\x1B[39;00m array\x1B[38;5;241m.\x1B[39mndim \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m2\x1B[39m:\n' +
      '\x1B[1;32m   1137\x1B[0m     n_features \x1B[38;5;241m=\x1B[39m array\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m1\x1B[39m]\n',
    '\x1B[0;31mValueError\x1B[0m: Found array with 0 sample(s) (shape=(0, 100)) while a minimum of 1 is required by TfidfTransformer.'
  ]
}
16:08:16.912 [info] Interrupt kernel execution
16:08:16.913 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
16:08:16.914 [info] Interrupt kernel execution
16:08:16.915 [info] Interrupting kernel: new_rasfai
16:08:16.916 [info] Interrupting kernel via SIGINT
16:08:18.338 [warn] Cell completed with errors (cancelled)
16:08:18.350 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
16:12:08.597 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for 'Untitled-1.ipynb' (disableUI=false)
16:12:08.931 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:12:08.986 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
16:12:09.217 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v39126e17481da7d2611cfe1526944e4fafe1a0d2e.json
    > cwd: /mnt/data/rasfai
16:12:10.894 [info] Kernel successfully started
16:12:10.895 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
16:12:11.777 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
16:12:14.342 [warn] Cell completed with errors lu [Error]: name 'y_true' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_true' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 10\x1B[0m\n' +
      '\x1B[1;32m      7\x1B[0m mlb \x1B[38;5;241m=\x1B[39m joblib\x1B[38;5;241m.\x1B[39mload(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mmodel_output/label_binarizer.pkl\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[38;5;66;03m# Calculate per-label metrics\x1B[39;00m\n' +
      '\x1B[0;32m---> 10\x1B[0m precisions \x1B[38;5;241m=\x1B[39m precision_score(\x1B[43my_true\x1B[49m, y_pred_bin, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mNone\x1B[39;00m, zero_division\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n' +
      '\x1B[1;32m     11\x1B[0m recalls \x1B[38;5;241m=\x1B[39m recall_score(y_true, y_pred_bin, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mNone\x1B[39;00m, zero_division\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n' +
      '\x1B[1;32m     12\x1B[0m f1s \x1B[38;5;241m=\x1B[39m f1_score(y_true, y_pred_bin, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mNone\x1B[39;00m, zero_division\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y_true' is not defined"
  ]
}
16:13:31.808 [warn] Cell completed with errors lu [Error]: name 'y_pred_proba' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_pred_proba' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[2], line 16\x1B[0m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[38;5;66;03m# بازسازی y_pred_bin از y_pred_proba\x1B[39;00m\n' +
      '\x1B[1;32m     15\x1B[0m threshold \x1B[38;5;241m=\x1B[39m \x1B[38;5;241m0.7\x1B[39m\n' +
      '\x1B[0;32m---> 16\x1B[0m y_pred_bin \x1B[38;5;241m=\x1B[39m (\x1B[43my_pred_proba\x1B[49m \x1B[38;5;241m>\x1B[39m threshold)\x1B[38;5;241m.\x1B[39mastype(\x1B[38;5;28mint\x1B[39m)\n' +
      '\x1B[1;32m     19\x1B[0m \x1B[38;5;66;03m# Calculate per-label metrics\x1B[39;00m\n' +
      '\x1B[1;32m     20\x1B[0m precisions \x1B[38;5;241m=\x1B[39m precision_score(y_true, y_pred_bin, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mNone\x1B[39;00m, zero_division\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y_pred_proba' is not defined"
  ]
}
16:13:40.993 [info] Disposing kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher for notebook Untitled-1.ipynb due to selection of another kernel or closing of the notebook
16:13:40.994 [info] Dispose Kernel 'Untitled-1.ipynb' associated with 'Untitled-1.ipynb'
16:13:41.106 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
16:13:41.107 [info] Disposing request as the cell (0) was deleted Untitled-1.ipynb
16:30:28.257 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
16:30:28.594 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:30:28.654 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v307e4cde47d6dd752b8cb6e7280cdedcdc5b98ebf.json
    > cwd: /mnt/data/rasfai
16:30:29.499 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
16:51:24.536 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
16:51:24.970 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
16:51:25.038 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v33404e8ccbfd8d12ba5566120ab5d5a0a9cd86009.json
    > cwd: /mnt/data/rasfai
16:51:27.302 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
17:03:11.704 [info] Interrupt kernel execution
17:03:11.707 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
17:03:11.708 [info] Interrupt kernel execution
17:03:11.708 [info] Interrupting kernel: new_rasfai
17:03:11.708 [info] Interrupting kernel via SIGINT
17:03:12.399 [warn] Cell completed with errors (cancelled)
17:03:12.402 [warn] Cancel all remaining cells due to cancellation or failure in execution
17:03:12.404 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
17:03:16.968 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
17:03:17.307 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
17:03:17.367 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v325b8727448ffafbb3f841d072f0b0708d06a1533.json
    > cwd: /mnt/data/rasfai
17:03:18.217 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
17:18:07.226 [warn] Cell completed with errors lu [Error]: 'numpy.ndarray' object has no attribute 'to_numpy'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'AttributeError',
  evalue: "'numpy.ndarray' object has no attribute 'to_numpy'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mAttributeError\x1B[0m                            Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[8], line 16\x1B[0m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[38;5;66;03m# ویژگی‌های عددی از high_dependency_tests با وزن‌دهی زمانی\x1B[39;00m\n' +
      '\x1B[1;32m      9\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m sample_features[[\n' +
      '\x1B[1;32m     10\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     11\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mStrongDepCount_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     12\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_mean\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     13\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mLogTotalCount\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m     14\x1B[0m ]]\x1B[38;5;241m.\x1B[39mfillna(\x1B[38;5;241m0\x1B[39m)\x1B[38;5;241m.\x1B[39mvalues\n' +
      '\x1B[0;32m---> 16\x1B[0m X_all \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mhstack([X_text\x1B[38;5;241m.\x1B[39mtoarray(), \x1B[43mX_numeric\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mto_numpy\x1B[49m()])\n',
    "\x1B[0;31mAttributeError\x1B[0m: 'numpy.ndarray' object has no attribute 'to_numpy'"
  ]
}
18:49:56.741 [info] Interrupt kernel execution
18:49:56.742 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
18:49:56.742 [info] Interrupt kernel execution
18:49:56.742 [info] Interrupting kernel: new_rasfai
18:49:56.743 [info] Interrupting kernel via SIGINT
18:50:02.975 [warn] Cell completed with errors (cancelled)
18:50:02.979 [warn] Cancel all remaining cells due to cancellation or failure in execution
18:50:02.984 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
18:50:05.134 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:05.134 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:05.844 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:08.562 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:08.563 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:09.303 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
18:50:13.943 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:06:47.357 [warn] Cell completed with errors lu [Error]: 'numpy.ndarray' object has no attribute 'to_numpy'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'AttributeError',
  evalue: "'numpy.ndarray' object has no attribute 'to_numpy'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mAttributeError\x1B[0m                            Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[19], line 16\x1B[0m\n' +
      '\x1B[1;32m      8\x1B[0m \x1B[38;5;66;03m# ویژگی‌های عددی از high_dependency_tests با وزن‌دهی زمانی\x1B[39;00m\n' +
      '\x1B[1;32m      9\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m sample_features[[\n' +
      '\x1B[1;32m     10\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     11\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mStrongDepCount_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     12\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_mean\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     13\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mLogTotalCount\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m     14\x1B[0m ]]\x1B[38;5;241m.\x1B[39mfillna(\x1B[38;5;241m0\x1B[39m)\x1B[38;5;241m.\x1B[39mvalues\n' +
      '\x1B[0;32m---> 16\x1B[0m X_all \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mhstack([X_text\x1B[38;5;241m.\x1B[39mtoarray(), \x1B[43mX_numeric\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mto_numpy\x1B[49m()])\n',
    "\x1B[0;31mAttributeError\x1B[0m: 'numpy.ndarray' object has no attribute 'to_numpy'"
  ]
}
19:12:27.756 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:54.042 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:55.214 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:55.215 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:55.215 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:55.215 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:55.215 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:12:56.624 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
19:14:21.007 [info] Interrupt kernel execution
19:14:21.007 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
19:14:21.008 [info] Interrupt kernel execution
19:14:21.008 [info] Interrupting kernel: new_rasfai
19:14:21.009 [info] Interrupting kernel via SIGINT
19:14:22.189 [warn] Cell completed with errors (cancelled)
19:14:22.196 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
19:16:23.256 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
19:16:23.604 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
19:16:23.668 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v313511f9a1904ad6fd67721b88b414d70bc211d8c.json
    > cwd: /mnt/data/rasfai
19:16:24.536 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
19:16:34.278 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
19:16:34.407 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
19:16:34.487 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3ad551cbbe0b6a7b3faf12e7cb66fc771cd876859.json
    > cwd: /mnt/data/rasfai
19:16:35.500 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
19:27:45.005 [info] Interrupt kernel execution
19:27:45.007 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
19:27:45.010 [info] Interrupt kernel execution
19:27:45.011 [info] Interrupting kernel: new_rasfai
19:27:45.011 [info] Interrupting kernel via SIGINT
19:27:45.753 [warn] Cell completed with errors (cancelled)
19:27:45.756 [warn] Cancel all remaining cells due to cancellation or failure in execution
19:27:45.758 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
19:48:09.652 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
20:02:38.812 [warn] Cell completed with errors lu [Error]: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 774451 and the array at index 1 has size 774674
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'all the input array dimensions except for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 774451 and the array at index 1 has size 774674',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[18], line 17\x1B[0m\n' +
      '\x1B[1;32m      9\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m sample_features[[ \n' +
      '\x1B[1;32m     10\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     11\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mStrongDepCount_weighted\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     12\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFeBase_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mDestruct_mean\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mIsLarge_mean\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m     13\x1B[0m     \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mLogTotalCount\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m     14\x1B[0m ]]\x1B[38;5;241m.\x1B[39mfillna(\x1B[38;5;241m0\x1B[39m)\x1B[38;5;241m.\x1B[39mvalues\n' +
      '\x1B[1;32m     16\x1B[0m \x1B[38;5;66;03m# ترکیب ویژگی‌ها\x1B[39;00m\n' +
      '\x1B[0;32m---> 17\x1B[0m X_all \x1B[38;5;241m=\x1B[39m \x1B[43mnp\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mhstack\x1B[49m\x1B[43m(\x1B[49m\x1B[43m[\x1B[49m\x1B[43mX_text\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mtoarray\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mX_numeric\x1B[49m\x1B[43m]\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/numpy/_core/shape_base.py:364\x1B[0m, in \x1B[0;36mhstack\x1B[0;34m(tup, dtype, casting)\x1B[0m\n' +
      '\x1B[1;32m    362\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m _nx\x1B[38;5;241m.\x1B[39mconcatenate(arrs, \x1B[38;5;241m0\x1B[39m, dtype\x1B[38;5;241m=\x1B[39mdtype, casting\x1B[38;5;241m=\x1B[39mcasting)\n' +
      '\x1B[1;32m    363\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[0;32m--> 364\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43m_nx\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mconcatenate\x1B[49m\x1B[43m(\x1B[49m\x1B[43marrs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m1\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mdtype\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mcasting\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mcasting\x1B[49m\x1B[43m)\x1B[49m\n',
    '\x1B[0;31mValueError\x1B[0m: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 774451 and the array at index 1 has size 774674'
  ]
}
20:02:38.817 [warn] Cancel all remaining cells due to cancellation or failure in execution
20:17:47.658 [warn] Cell completed with errors lu [Error]: Found input variables with inconsistent numbers of samples: [774674, 774451]
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'ValueError',
  evalue: 'Found input variables with inconsistent numbers of samples: [774674, 774451]',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mValueError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[21], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# ------------------ تقسیم‌بندی ------------------\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m X_train, X_test, y_train, y_test \x1B[38;5;241m=\x1B[39m \x1B[43mtrain_test_split\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_all\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_all\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mtest_size\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m0.1\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mrandom_state\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m42\x1B[39;49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/_param_validation.py:216\x1B[0m, in \x1B[0;36mvalidate_params.<locals>.decorator.<locals>.wrapper\x1B[0;34m(*args, **kwargs)\x1B[0m\n' +
      '\x1B[1;32m    210\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[1;32m    211\x1B[0m     \x1B[38;5;28;01mwith\x1B[39;00m config_context(\n' +
      '\x1B[1;32m    212\x1B[0m         skip_parameter_validation\x1B[38;5;241m=\x1B[39m(\n' +
      '\x1B[1;32m    213\x1B[0m             prefer_skip_nested_validation \x1B[38;5;129;01mor\x1B[39;00m global_skip_validation\n' +
      '\x1B[1;32m    214\x1B[0m         )\n' +
      '\x1B[1;32m    215\x1B[0m     ):\n' +
      '\x1B[0;32m--> 216\x1B[0m         \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43mfunc\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43margs\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwargs\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    217\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m InvalidParameterError \x1B[38;5;28;01mas\x1B[39;00m e:\n' +
      '\x1B[1;32m    218\x1B[0m     \x1B[38;5;66;03m# When the function is just a wrapper around an estimator, we allow\x1B[39;00m\n' +
      '\x1B[1;32m    219\x1B[0m     \x1B[38;5;66;03m# the function to delegate validation to the estimator, but we replace\x1B[39;00m\n' +
      '\x1B[1;32m    220\x1B[0m     \x1B[38;5;66;03m# the name of the estimator by the name of the function in the error\x1B[39;00m\n' +
      '\x1B[1;32m    221\x1B[0m     \x1B[38;5;66;03m# message to avoid confusion.\x1B[39;00m\n' +
      '\x1B[1;32m    222\x1B[0m     msg \x1B[38;5;241m=\x1B[39m re\x1B[38;5;241m.\x1B[39msub(\n' +
      '\x1B[1;32m    223\x1B[0m         \x1B[38;5;124mr\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mparameter of \x1B[39m\x1B[38;5;124m\\\x1B[39m\x1B[38;5;124mw+ must be\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m    224\x1B[0m         \x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mparameter of \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mfunc\x1B[38;5;241m.\x1B[39m\x1B[38;5;18m__qualname__\x1B[39m\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m must be\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[1;32m    225\x1B[0m         \x1B[38;5;28mstr\x1B[39m(e),\n' +
      '\x1B[1;32m    226\x1B[0m     )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/model_selection/_split.py:2848\x1B[0m, in \x1B[0;36mtrain_test_split\x1B[0;34m(test_size, train_size, random_state, shuffle, stratify, *arrays)\x1B[0m\n' +
      '\x1B[1;32m   2845\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m n_arrays \x1B[38;5;241m==\x1B[39m \x1B[38;5;241m0\x1B[39m:\n' +
      '\x1B[1;32m   2846\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mAt least one array required as input\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m-> 2848\x1B[0m arrays \x1B[38;5;241m=\x1B[39m \x1B[43mindexable\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43marrays\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   2850\x1B[0m n_samples \x1B[38;5;241m=\x1B[39m _num_samples(arrays[\x1B[38;5;241m0\x1B[39m])\n' +
      '\x1B[1;32m   2851\x1B[0m n_train, n_test \x1B[38;5;241m=\x1B[39m _validate_shuffle_split(\n' +
      '\x1B[1;32m   2852\x1B[0m     n_samples, test_size, train_size, default_test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.25\x1B[39m\n' +
      '\x1B[1;32m   2853\x1B[0m )\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:532\x1B[0m, in \x1B[0;36mindexable\x1B[0;34m(*iterables)\x1B[0m\n' +
      '\x1B[1;32m    502\x1B[0m \x1B[38;5;250m\x1B[39m\x1B[38;5;124;03m"""Make arrays indexable for cross-validation.\x1B[39;00m\n' +
      '\x1B[1;32m    503\x1B[0m \n' +
      '\x1B[1;32m    504\x1B[0m \x1B[38;5;124;03mChecks consistent length, passes through None, and ensures that everything\x1B[39;00m\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      "\x1B[1;32m    528\x1B[0m \x1B[38;5;124;03m[[1, 2, 3], array([2, 3, 4]), None, <...Sparse...dtype 'int64'...shape (3, 1)>]\x1B[39;00m\n" +
      '\x1B[1;32m    529\x1B[0m \x1B[38;5;124;03m"""\x1B[39;00m\n' +
      '\x1B[1;32m    531\x1B[0m result \x1B[38;5;241m=\x1B[39m [_make_indexable(X) \x1B[38;5;28;01mfor\x1B[39;00m X \x1B[38;5;129;01min\x1B[39;00m iterables]\n' +
      '\x1B[0;32m--> 532\x1B[0m \x1B[43mcheck_consistent_length\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mresult\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    533\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m result\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/sklearn/utils/validation.py:475\x1B[0m, in \x1B[0;36mcheck_consistent_length\x1B[0;34m(*arrays)\x1B[0m\n' +
      '\x1B[1;32m    473\x1B[0m uniques \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39munique(lengths)\n' +
      '\x1B[1;32m    474\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mlen\x1B[39m(uniques) \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[0;32m--> 475\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\n' +
      '\x1B[1;32m    476\x1B[0m         \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mFound input variables with inconsistent numbers of samples: \x1B[39m\x1B[38;5;132;01m%r\x1B[39;00m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[1;32m    477\x1B[0m         \x1B[38;5;241m%\x1B[39m [\x1B[38;5;28mint\x1B[39m(l) \x1B[38;5;28;01mfor\x1B[39;00m l \x1B[38;5;129;01min\x1B[39;00m lengths]\n' +
      '\x1B[1;32m    478\x1B[0m     )\n',
    '\x1B[0;31mValueError\x1B[0m: Found input variables with inconsistent numbers of samples: [774674, 774451]'
  ]
}
20:21:00.211 [warn] Cell completed with errors lu [Error]: LGBMClassifier.fit() got an unexpected keyword argument 'early_stopping_rounds'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: "LGBMClassifier.fit() got an unexpected keyword argument 'early_stopping_rounds'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[27], line 21\x1B[0m\n' +
      '\x1B[1;32m     12\x1B[0m     X_train, X_val, y_train_i, y_val_i \x1B[38;5;241m=\x1B[39m train_test_split(X_all, y_all[:, i], test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m)\n' +
      '\x1B[1;32m     14\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(\n' +
      '\x1B[1;32m     15\x1B[0m         n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m300\x1B[39m,\n' +
      '\x1B[1;32m     16\x1B[0m         learning_rate\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.05\x1B[39m,\n' +
      '\x1B[1;32m     17\x1B[0m         random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m,\n' +
      '\x1B[1;32m     18\x1B[0m         n_jobs\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m-\x1B[39m\x1B[38;5;241m1\x1B[39m\n' +
      '\x1B[1;32m     19\x1B[0m     )\n' +
      '\x1B[0;32m---> 21\x1B[0m     \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mfit\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m     22\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX_train\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_train_i\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     23\x1B[0m \x1B[43m        \x1B[49m\x1B[43meval_set\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43m[\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_val\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_val_i\x1B[49m\x1B[43m)\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     24\x1B[0m \x1B[43m        \x1B[49m\x1B[43mearly_stopping_rounds\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m20\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     25\x1B[0m \x1B[43m        \x1B[49m\x1B[43mverbose\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\n' +
      '\x1B[1;32m     26\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     27\x1B[0m     models\x1B[38;5;241m.\x1B[39mappend(model)\n' +
      '\x1B[1;32m     29\x1B[0m \x1B[38;5;66;03m# ------------------ Save Artifacts ------------------\x1B[39;00m\n',
    "\x1B[0;31mTypeError\x1B[0m: LGBMClassifier.fit() got an unexpected keyword argument 'early_stopping_rounds'"
  ]
}
20:23:22.929 [warn] Cell completed with errors lu [Error]: name 'early_stopping' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'early_stopping' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[28], line 20\x1B[0m\n' +
      '\x1B[1;32m      5\x1B[0m     X_train, X_val, y_train_i, y_val_i \x1B[38;5;241m=\x1B[39m train_test_split(\n' +
      '\x1B[1;32m      6\x1B[0m         X_all, y_all[:, i], test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m\n' +
      '\x1B[1;32m      7\x1B[0m     )\n' +
      '\x1B[1;32m      9\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(\n' +
      '\x1B[1;32m     10\x1B[0m         n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m300\x1B[39m,\n' +
      '\x1B[1;32m     11\x1B[0m         learning_rate\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.05\x1B[39m,\n' +
      '\x1B[1;32m     12\x1B[0m         random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m,\n' +
      '\x1B[1;32m     13\x1B[0m         n_jobs\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m-\x1B[39m\x1B[38;5;241m1\x1B[39m\n' +
      '\x1B[1;32m     14\x1B[0m     )\n' +
      '\x1B[1;32m     16\x1B[0m     model\x1B[38;5;241m.\x1B[39mfit(\n' +
      '\x1B[1;32m     17\x1B[0m         X_train, y_train_i,\n' +
      '\x1B[1;32m     18\x1B[0m         eval_set\x1B[38;5;241m=\x1B[39m[(X_val, y_val_i)],\n' +
      '\x1B[1;32m     19\x1B[0m         eval_metric\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mbinary_logloss\x1B[39m\x1B[38;5;124m"\x1B[39m,\n' +
      '\x1B[0;32m---> 20\x1B[0m         callbacks\x1B[38;5;241m=\x1B[39m[\x1B[43mearly_stopping\x1B[49m(stopping_rounds\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m20\x1B[39m)],\n' +
      '\x1B[1;32m     21\x1B[0m         verbose\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mFalse\x1B[39;00m\n' +
      '\x1B[1;32m     22\x1B[0m     )\n' +
      '\x1B[1;32m     24\x1B[0m     models\x1B[38;5;241m.\x1B[39mappend(model)\n' +
      '\x1B[1;32m     26\x1B[0m \x1B[38;5;66;03m# ------------------ ذخیره مدل‌ها و ابزارها ------------------\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'early_stopping' is not defined"
  ]
}
20:23:53.284 [warn] Cell completed with errors lu [Error]: LGBMClassifier.fit() got an unexpected keyword argument 'verbose'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'TypeError',
  evalue: "LGBMClassifier.fit() got an unexpected keyword argument 'verbose'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mTypeError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[30], line 16\x1B[0m\n' +
      '\x1B[1;32m      5\x1B[0m     X_train, X_val, y_train_i, y_val_i \x1B[38;5;241m=\x1B[39m train_test_split(\n' +
      '\x1B[1;32m      6\x1B[0m         X_all, y_all[:, i], test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m\n' +
      '\x1B[1;32m      7\x1B[0m     )\n' +
      '\x1B[1;32m      9\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(\n' +
      '\x1B[1;32m     10\x1B[0m         n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m300\x1B[39m,\n' +
      '\x1B[1;32m     11\x1B[0m         learning_rate\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.05\x1B[39m,\n' +
      '\x1B[1;32m     12\x1B[0m         random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m,\n' +
      '\x1B[1;32m     13\x1B[0m         n_jobs\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m-\x1B[39m\x1B[38;5;241m1\x1B[39m\n' +
      '\x1B[1;32m     14\x1B[0m     )\n' +
      '\x1B[0;32m---> 16\x1B[0m     \x1B[43mmodel\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mfit\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m     17\x1B[0m \x1B[43m        \x1B[49m\x1B[43mX_train\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_train_i\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     18\x1B[0m \x1B[43m        \x1B[49m\x1B[43meval_set\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43m[\x1B[49m\x1B[43m(\x1B[49m\x1B[43mX_val\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43my_val_i\x1B[49m\x1B[43m)\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     19\x1B[0m \x1B[43m        \x1B[49m\x1B[43meval_metric\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mbinary_logloss\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     20\x1B[0m \x1B[43m        \x1B[49m\x1B[43mcallbacks\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43m[\x1B[49m\x1B[43mearly_stopping\x1B[49m\x1B[43m(\x1B[49m\x1B[43mstopping_rounds\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;241;43m20\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m]\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m     21\x1B[0m \x1B[43m        \x1B[49m\x1B[43mverbose\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\n' +
      '\x1B[1;32m     22\x1B[0m \x1B[43m    \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     24\x1B[0m     models\x1B[38;5;241m.\x1B[39mappend(model)\n' +
      '\x1B[1;32m     26\x1B[0m \x1B[38;5;66;03m# ------------------ ذخیره مدل‌ها و ابزارها ------------------\x1B[39;00m\n',
    "\x1B[0;31mTypeError\x1B[0m: LGBMClassifier.fit() got an unexpected keyword argument 'verbose'"
  ]
}
20:25:25.270 [info] Interrupt kernel execution
20:25:25.271 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
20:25:25.272 [info] Interrupt kernel execution
20:25:25.274 [info] Interrupting kernel: new_rasfai
20:25:25.274 [info] Interrupting kernel via SIGINT
20:25:27.677 [warn] Cell completed with errors (cancelled)
20:25:27.682 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
20:26:39.628 [info] Interrupt kernel execution
20:26:39.628 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
20:26:39.628 [info] Interrupt kernel execution
20:26:39.628 [info] Interrupting kernel: new_rasfai
20:26:39.629 [info] Interrupting kernel via SIGINT
20:26:40.620 [warn] Cell completed with errors (cancelled)
20:26:40.625 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
20:26:43.328 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
20:26:43.688 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
20:26:43.748 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v344b2d6c8db2db6e551b45699c92499e42abc3e61.json
    > cwd: /mnt/data/rasfai
20:26:44.714 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
04:21:40.998 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Untitled-1.ipynb' (disableUI=false)
04:21:41.367 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
04:21:41.452 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
04:21:41.532 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3b7ff9431c76f4cf864be303a1ae5897adf1c4653.json
    > cwd: /mnt/data/rasfai
04:21:42.642 [info] Kernel successfully started
04:21:42.643 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
04:21:43.732 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
04:22:26.853 [info] Disposing request as the cell (0) was deleted /mnt/data/rasfai/Untitled-1.ipynb
04:22:26.855 [info] Disposing request as the cell (1) was deleted /mnt/data/rasfai/Untitled-1.ipynb
04:22:26.876 [info] Dispose Kernel '/mnt/data/rasfai/Untitled-1.ipynb' associated with '/mnt/data/rasfai/Untitled-1.ipynb'
04:22:36.790 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
04:22:52.259 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' (disableUI=true)
04:22:52.369 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
04:22:52.553 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3a5187295b33ff8003fad893a9fc0680255258d67.json
    > cwd: /mnt/data/rasfai
04:22:53.913 [info] Kernel successfully started
04:22:53.915 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
04:22:54.557 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
04:22:58.310 [info] Dispose Kernel '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb' associated with '/mnt/data/rasfai/Recipt_Ai_Revised.ipynb'
04:26:59.709 [info] Interrupt kernel execution
04:26:59.709 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
04:26:59.710 [info] Interrupt kernel execution
04:26:59.710 [info] Interrupting kernel: new_rasfai
04:26:59.711 [info] Interrupting kernel via SIGINT
04:27:00.665 [warn] Cell completed with errors (cancelled)
04:27:00.672 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
04:27:32.702 [warn] Cell completed with errors lu [Error]: [Errno 2] No such file or directory: 'NewModel.csv'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'FileNotFoundError',
  evalue: "[Errno 2] No such file or directory: 'NewModel.csv'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mFileNotFoundError\x1B[0m                         Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[13], line 14\x1B[0m\n' +
      '\x1B[1;32m     11\x1B[0m mlb \x1B[38;5;241m=\x1B[39m joblib\x1B[38;5;241m.\x1B[39mload(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mmodel_output_new/label_binarizer.pkl\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m     13\x1B[0m \x1B[38;5;66;03m# ------------------ بارگذاری داده‌ها ------------------\x1B[39;00m\n' +
      '\x1B[0;32m---> 14\x1B[0m df \x1B[38;5;241m=\x1B[39m \x1B[43mpd\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mread_csv\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mNewModel.csv\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m     16\x1B[0m \x1B[38;5;66;03m# فقط ۱۰٪ به صورت تصادفی\x1B[39;00m\n' +
      '\x1B[1;32m     17\x1B[0m df \x1B[38;5;241m=\x1B[39m df\x1B[38;5;241m.\x1B[39msample(frac\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.1\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m)\x1B[38;5;241m.\x1B[39mreset_index(drop\x1B[38;5;241m=\x1B[39m\x1B[38;5;28;01mTrue\x1B[39;00m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1026\x1B[0m, in \x1B[0;36mread_csv\x1B[0;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\x1B[0m\n' +
      '\x1B[1;32m   1013\x1B[0m kwds_defaults \x1B[38;5;241m=\x1B[39m _refine_defaults_read(\n' +
      '\x1B[1;32m   1014\x1B[0m     dialect,\n' +
      '\x1B[1;32m   1015\x1B[0m     delimiter,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m   1022\x1B[0m     dtype_backend\x1B[38;5;241m=\x1B[39mdtype_backend,\n' +
      '\x1B[1;32m   1023\x1B[0m )\n' +
      '\x1B[1;32m   1024\x1B[0m kwds\x1B[38;5;241m.\x1B[39mupdate(kwds_defaults)\n' +
      '\x1B[0;32m-> 1026\x1B[0m \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43m_read\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:620\x1B[0m, in \x1B[0;36m_read\x1B[0;34m(filepath_or_buffer, kwds)\x1B[0m\n' +
      '\x1B[1;32m    617\x1B[0m _validate_names(kwds\x1B[38;5;241m.\x1B[39mget(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mnames\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;28;01mNone\x1B[39;00m))\n' +
      '\x1B[1;32m    619\x1B[0m \x1B[38;5;66;03m# Create the parser.\x1B[39;00m\n' +
      '\x1B[0;32m--> 620\x1B[0m parser \x1B[38;5;241m=\x1B[39m \x1B[43mTextFileReader\x1B[49m\x1B[43m(\x1B[49m\x1B[43mfilepath_or_buffer\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[38;5;241;43m*\x1B[39;49m\x1B[43mkwds\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    622\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m chunksize \x1B[38;5;129;01mor\x1B[39;00m iterator:\n' +
      '\x1B[1;32m    623\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m parser\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1620\x1B[0m, in \x1B[0;36mTextFileReader.__init__\x1B[0;34m(self, f, engine, **kwds)\x1B[0m\n' +
      '\x1B[1;32m   1617\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39moptions[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m] \x1B[38;5;241m=\x1B[39m kwds[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mhas_index_names\x1B[39m\x1B[38;5;124m"\x1B[39m]\n' +
      '\x1B[1;32m   1619\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles: IOHandles \x1B[38;5;241m|\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[0;32m-> 1620\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_engine \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_make_engine\x1B[49m\x1B[43m(\x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mengine\x1B[49m\x1B[43m)\x1B[49m\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/parsers/readers.py:1880\x1B[0m, in \x1B[0;36mTextFileReader._make_engine\x1B[0;34m(self, f, engine)\x1B[0m\n' +
      '\x1B[1;32m   1878\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m mode:\n' +
      '\x1B[1;32m   1879\x1B[0m         mode \x1B[38;5;241m+\x1B[39m\x1B[38;5;241m=\x1B[39m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m\n' +
      '\x1B[0;32m-> 1880\x1B[0m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;241m=\x1B[39m \x1B[43mget_handle\x1B[49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m   1881\x1B[0m \x1B[43m    \x1B[49m\x1B[43mf\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1882\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1883\x1B[0m \x1B[43m    \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1884\x1B[0m \x1B[43m    \x1B[49m\x1B[43mcompression\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mcompression\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1885\x1B[0m \x1B[43m    \x1B[49m\x1B[43mmemory_map\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mmemory_map\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mFalse\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1886\x1B[0m \x1B[43m    \x1B[49m\x1B[43mis_text\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mis_text\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1887\x1B[0m \x1B[43m    \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mencoding_errors\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstrict\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1888\x1B[0m \x1B[43m    \x1B[49m\x1B[43mstorage_options\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43moptions\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mstorage_options\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[38;5;28;43;01mNone\x1B[39;49;00m\x1B[43m)\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m   1889\x1B[0m \x1B[43m\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1890\x1B[0m \x1B[38;5;28;01massert\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m\n' +
      '\x1B[1;32m   1891\x1B[0m f \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mhandles\x1B[38;5;241m.\x1B[39mhandle\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/io/common.py:873\x1B[0m, in \x1B[0;36mget_handle\x1B[0;34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\x1B[0m\n' +
      '\x1B[1;32m    868\x1B[0m \x1B[38;5;28;01melif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(handle, \x1B[38;5;28mstr\x1B[39m):\n' +
      '\x1B[1;32m    869\x1B[0m     \x1B[38;5;66;03m# Check whether the filename is to be opened in binary mode.\x1B[39;00m\n' +
      "\x1B[1;32m    870\x1B[0m     \x1B[38;5;66;03m# Binary mode does not support 'encoding' and 'newline'.\x1B[39;00m\n" +
      '\x1B[1;32m    871\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mencoding \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mb\x1B[39m\x1B[38;5;124m"\x1B[39m \x1B[38;5;129;01mnot\x1B[39;00m \x1B[38;5;129;01min\x1B[39;00m ioargs\x1B[38;5;241m.\x1B[39mmode:\n' +
      '\x1B[1;32m    872\x1B[0m         \x1B[38;5;66;03m# Encoding\x1B[39;00m\n' +
      '\x1B[0;32m--> 873\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mopen\x1B[39;49m\x1B[43m(\x1B[49m\n' +
      '\x1B[1;32m    874\x1B[0m \x1B[43m            \x1B[49m\x1B[43mhandle\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    875\x1B[0m \x1B[43m            \x1B[49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mmode\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    876\x1B[0m \x1B[43m            \x1B[49m\x1B[43mencoding\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43mioargs\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mencoding\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    877\x1B[0m \x1B[43m            \x1B[49m\x1B[43merrors\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43merrors\x1B[49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    878\x1B[0m \x1B[43m            \x1B[49m\x1B[43mnewline\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m,\x1B[49m\n' +
      '\x1B[1;32m    879\x1B[0m \x1B[43m        \x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m    880\x1B[0m     \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[1;32m    881\x1B[0m         \x1B[38;5;66;03m# Binary mode\x1B[39;00m\n' +
      '\x1B[1;32m    882\x1B[0m         handle \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mopen\x1B[39m(handle, ioargs\x1B[38;5;241m.\x1B[39mmode)\n',
    "\x1B[0;31mFileNotFoundError\x1B[0m: [Errno 2] No such file or directory: 'NewModel.csv'"
  ]
}
04:31:05.681 [info] Interrupt kernel execution
04:31:05.682 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
04:31:05.682 [info] Interrupt kernel execution
04:31:05.682 [info] Interrupting kernel: new_rasfai
04:31:05.683 [info] Interrupting kernel via SIGINT
04:31:06.814 [warn] Cell completed with errors (cancelled)
04:31:06.820 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
04:33:01.781 [info] Interrupt kernel execution
04:33:01.782 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
04:33:01.783 [info] Interrupt kernel execution
04:33:01.783 [info] Interrupting kernel: new_rasfai
04:33:01.783 [info] Interrupting kernel via SIGINT
04:33:02.320 [warn] Cell completed with errors (cancelled)
04:33:02.331 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
04:33:36.324 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
05:16:20.307 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
05:16:22.703 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
05:20:20.560 [info] Interrupt kernel execution
05:20:20.560 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
05:20:20.561 [info] Interrupt kernel execution
05:20:20.561 [info] Interrupting kernel: new_rasfai
05:20:20.561 [info] Interrupting kernel via SIGINT
05:20:21.364 [warn] Cell completed with errors (cancelled)
05:20:21.371 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
05:22:29.122 [info] Interrupt kernel execution
05:22:29.122 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
05:22:29.122 [info] Interrupt kernel execution
05:22:29.122 [info] Interrupting kernel: new_rasfai
05:22:29.123 [info] Interrupting kernel via SIGINT
05:22:29.341 [warn] Cell completed with errors (cancelled)
05:22:29.346 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
05:23:20.332 [info] Interrupt kernel execution
05:23:20.333 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
05:23:20.334 [info] Interrupt kernel execution
05:23:20.334 [info] Interrupting kernel: new_rasfai
05:23:20.335 [info] Interrupting kernel via SIGINT
05:23:30.524 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
05:23:37.865 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
05:23:38.303 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
05:23:38.386 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3b077b14ee388a9928e6570071f33d9b072f0e5e6.json
    > cwd: /mnt/data/rasfai
05:23:39.328 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
05:25:05.447 [info] Interrupt kernel execution
05:25:05.449 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
05:25:05.449 [info] Interrupt kernel execution
05:25:05.449 [info] Interrupting kernel: new_rasfai
05:25:05.449 [info] Interrupting kernel via SIGINT
05:25:07.310 [warn] Cell completed with errors (cancelled)
05:25:07.314 [warn] Cancel all remaining cells due to cancellation or failure in execution
05:25:07.316 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
05:26:40.997 [info] Interrupt kernel execution
05:26:41.000 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
05:26:41.000 [info] Interrupt kernel execution
05:26:41.000 [info] Interrupting kernel: new_rasfai
05:26:41.001 [info] Interrupting kernel via SIGINT
05:26:41.330 [warn] Cell completed with errors (cancelled)
05:26:41.333 [warn] Cancel all remaining cells due to cancellation or failure in execution
05:26:41.335 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
05:53:38.545 [warn] Cell completed with errors lu [Error]: name 'y_true' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_true' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[18], line 4\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01msklearn\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01mmetrics\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m f1_score, precision_score, recall_score, hamming_loss, label_ranking_average_precision_score\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;66;03m# محاسبه شاخص‌ها\x1B[39;00m\n' +
      "\x1B[0;32m----> 4\x1B[0m micro_f1 \x1B[38;5;241m=\x1B[39m f1_score(\x1B[43my_true\x1B[49m, y_pred, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mmicro\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      "\x1B[1;32m      5\x1B[0m micro_precision \x1B[38;5;241m=\x1B[39m precision_score(y_true, y_pred, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mmicro\x1B[39m\x1B[38;5;124m'\x1B[39m)\n" +
      "\x1B[1;32m      6\x1B[0m micro_recall \x1B[38;5;241m=\x1B[39m recall_score(y_true, y_pred, average\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mmicro\x1B[39m\x1B[38;5;124m'\x1B[39m)\n",
    "\x1B[0;31mNameError\x1B[0m: name 'y_true' is not defined"
  ]
}
05:53:38.550 [warn] Cancel all remaining cells due to cancellation or failure in execution
05:54:18.711 [warn] Cell completed with errors lu [Error]: name 'y_pred' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_pred' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[19], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔍 مجموع 1های y_pred:\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[43my_pred\x1B[49m\x1B[38;5;241m.\x1B[39msum())\n' +
      '\x1B[1;32m      2\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔍 مجموع 1های y_true:\x1B[39m\x1B[38;5;124m"\x1B[39m, y_true\x1B[38;5;241m.\x1B[39msum())\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y_pred' is not defined"
  ]
}
06:01:24.460 [warn] Cell completed with errors lu [Error]: name 'y_true' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y_true' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[22], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔍 مجموع 1های y_pred:\x1B[39m\x1B[38;5;124m"\x1B[39m, y_pred\x1B[38;5;241m.\x1B[39msum())\n' +
      '\x1B[0;32m----> 2\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔍 مجموع 1های y_true:\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[43my_true\x1B[49m\x1B[38;5;241m.\x1B[39msum())\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y_true' is not defined"
  ]
}
06:03:14.485 [warn] Cell completed with errors lu [Error]: index 676 is out of bounds for axis 0 with size 676
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'IndexError',
  evalue: 'index 676 is out of bounds for axis 0 with size 676',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mIndexError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[23], line 10\x1B[0m\n' +
      '\x1B[1;32m      8\x1B[0m y_all_filtered \x1B[38;5;241m=\x1B[39m y_all[:, valid_label_indices]\n' +
      '\x1B[1;32m      9\x1B[0m mlb_filtered \x1B[38;5;241m=\x1B[39m mlb\n' +
      '\x1B[0;32m---> 10\x1B[0m mlb_filtered\x1B[38;5;241m.\x1B[39mclasses_ \x1B[38;5;241m=\x1B[39m \x1B[43mmlb\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mclasses_\x1B[49m\x1B[43m[\x1B[49m\x1B[43mvalid_label_indices\x1B[49m\x1B[43m]\x1B[49m\n' +
      '\x1B[1;32m     12\x1B[0m \x1B[38;5;66;03m# ------------------ محاسبه مقدار مناسب min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     13\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_label_indices])\n',
    '\x1B[0;31mIndexError\x1B[0m: index 676 is out of bounds for axis 0 with size 676'
  ]
}
06:06:20.206 [warn] Cell completed with errors lu [Error]: index 676 is out of bounds for axis 0 with size 676
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'IndexError',
  evalue: 'index 676 is out of bounds for axis 0 with size 676',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mIndexError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[25], line 12\x1B[0m\n' +
      '\x1B[1;32m     10\x1B[0m \x1B[38;5;66;03m# deepcopy تا تغییرات روی اصلی اعمال نشه\x1B[39;00m\n' +
      '\x1B[1;32m     11\x1B[0m mlb_filtered \x1B[38;5;241m=\x1B[39m deepcopy(mlb)\n' +
      '\x1B[0;32m---> 12\x1B[0m mlb_filtered\x1B[38;5;241m.\x1B[39mclasses_ \x1B[38;5;241m=\x1B[39m \x1B[43mmlb\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mclasses_\x1B[49m\x1B[43m[\x1B[49m\x1B[43mvalid_label_indices\x1B[49m\x1B[43m]\x1B[49m\n' +
      '\x1B[1;32m     14\x1B[0m \x1B[38;5;66;03m# ------------------ محاسبه مقدار مناسب min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     15\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_label_indices])\n',
    '\x1B[0;31mIndexError\x1B[0m: index 676 is out of bounds for axis 0 with size 676'
  ]
}
06:06:27.531 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
06:06:27.531 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
06:06:27.531 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
06:08:15.202 [warn] Cell completed with errors lu [Error]: boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'IndexError',
  evalue: 'boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mIndexError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[26], line 16\x1B[0m\n' +
      '\x1B[1;32m     14\x1B[0m y_all_filtered \x1B[38;5;241m=\x1B[39m y_all[:, valid_mask]\n' +
      '\x1B[1;32m     15\x1B[0m mlb_filtered \x1B[38;5;241m=\x1B[39m deepcopy(mlb)\n' +
      '\x1B[0;32m---> 16\x1B[0m mlb_filtered\x1B[38;5;241m.\x1B[39mclasses_ \x1B[38;5;241m=\x1B[39m \x1B[43mall_classes\x1B[49m\x1B[43m[\x1B[49m\x1B[43mvalid_mask\x1B[49m\x1B[43m]\x1B[49m\n' +
      '\x1B[1;32m     18\x1B[0m \x1B[38;5;66;03m# ------------------ تنظیم min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     19\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_mask])\n',
    '\x1B[0;31mIndexError\x1B[0m: boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012'
  ]
}
06:09:42.043 [warn] Cell completed with errors lu [Error]: boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'IndexError',
  evalue: 'boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mIndexError\x1B[0m                                Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[27], line 16\x1B[0m\n' +
      '\x1B[1;32m     14\x1B[0m y_all_filtered \x1B[38;5;241m=\x1B[39m y_all[:, valid_mask]\n' +
      '\x1B[1;32m     15\x1B[0m mlb_filtered \x1B[38;5;241m=\x1B[39m deepcopy(mlb)\n' +
      '\x1B[0;32m---> 16\x1B[0m mlb_filtered\x1B[38;5;241m.\x1B[39mclasses_ \x1B[38;5;241m=\x1B[39m \x1B[43mall_classes\x1B[49m\x1B[43m[\x1B[49m\x1B[43mvalid_mask\x1B[49m\x1B[43m]\x1B[49m\n' +
      '\x1B[1;32m     18\x1B[0m \x1B[38;5;66;03m# ------------------ تنظیم min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[1;32m     19\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_mask])\n',
    '\x1B[0;31mIndexError\x1B[0m: boolean index did not match indexed array along axis 0; size of axis is 676 but size of corresponding boolean axis is 1012'
  ]
}
06:18:55.238 [info] Interrupt kernel execution
06:18:55.239 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
06:18:55.240 [info] Interrupt kernel execution
06:18:55.240 [info] Interrupting kernel: new_rasfai
06:18:55.240 [info] Interrupting kernel via SIGINT
06:18:56.031 [warn] Cell completed with errors (cancelled)
06:18:56.036 [warn] Cancel all remaining cells due to cancellation or failure in execution
06:18:56.038 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
06:19:30.661 [info] Interrupt kernel execution
06:19:30.662 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
06:19:30.662 [info] Interrupt kernel execution
06:19:30.662 [info] Interrupting kernel: new_rasfai
06:19:30.662 [info] Interrupting kernel via SIGINT
06:19:40.826 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
06:19:41.889 [warn] Cell completed with errors (cancelled)
06:22:46.560 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/NewModel.ipynb
06:24:41.144 [info] Interrupt kernel execution
06:24:41.145 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
06:24:41.145 [info] Interrupt kernel execution
06:24:41.145 [info] Interrupting kernel: new_rasfai
06:24:41.145 [info] Interrupting kernel via SIGINT
06:24:51.313 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
06:25:08.907 [warn] Cell completed with errors (cancelled)
06:25:27.143 [info] Interrupt kernel execution
06:25:27.143 [info] Interrupt requested /mnt/data/rasfai/NewModel.ipynb
06:25:27.143 [info] Interrupt kernel execution
06:25:27.143 [info] Interrupting kernel: new_rasfai
06:25:27.144 [info] Interrupting kernel via SIGINT
06:25:37.308 [info] Interrupt requested & sent for /mnt/data/rasfai/NewModel.ipynb in notebookEditor.
06:25:38.678 [info] Restart requested /mnt/data/rasfai/NewModel.ipynb
06:25:39.100 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
06:25:39.181 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3bafae180402e714aba9b96fc71c3bc0bd429592b.json
    > cwd: /mnt/data/rasfai
06:25:40.564 [info] Restarted 97e19e77-83cd-410a-af66-9c353456dc27
06:41:31.578 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for 'Untitled-1.ipynb' (disableUI=false)
06:41:31.807 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
06:41:31.906 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
06:41:32.112 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v361f704722392e2921261ccd26cd5ba6dbcb08114.json
    > cwd: /mnt/data/rasfai
06:41:33.159 [info] Kernel successfully started
06:41:33.160 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
06:41:34.201 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
07:09:00.001 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for 'Untitled-2.ipynb' (disableUI=false)
07:09:00.374 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
07:09:00.476 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
07:09:00.752 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v339cfcd2a05099a8ca796b3376da8e15a53467ad5.json
    > cwd: /mnt/data/rasfai
07:09:02.238 [info] Kernel successfully started
07:09:02.240 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
07:09:03.594 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
07:12:23.741 [info] Restart requested Untitled-2.ipynb
07:12:23.923 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
07:12:24.046 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v391fb83955be128e6ed81412ee07a6b0f6859e78c.json
    > cwd: /mnt/data/rasfai
07:12:24.990 [info] Restarted 6e6d2cab-3df2-4d4a-91d7-8277475f5613
07:14:32.142 [info] Disposing request as the cell (-1) was deleted Untitled-2.ipynb
07:14:32.388 [info] Disposing request as the cell (-1) was deleted Untitled-2.ipynb
07:14:32.609 [info] Disposing request as the cell (-1) was deleted Untitled-2.ipynb
07:26:11.756 [warn] Cell completed with errors lu [Error]: Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'MemoryError',
  evalue: 'Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mMemoryError\x1B[0m                               Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[13], line 3\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# Final Features\x1B[39;00m\n' +
      '\x1B[1;32m      2\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m sample_features\x1B[38;5;241m.\x1B[39mdrop(columns\x1B[38;5;241m=\x1B[39m[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m])\n' +
      '\x1B[0;32m----> 3\x1B[0m X_final \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mhstack([X_numeric\x1B[38;5;241m.\x1B[39mvalues, \x1B[43mX_text\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mtoarray\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m])\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/scipy/sparse/_compressed.py:1167\x1B[0m, in \x1B[0;36m_cs_matrix.toarray\x1B[0;34m(self, order, out)\x1B[0m\n' +
      '\x1B[1;32m   1165\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m out \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m \x1B[38;5;129;01mand\x1B[39;00m order \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      "\x1B[1;32m   1166\x1B[0m     order \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_swap(\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mcf\x1B[39m\x1B[38;5;124m'\x1B[39m)[\x1B[38;5;241m0\x1B[39m]\n" +
      '\x1B[0;32m-> 1167\x1B[0m out \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_process_toarray_args\x1B[49m\x1B[43m(\x1B[49m\x1B[43morder\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mout\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1168\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m (out\x1B[38;5;241m.\x1B[39mflags\x1B[38;5;241m.\x1B[39mc_contiguous \x1B[38;5;129;01mor\x1B[39;00m out\x1B[38;5;241m.\x1B[39mflags\x1B[38;5;241m.\x1B[39mf_contiguous):\n' +
      "\x1B[1;32m   1169\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mOutput array must be C or F contiguous\x1B[39m\x1B[38;5;124m'\x1B[39m)\n",
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/scipy/sparse/_base.py:1354\x1B[0m, in \x1B[0;36m_spbase._process_toarray_args\x1B[0;34m(self, order, out)\x1B[0m\n' +
      '\x1B[1;32m   1352\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m out\n' +
      '\x1B[1;32m   1353\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[0;32m-> 1354\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43mnp\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mzeros\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mshape\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mdtype\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43morder\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43morder\x1B[49m\x1B[43m)\x1B[49m\n',
    '\x1B[0;31mMemoryError\x1B[0m: Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64'
  ]
}
07:26:48.047 [warn] Cell completed with errors lu [Error]: Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'MemoryError',
  evalue: 'Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64',
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mMemoryError\x1B[0m                               Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[15], line 3\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# Final Features\x1B[39;00m\n' +
      '\x1B[1;32m      2\x1B[0m X_numeric \x1B[38;5;241m=\x1B[39m sample_features\x1B[38;5;241m.\x1B[39mdrop(columns\x1B[38;5;241m=\x1B[39m[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mMasterTestCode\x1B[39m\x1B[38;5;124m"\x1B[39m, \x1B[38;5;124m"\x1B[39m\x1B[38;5;124mSampleName\x1B[39m\x1B[38;5;124m"\x1B[39m])\n' +
      '\x1B[0;32m----> 3\x1B[0m X_final \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mhstack([X_numeric\x1B[38;5;241m.\x1B[39mvalues, \x1B[43mX_text\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mtoarray\x1B[49m\x1B[43m(\x1B[49m\x1B[43m)\x1B[49m])\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/scipy/sparse/_compressed.py:1167\x1B[0m, in \x1B[0;36m_cs_matrix.toarray\x1B[0;34m(self, order, out)\x1B[0m\n' +
      '\x1B[1;32m   1165\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m out \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m \x1B[38;5;129;01mand\x1B[39;00m order \x1B[38;5;129;01mis\x1B[39;00m \x1B[38;5;28;01mNone\x1B[39;00m:\n' +
      "\x1B[1;32m   1166\x1B[0m     order \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_swap(\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mcf\x1B[39m\x1B[38;5;124m'\x1B[39m)[\x1B[38;5;241m0\x1B[39m]\n" +
      '\x1B[0;32m-> 1167\x1B[0m out \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_process_toarray_args\x1B[49m\x1B[43m(\x1B[49m\x1B[43morder\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mout\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   1168\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;129;01mnot\x1B[39;00m (out\x1B[38;5;241m.\x1B[39mflags\x1B[38;5;241m.\x1B[39mc_contiguous \x1B[38;5;129;01mor\x1B[39;00m out\x1B[38;5;241m.\x1B[39mflags\x1B[38;5;241m.\x1B[39mf_contiguous):\n' +
      "\x1B[1;32m   1169\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mValueError\x1B[39;00m(\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mOutput array must be C or F contiguous\x1B[39m\x1B[38;5;124m'\x1B[39m)\n",
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/scipy/sparse/_base.py:1354\x1B[0m, in \x1B[0;36m_spbase._process_toarray_args\x1B[0;34m(self, order, out)\x1B[0m\n' +
      '\x1B[1;32m   1352\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m out\n' +
      '\x1B[1;32m   1353\x1B[0m \x1B[38;5;28;01melse\x1B[39;00m:\n' +
      '\x1B[0;32m-> 1354\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[43mnp\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mzeros\x1B[49m\x1B[43m(\x1B[49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mshape\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43mdtype\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mdtype\x1B[49m\x1B[43m,\x1B[49m\x1B[43m \x1B[49m\x1B[43morder\x1B[49m\x1B[38;5;241;43m=\x1B[39;49m\x1B[43morder\x1B[49m\x1B[43m)\x1B[49m\n',
    '\x1B[0;31mMemoryError\x1B[0m: Unable to allocate 8.35 TiB for an array with shape (774607, 1480862) and data type float64'
  ]
}
07:30:05.612 [warn] Cell completed with errors lu [Error]: name 'tqdm' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'tqdm' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[20], line 9\x1B[0m\n' +
      '\x1B[1;32m      6\x1B[0m min_data_leaf_value \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mmax\x1B[39m(\x1B[38;5;241m10\x1B[39m, \x1B[38;5;28mint\x1B[39m(df[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mTotalCount\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mmean() \x1B[38;5;241m*\x1B[39m \x1B[38;5;241m0.05\x1B[39m))\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔧 مقدار تنظیم‌شده min_data_in_leaf: \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmin_data_leaf_value\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m----> 9\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m \x1B[43mtqdm\x1B[49m(\x1B[38;5;28mrange\x1B[39m(y\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m1\x1B[39m]), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mآموزش مدل‌ها\x1B[39m\x1B[38;5;124m"\x1B[39m, unit\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mکلاس\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[1;32m     10\x1B[0m     X_train, X_val, y_train_i, y_val_i \x1B[38;5;241m=\x1B[39m train_test_split(\n' +
      '\x1B[1;32m     11\x1B[0m         X_final, y[:, i], test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m\n' +
      '\x1B[1;32m     12\x1B[0m     )\n' +
      '\x1B[1;32m     14\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(\n' +
      '\x1B[1;32m     15\x1B[0m         n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m300\x1B[39m,\n' +
      '\x1B[1;32m     16\x1B[0m         learning_rate\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.05\x1B[39m,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m     20\x1B[0m         min_data_in_leaf\x1B[38;5;241m=\x1B[39mmin_data_leaf_value\n' +
      '\x1B[1;32m     21\x1B[0m     )\n',
    "\x1B[0;31mNameError\x1B[0m: name 'tqdm' is not defined"
  ]
}
07:30:41.814 [warn] Cell completed with errors lu [Error]: name 'tqdm' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'tqdm' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[22], line 9\x1B[0m\n' +
      '\x1B[1;32m      6\x1B[0m min_data_leaf_value \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mmax\x1B[39m(\x1B[38;5;241m10\x1B[39m, \x1B[38;5;28mint\x1B[39m(df[\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mTotalCount\x1B[39m\x1B[38;5;124m"\x1B[39m]\x1B[38;5;241m.\x1B[39mmean() \x1B[38;5;241m*\x1B[39m \x1B[38;5;241m0.05\x1B[39m))\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔧 مقدار تنظیم‌شده min_data_in_leaf: \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmin_data_leaf_value\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[0;32m----> 9\x1B[0m \x1B[38;5;28;01mfor\x1B[39;00m i \x1B[38;5;129;01min\x1B[39;00m \x1B[43mtqdm\x1B[49m(\x1B[38;5;28mrange\x1B[39m(y\x1B[38;5;241m.\x1B[39mshape[\x1B[38;5;241m1\x1B[39m]), desc\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mآموزش مدل‌ها\x1B[39m\x1B[38;5;124m"\x1B[39m, unit\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124mکلاس\x1B[39m\x1B[38;5;124m"\x1B[39m):\n' +
      '\x1B[1;32m     10\x1B[0m     X_train, X_val, y_train_i, y_val_i \x1B[38;5;241m=\x1B[39m train_test_split(\n' +
      '\x1B[1;32m     11\x1B[0m         X_final, y[:, i], test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m\n' +
      '\x1B[1;32m     12\x1B[0m     )\n' +
      '\x1B[1;32m     14\x1B[0m     model \x1B[38;5;241m=\x1B[39m LGBMClassifier(\n' +
      '\x1B[1;32m     15\x1B[0m         n_estimators\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m300\x1B[39m,\n' +
      '\x1B[1;32m     16\x1B[0m         learning_rate\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.05\x1B[39m,\n' +
      '\x1B[0;32m   (...)\x1B[0m\n' +
      '\x1B[1;32m     20\x1B[0m         min_data_in_leaf\x1B[38;5;241m=\x1B[39mmin_data_leaf_value\n' +
      '\x1B[1;32m     21\x1B[0m     )\n',
    "\x1B[0;31mNameError\x1B[0m: name 'tqdm' is not defined"
  ]
}
07:32:12.169 [info] Interrupt kernel execution
07:32:12.170 [info] Interrupt requested Untitled-2.ipynb
07:32:12.170 [info] Interrupt kernel execution
07:32:12.170 [info] Interrupting kernel: new_rasfai
07:32:12.170 [info] Interrupting kernel via SIGINT
07:32:18.236 [warn] Cell completed with errors (cancelled)
07:32:18.241 [info] Interrupt requested & sent for Untitled-2.ipynb in notebookEditor.
07:32:45.883 [warn] Cell completed with errors lu [Error]: name 'label_pos_counts' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'label_pos_counts' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[25], line 7\x1B[0m\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🚀 شروع آموزش مدل‌ها...\x1B[39m\x1B[38;5;124m"\x1B[39m)\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[38;5;66;03m# مقدار min_data_in_leaf بر اساس TotalCount\x1B[39;00m\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[38;5;66;03m# محاسبه min_data_in_leaf به‌صورت معقول‌تر و پله‌ای:\x1B[39;00m\n' +
      '\x1B[0;32m----> 7\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(\x1B[43mlabel_pos_counts\x1B[49m[valid_mask])\n' +
      '\x1B[1;32m      8\x1B[0m min_data_leaf_value \x1B[38;5;241m=\x1B[39m \x1B[38;5;28mint\x1B[39m(\x1B[38;5;28mmax\x1B[39m(\x1B[38;5;241m50\x1B[39m, \x1B[38;5;28mmin\x1B[39m(\x1B[38;5;241m500\x1B[39m, avg_positives_per_class \x1B[38;5;241m*\x1B[39m \x1B[38;5;241m0.2\x1B[39m)))\n' +
      '\x1B[1;32m      9\x1B[0m \x1B[38;5;28mprint\x1B[39m(\x1B[38;5;124mf\x1B[39m\x1B[38;5;124m"\x1B[39m\x1B[38;5;124m🔧 مقدار تنظیم‌شده min_data_in_leaf: \x1B[39m\x1B[38;5;132;01m{\x1B[39;00mmin_data_leaf_value\x1B[38;5;132;01m}\x1B[39;00m\x1B[38;5;124m"\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'label_pos_counts' is not defined"
  ]
}
07:41:18.677 [info] Interrupt kernel execution
07:41:18.678 [info] Interrupt requested Untitled-2.ipynb
07:41:18.678 [info] Interrupt kernel execution
07:41:18.679 [info] Interrupting kernel: new_rasfai
07:41:18.679 [info] Interrupting kernel via SIGINT
07:41:22.527 [warn] Cell completed with errors (cancelled)
07:41:22.535 [info] Interrupt requested & sent for Untitled-2.ipynb in notebookEditor.
07:43:42.998 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
07:44:03.488 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
07:46:34.806 [info] Restart requested Untitled-2.ipynb
07:46:34.810 [warn] Cancel all remaining cells due to dead kernel
07:46:35.549 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
07:46:35.659 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v37126890f62b6094971d47f62997c971601d46d25.json
    > cwd: /mnt/data/rasfai
07:46:38.414 [info] Restarted 6e6d2cab-3df2-4d4a-91d7-8277475f5613
07:46:47.463 [warn] Cell completed with errors lu [Error]: name 'y' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 8\x1B[0m\n' +
      '\x1B[1;32m      5\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mtqdm\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m tqdm\n' +
      '\x1B[1;32m      7\x1B[0m \x1B[38;5;66;03m# ------------------ مقداردهی min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[0;32m----> 8\x1B[0m label_pos_counts \x1B[38;5;241m=\x1B[39m \x1B[43my\x1B[49m\x1B[38;5;241m.\x1B[39msum(axis\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n' +
      '\x1B[1;32m      9\x1B[0m valid_mask \x1B[38;5;241m=\x1B[39m label_pos_counts \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m0\x1B[39m\n' +
      '\x1B[1;32m     10\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_mask])\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y' is not defined"
  ]
}
07:50:02.934 [warn] Cell completed with errors lu [Error]: name 'y' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[2], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# ------------------ مقداردهی min_data_in_leaf ------------------\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m label_pos_counts \x1B[38;5;241m=\x1B[39m \x1B[43my\x1B[49m\x1B[38;5;241m.\x1B[39msum(axis\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0\x1B[39m)\n' +
      '\x1B[1;32m      3\x1B[0m valid_mask \x1B[38;5;241m=\x1B[39m label_pos_counts \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m0\x1B[39m\n' +
      '\x1B[1;32m      4\x1B[0m avg_positives_per_class \x1B[38;5;241m=\x1B[39m np\x1B[38;5;241m.\x1B[39mmean(label_pos_counts[valid_mask])\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y' is not defined"
  ]
}
07:50:14.752 [info] Restart requested Untitled-2.ipynb
07:50:15.068 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
07:50:15.180 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v39953d0867d5c5109696efda7c45bda135cee0b28.json
    > cwd: /mnt/data/rasfai
07:50:18.084 [info] Restarted 6e6d2cab-3df2-4d4a-91d7-8277475f5613
07:52:44.487 [info] Interrupt kernel execution
07:52:44.490 [info] Interrupt requested Untitled-2.ipynb
07:52:44.490 [info] Interrupt kernel execution
07:52:44.491 [info] Interrupting kernel: new_rasfai
07:52:44.491 [info] Interrupting kernel via SIGINT
07:52:45.966 [warn] Cell completed with errors (cancelled)
07:52:45.970 [warn] Cancel all remaining cells due to cancellation or failure in execution
07:52:45.972 [info] Interrupt requested & sent for Untitled-2.ipynb in notebookEditor.
07:54:10.188 [info] Interrupt kernel execution
07:54:10.191 [info] Interrupt requested Untitled-2.ipynb
07:54:10.191 [info] Interrupt kernel execution
07:54:10.192 [info] Interrupting kernel: new_rasfai
07:54:10.192 [info] Interrupting kernel via SIGINT
07:54:11.555 [warn] Cell completed with errors (cancelled)
07:54:11.559 [warn] Cancel all remaining cells due to cancellation or failure in execution
07:54:11.560 [info] Interrupt requested & sent for Untitled-2.ipynb in notebookEditor.
07:57:54.224 [warn] Cell completed with errors lu [Error]: name 'X_numeric' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'X_numeric' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[13], line 4\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mscipy\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01msparse\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m hstack, csr_matrix\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;66;03m# تبدیل بخش عددی به sparse\x1B[39;00m\n' +
      '\x1B[0;32m----> 4\x1B[0m X_numeric_sparse \x1B[38;5;241m=\x1B[39m csr_matrix(\x1B[43mX_numeric\x1B[49m\x1B[38;5;241m.\x1B[39mvalues)\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[38;5;66;03m# ترکیب sparse عددی و tf-idf\x1B[39;00m\n' +
      '\x1B[1;32m      7\x1B[0m X_final \x1B[38;5;241m=\x1B[39m hstack([X_numeric_sparse, X_text])  \x1B[38;5;66;03m# بدون toarray\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'X_numeric' is not defined"
  ]
}
07:57:54.243 [warn] Cancel all remaining cells due to cancellation or failure in execution
08:01:24.549 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:01:24.606 [error] Jupyter Extension (Error in onKernelStatusChanged, method:onKernelStatusChanged): Error: CANNOT execute cell that has been REMOVED from notebook
    at R4._createNotebookCellExecution (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:169:25897)
    at Object.createNotebookCellExecution (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:169:21401)
    at Function.create (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:115:31140)
    at Function.getOrCreate (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:115:30931)
    at Mc (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:118:2542)
    at af.endCellAndDisplayErrorsInCell (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:13869)
    at af.onKernelStatusChanged (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:13475)
    at af.r.value (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:60:11885)
    at D.B (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2373)
    at D.C (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2443)
    at D.fire (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2660)
    at xy.<anonymous> (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:296:2959)
    at D.B (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2373)
    at D.C (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2443)
    at D.fire (file://~/.vscode-server/cli/servers/Stable-848b80aeb52026648a8ff9f7c45a9b0a80641e2e/server/out/vs/workbench/api/node/extensionHostProcess.js:27:2660)
    at a (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:282:40035)
    at D (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:20100)
    at Object.d [as emit] (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:19765)
    at i.emit (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:17896)
    at iT.onStatusChanged (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:279:31862)
    at D (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:20100)
    at Object.d [as emit] (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:19765)
    at i.emit (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:17896)
    at pT.onKernelStatus (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:22897)
    at D (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:20100)
    at Object.d [as emit] (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:19765)
    at i.emit (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:30:17896)
    at dT.shutdown (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:13891)
08:02:42.225 [info] Disposing kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher for notebook Untitled-2.ipynb due to selection of another kernel or closing of the notebook
08:02:42.225 [info] Dispose Kernel 'Untitled-2.ipynb' associated with 'Untitled-2.ipynb'
08:02:42.828 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.828 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.828 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.828 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.828 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.829 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.829 [info] Disposing request as the cell (0) was deleted Untitled-2.ipynb
08:02:42.835 [info] Disposing request as the cell (2) was deleted Untitled-2.ipynb
08:02:42.837 [info] Disposing request as the cell (3) was deleted Untitled-2.ipynb
08:02:42.839 [info] Disposing request as the cell (4) was deleted Untitled-2.ipynb
08:02:42.839 [info] Disposing request as the cell (4) was deleted Untitled-2.ipynb
08:02:42.841 [info] Disposing request as the cell (5) was deleted Untitled-2.ipynb
08:02:42.843 [info] Disposing request as the cell (6) was deleted Untitled-2.ipynb
08:02:42.892 [info] Disposing request as the cell (7) was deleted Untitled-2.ipynb
08:02:42.892 [info] Disposing request as the cell (7) was deleted Untitled-2.ipynb
08:02:42.892 [info] Disposing request as the cell (7) was deleted Untitled-2.ipynb
08:02:42.894 [info] Disposing request as the cell (8) was deleted Untitled-2.ipynb
08:02:42.894 [info] Disposing request as the cell (8) was deleted Untitled-2.ipynb
08:02:42.894 [info] Disposing request as the cell (8) was deleted Untitled-2.ipynb
08:02:42.894 [info] Disposing request as the cell (8) was deleted Untitled-2.ipynb
08:02:42.896 [info] Disposing request as the cell (9) was deleted Untitled-2.ipynb
08:02:42.898 [info] Disposing request as the cell (10) was deleted Untitled-2.ipynb
08:02:42.900 [info] Disposing request as the cell (11) was deleted Untitled-2.ipynb
08:02:42.900 [info] Disposing request as the cell (11) was deleted Untitled-2.ipynb
08:02:42.900 [info] Disposing request as the cell (11) was deleted Untitled-2.ipynb
08:02:42.900 [info] Disposing request as the cell (11) was deleted Untitled-2.ipynb
08:02:42.997 [warn] Cancel all remaining cells due to dead kernel
08:02:58.665 [info] Starting Kernel (Python Path: /mnt/data/rasfai/.venv/bin/python, Venv, 3.10.12) for '/mnt/data/rasfai/Final.ipynb' (disableUI=false)
08:02:59.208 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m pip list
08:02:59.295 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:02:59.383 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v37f56b6f16266a75c3fc983aa2ef7594d3750d8c2.json
    > cwd: /mnt/data/rasfai
08:03:02.473 [info] Kernel successfully started
08:03:02.474 [warn] No nbextensions folder found for kernel .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
08:03:03.652 [error] Widget Error: Failed to access CDN https://unpkg.com/ after 0 attempt(s), TypeError: Failed to fetch
08:03:04.659 [warn] Cell completed with errors lu [Error]: name 'X_numeric' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'X_numeric' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 4\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01mscipy\x1B[39;00m\x1B[38;5;21;01m.\x1B[39;00m\x1B[38;5;21;01msparse\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;28;01mimport\x1B[39;00m hstack, csr_matrix\n' +
      '\x1B[1;32m      3\x1B[0m \x1B[38;5;66;03m# تبدیل بخش عددی به sparse\x1B[39;00m\n' +
      '\x1B[0;32m----> 4\x1B[0m X_numeric_sparse \x1B[38;5;241m=\x1B[39m csr_matrix(\x1B[43mX_numeric\x1B[49m\x1B[38;5;241m.\x1B[39mvalues)\n' +
      '\x1B[1;32m      6\x1B[0m \x1B[38;5;66;03m# ترکیب sparse عددی و tf-idf\x1B[39;00m\n' +
      '\x1B[1;32m      7\x1B[0m X_final \x1B[38;5;241m=\x1B[39m hstack([X_numeric_sparse, X_text])  \x1B[38;5;66;03m# بدون toarray\x1B[39;00m\n',
    "\x1B[0;31mNameError\x1B[0m: name 'X_numeric' is not defined"
  ]
}
08:07:36.252 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:09:55.856 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
08:15:36.626 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:15:36.630 [warn] Cancel all remaining cells due to dead kernel
08:15:37.486 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:15:37.575 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3659c9560c75165c36fb73041ef9bacb871b0dc67.json
    > cwd: /mnt/data/rasfai
08:15:41.321 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:19:09.547 [warn] Cell completed with errors lu [Error]: name 'y' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'y' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[14], line 2\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# 6. Train/Test Split\x1B[39;00m\n' +
      '\x1B[0;32m----> 2\x1B[0m X_train, X_test, y_train, y_test \x1B[38;5;241m=\x1B[39m train_test_split(X_final, \x1B[43my\x1B[49m, test_size\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m0.2\x1B[39m, random_state\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m42\x1B[39m)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'y' is not defined"
  ]
}
08:19:09.551 [warn] Cancel all remaining cells due to cancellation or failure in execution
08:20:25.954 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:20:56.834 [error] Error in notebook cell execution Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:20:56.859 [error] Error in execution (get message for cell) Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:21:01.576 [error] Error in notebook cell execution Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:21:01.577 [error] Error in execution (get message for cell) Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:23:20.811 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
08:26:07.502 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:26:07.510 [warn] Cancel all remaining cells due to dead kernel
08:26:08.223 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:26:08.309 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3e79eee1b555c7ec1e768f25794d68f2bc0239104.json
    > cwd: /mnt/data/rasfai
08:26:11.482 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:27:36.330 [info] Interrupt kernel execution
08:27:36.333 [info] Interrupt requested /mnt/data/rasfai/Final.ipynb
08:27:36.333 [info] Interrupt kernel execution
08:27:36.333 [info] Interrupting kernel: new_rasfai
08:27:36.334 [info] Interrupting kernel via SIGINT
08:27:36.912 [warn] Cell completed with errors (cancelled)
08:27:36.916 [warn] Cancel all remaining cells due to cancellation or failure in execution
08:27:36.917 [info] Interrupt requested & sent for /mnt/data/rasfai/Final.ipynb in notebookEditor.
08:31:31.536 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:35:47.919 [error] Error in execution (get message for cell) Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:35:53.685 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:35:53.692 [warn] Cancel all remaining cells due to dead kernel
08:35:53.840 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:35:53.945 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3d63a6e6bb73a30f954a32a9370b8d62d40ef97ff.json
    > cwd: /mnt/data/rasfai
08:35:57.320 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:36:00.093 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:36:00.297 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:36:00.404 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v3b8246b0a140cfacb04478e838cbc60dc89721e6f.json
    > cwd: /mnt/data/rasfai
08:36:01.403 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:39:01.493 [info] Interrupt kernel execution
08:39:01.495 [info] Interrupt requested /mnt/data/rasfai/Final.ipynb
08:39:01.495 [info] Interrupt kernel execution
08:39:01.496 [info] Interrupting kernel: new_rasfai
08:39:01.496 [info] Interrupting kernel via SIGINT
08:39:02.815 [warn] Cell completed with errors (cancelled)
08:39:02.817 [warn] Cancel all remaining cells due to cancellation or failure in execution
08:39:02.819 [info] Interrupt requested & sent for /mnt/data/rasfai/Final.ipynb in notebookEditor.
08:41:40.076 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
08:41:40.077 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
08:43:10.423 [warn] Cell completed with errors lu [Error]: 'SampleName'
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'KeyError',
  evalue: "'SampleName'",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3804\x1B[0m \x1B[38;5;28;01mtry\x1B[39;00m:\n' +
      '\x1B[0;32m-> 3805\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43m_engine\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mcasted_key\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   3806\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m \x1B[38;5;28;01mas\x1B[39;00m err:\n',
    'File \x1B[0;32mindex.pyx:167\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mindex.pyx:196\x1B[0m, in \x1B[0;36mpandas._libs.index.IndexEngine.get_loc\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7081\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    'File \x1B[0;32mpandas/_libs/hashtable_class_helper.pxi:7089\x1B[0m, in \x1B[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\x1B[0;34m()\x1B[0m\n',
    "\x1B[0;31mKeyError\x1B[0m: 'SampleName'",
    '\nThe above exception was the direct cause of the following exception:\n',
    '\x1B[0;31mKeyError\x1B[0m                                  Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[11], line 3\x1B[0m\n' +
      '\x1B[1;32m      1\x1B[0m \x1B[38;5;66;03m# 2. ساخت TF-IDF\x1B[39;00m\n' +
      "\x1B[1;32m      2\x1B[0m sample_vectorizer \x1B[38;5;241m=\x1B[39m TfidfVectorizer(analyzer\x1B[38;5;241m=\x1B[39m\x1B[38;5;124m'\x1B[39m\x1B[38;5;124mword\x1B[39m\x1B[38;5;124m'\x1B[39m, ngram_range\x1B[38;5;241m=\x1B[39m(\x1B[38;5;241m1\x1B[39m, \x1B[38;5;241m2\x1B[39m), max_features\x1B[38;5;241m=\x1B[39m\x1B[38;5;241m20000\x1B[39m)\n" +
      '\x1B[0;32m----> 3\x1B[0m X_text \x1B[38;5;241m=\x1B[39m sample_vectorizer\x1B[38;5;241m.\x1B[39mfit_transform(\x1B[43msample_features\x1B[49m\x1B[43m[\x1B[49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[38;5;124;43mSampleName\x1B[39;49m\x1B[38;5;124;43m"\x1B[39;49m\x1B[43m]\x1B[49m)\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/frame.py:4102\x1B[0m, in \x1B[0;36mDataFrame.__getitem__\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   4100\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39mcolumns\x1B[38;5;241m.\x1B[39mnlevels \x1B[38;5;241m>\x1B[39m \x1B[38;5;241m1\x1B[39m:\n' +
      '\x1B[1;32m   4101\x1B[0m     \x1B[38;5;28;01mreturn\x1B[39;00m \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_getitem_multilevel(key)\n' +
      '\x1B[0;32m-> 4102\x1B[0m indexer \x1B[38;5;241m=\x1B[39m \x1B[38;5;28;43mself\x1B[39;49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mcolumns\x1B[49m\x1B[38;5;241;43m.\x1B[39;49m\x1B[43mget_loc\x1B[49m\x1B[43m(\x1B[49m\x1B[43mkey\x1B[49m\x1B[43m)\x1B[49m\n' +
      '\x1B[1;32m   4103\x1B[0m \x1B[38;5;28;01mif\x1B[39;00m is_integer(indexer):\n' +
      '\x1B[1;32m   4104\x1B[0m     indexer \x1B[38;5;241m=\x1B[39m [indexer]\n',
    'File \x1B[0;32m/mnt/data/rasfai/.venv/lib/python3.10/site-packages/pandas/core/indexes/base.py:3812\x1B[0m, in \x1B[0;36mIndex.get_loc\x1B[0;34m(self, key)\x1B[0m\n' +
      '\x1B[1;32m   3807\x1B[0m     \x1B[38;5;28;01mif\x1B[39;00m \x1B[38;5;28misinstance\x1B[39m(casted_key, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;129;01mor\x1B[39;00m (\n' +
      '\x1B[1;32m   3808\x1B[0m         \x1B[38;5;28misinstance\x1B[39m(casted_key, abc\x1B[38;5;241m.\x1B[39mIterable)\n' +
      '\x1B[1;32m   3809\x1B[0m         \x1B[38;5;129;01mand\x1B[39;00m \x1B[38;5;28many\x1B[39m(\x1B[38;5;28misinstance\x1B[39m(x, \x1B[38;5;28mslice\x1B[39m) \x1B[38;5;28;01mfor\x1B[39;00m x \x1B[38;5;129;01min\x1B[39;00m casted_key)\n' +
      '\x1B[1;32m   3810\x1B[0m     ):\n' +
      '\x1B[1;32m   3811\x1B[0m         \x1B[38;5;28;01mraise\x1B[39;00m InvalidIndexError(key)\n' +
      '\x1B[0;32m-> 3812\x1B[0m     \x1B[38;5;28;01mraise\x1B[39;00m \x1B[38;5;167;01mKeyError\x1B[39;00m(key) \x1B[38;5;28;01mfrom\x1B[39;00m\x1B[38;5;250m \x1B[39m\x1B[38;5;21;01merr\x1B[39;00m\n' +
      '\x1B[1;32m   3813\x1B[0m \x1B[38;5;28;01mexcept\x1B[39;00m \x1B[38;5;167;01mTypeError\x1B[39;00m:\n' +
      '\x1B[1;32m   3814\x1B[0m     \x1B[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\x1B[39;00m\n' +
      '\x1B[1;32m   3815\x1B[0m     \x1B[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\x1B[39;00m\n' +
      '\x1B[1;32m   3816\x1B[0m     \x1B[38;5;66;03m#  the TypeError.\x1B[39;00m\n' +
      '\x1B[1;32m   3817\x1B[0m     \x1B[38;5;28mself\x1B[39m\x1B[38;5;241m.\x1B[39m_check_indexing_error(key)\n',
    "\x1B[0;31mKeyError\x1B[0m: 'SampleName'"
  ]
}
08:45:52.905 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:48:28.765 [error] Error in notebook cell execution Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:48:28.766 [error] Error in execution (get message for cell) Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
08:48:31.614 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:48:31.617 [warn] Cancel all remaining cells due to dead kernel
08:48:32.394 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:48:32.478 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v35d4c1780d67bf3bda64d71cf5d90faba30ea9189.json
    > cwd: /mnt/data/rasfai
08:48:35.692 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:49:18.973 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
08:54:45.134 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
08:55:18.120 [info] Restart requested /mnt/data/rasfai/Final.ipynb
08:55:18.124 [warn] Cancel all remaining cells due to dead kernel
08:55:18.301 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -c "import ipykernel; print(ipykernel.__version__); print("5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d"); print(ipykernel.__file__)"
08:55:18.412 [info] Process Execution: /mnt/data/rasfai/.venv/bin/python -m ipykernel_launcher --f=/run/user/1000/jupyter/runtime/kernel-v31cd318b18b39c09da9c617709893169e47ea85f3.json
    > cwd: /mnt/data/rasfai
08:55:21.813 [info] Restarted 41c6df8c-8170-4887-8a70-c735108c71d8
08:59:18.192 [warn] Cell completed with errors lu [Error]: name 'sample_features' is not defined
    at n.execute (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:294:4958) {
  ename: 'NameError',
  evalue: "name 'sample_features' is not defined",
  traceback: [
    '\x1B[0;31m---------------------------------------------------------------------------\x1B[0m',
    '\x1B[0;31mNameError\x1B[0m                                 Traceback (most recent call last)',
    'Cell \x1B[0;32mIn[1], line 1\x1B[0m\n' +
      '\x1B[0;32m----> 1\x1B[0m sample_features \x1B[38;5;241m=\x1B[39m \x1B[43msample_features\x1B[49m\x1B[38;5;241m.\x1B[39mreset_index()\n' +
      '\x1B[1;32m      2\x1B[0m \x1B[38;5;28mprint\x1B[39m(sample_features\x1B[38;5;241m.\x1B[39mcolumns)\n',
    "\x1B[0;31mNameError\x1B[0m: name 'sample_features' is not defined"
  ]
}
09:21:51.758 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
09:24:16.694 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
09:24:16.695 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
09:24:56.397 [error] Disposing session as kernel process died ExitCode: undefined, Reason: 
09:25:01.867 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
09:25:01.867 [info] Disposing request as the cell (-1) was deleted /mnt/data/rasfai/Final.ipynb
09:25:33.643 [error] Error in notebook cell execution Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
09:25:33.644 [error] Error in execution (get message for cell) Error: The kernel 'Python (RasfAi) (Python 3.10.12)' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.
    > Kernel Id = .new_rasfai./mnt/data/rasfai/.venv/python./mnt/data/rasfai/.venv/python.-m#ipykernel_launcher
    > Interpreter Id = /mnt/data/rasfai/.venv/bin/python
    > at Function.verifyKernelState (~/.vscode-server/extensions/ms-toolsai.jupyter-2025.4.1-linux-x64/dist/extension.node.js:301:81121)
    > originalException = undefined
